<style type="text/css">
    .btn-group > .btn, .btn-group > .btn + .btn, .btn-group > .btn:first-child, .fc .fc-button-group > * {
        height: 34px !important;
        border-radius: 4px !important;
        margin: 0 !important;
    }

    .bootstrap-select.btn-group .dropdown-toggle .caret {
        right: 92% !important;
    }

    .btn-label {
        left: 12px;
    }

    input, select {
        font-weight: 600 !important;
        color: #002c52 !important;
        font-size: 16px !important;
    }

    .top-label {
        font-size: 13px;
        background-color: #428bca !important;
        border: 2px solid #428bca !important;
        text-shadow: none !important;
        font-weight: 500 !important;
    }

    .myspan {
        color: rgb(255, 0, 0);
        font-size: 12px;
        position: absolute;
        bottom: -16px;
        right: 20px;
    }

    .no-padding {
        padding-left: 0px !important;
        padding-right: 0px !important;
    }

    .print_forma {
        padding: 15px;
    }

    .piece-box {
        margin-bottom: 12px;
        border: 1px solid #73b300;
        display: inline-block;
        width: 100%;
    }

    .piece-heading {
        background-color: #9bbb59;
        display: inline-block;
        float: right;
        width: 100%;
    }

    .piece-body {
        width: 100%;
        float: right;
    }

    .bordered-bottom {
        border-bottom: 4px solid #9bbb59;
    }

    .piece-footer {
        display: inline-block;
        float: right;
        width: 100%;
        border-top: 1px solid #73b300;
    }

    .piece-heading h5 {
        margin: 4px 0;
    }

    .piece-box table {
        margin-bottom: 0
    }

    .piece-box table th,
    .piece-box table td {
        padding: 2px 8px !important;
    }

    h6 {
        font-size: 16px;
        margin-bottom: 3px;
        margin-top: 3px;
    }

    .print_forma table th {
        text-align: right;
    }

    .print_forma table tr th {
        vertical-align: middle;
    }

    .no-padding {
        padding: 0;
    }

    .header p {
        margin: 0;
    }

    .header img {
        height: 120px;
        width: 100%
    }

    .main-title {
        display: table;
        text-align: center;
        position: relative;
        height: 120px;
        width: 100%;
    }

    .main-title h4 {
        display: table-cell;
        vertical-align: bottom;
        text-align: center;
        width: 100%;
    }

    .print_forma hr {
        border-top: 1px solid #73b300;
        margin-top: 7px;
        margin-bottom: 7px;
    }

    .no-border {
        border: 0 !important;
    }

    .gray_background {
        background-color: #eee;
    }

    @media print {
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    }

    .footer img {
        width: 100%;
        height: 120px;
    }

    @page {
        size: A4;
        margin: 20px 0 0;
    }

    .open_green {
        background-color: #e6eed5;
    }

    .closed_green {
        background-color: #cdddac !important;
    }

    .table-bordered > thead > tr > th,
    .table-bordered > tbody > tr > th,
    .table-bordered > tfoot > tr > th,
    .table-bordered > thead > tr > td,
    .table-bordered > tbody > tr > td,
    .table-bordered > tfoot > tr > td {
        border: 1px solid #abc572;
    }

    .btn-close-model,
    btn-close-model:hover,
    btn-close-model:focus {
        background-color: #8a9e5f;
        color: #fff;
        margin-top: -20px;
    }

    .my_style {
        color: #222;
        font-size: 15px;
        font-weight: 500;
    }

    .one_three {
        width: 43% !important;
        float: right;
    }

    .two_three {
        width: 57% !important;
        float: right;
    }

    @media (min-width: 992px) {
        .col_md_10 {
            width: 10%;
            float: right;
        }

        .col_md_15 {
            width: 15%;
            float: right;
        }

        .col_md_20 {
            width: 20%;
            float: right;
        }

        .col_md_25 {
            width: 25%;
            float: right;
        }

        .col_md_30 {
            width: 30%;
            float: right;
        }

        .col_md_35 {
            width: 35%;
            float: right;
        }

        .col_md_40 {
            width: 40%;
            float: right;
        }

        .col_md_45 {
            width: 45%;
            float: right;
        }

        .col_md_50 {
            width: 50%;
            float: right;
        }

        .col_md_60 {
            width: 60%;
            float: right;
        }

        .col_md_70 {
            width: 70%;
            float: right;
        }

        .col_md_75 {
            width: 75%;
            float: right;
        }

        .col_md_80 {
            width: 80%;
            float: right;
        }

        .col_md_85 {
            width: 85%;
            float: right;
        }

        .col_md_90 {
            width: 90%;
            float: right;
        }

        .col_md_95 {
            width: 95%;
            float: right;
        }

        .col_md_100 {
            width: 100%;
            float: right;
        }
    }

    .label_title_2 {
        width: 100%;
        color: #222;
        font-weight: 600;
        background-color: #fcb632;
        border: 2px solid #fcb632;
        height: 34px;
        margin: 0;
        line-height: 32px;
        padding-right: 0px;
        font-size: 16px;
        margin-bottom: 5px;
        border-radius: 10px;
        text-align: center;
    }

    .input_style_2 {
        border-radius: 0px;
        border-right: transparent;
        width: 100%;
    }

    .label-blue {
        background-color: #003665;
        border: 1px solid #003665;

        height: 34px;
        line-height: 25px !important;
        font-size: 13px !important;
        font-weight: 500 !important;
        text-align: right !important;
    }

    .bond-header {
        height: 55px;
        margin-bottom: 15px;
    }

    .bond-header .right-img img,
    .bond-header .left-img img {
        width: 100%;
        height: 55px;
    }

    .border-box {
        padding: 5px 20px;
        border: 5px double #000 !important;
        border-radius: 29px;
        font-size: 14px !important;
        color: #002c57 !important;
        font-weight: bold !important;
    }

    .border-box-h {
        padding: 3px 20px;
        border: 2px solid #222;
        border-radius: 24px;
    }

    .main-bond-title {
        display: table;
        height: 55px;
        text-align: center;
        width: 100%;
    }

    .main-bond-title h3 {
        display: table-cell;
        vertical-align: bottom;
        font-size: 12px;
    }

    .bond-body {
        padding: 10px;
        border: 2px solid #222;
        display: inline-block;
        width: 100%;
        border-radius: 30px;
        background: url(<?php echo base_url() ?>asisst/admin_asset/img/pills/back2.jpg);
        background-position: center;
        background-size: 50% 100%;
        background-repeat: no-repeat;
    }

    .bond-body h6 {
        font-size: 11px !important;
        color: #002c57 !important;
        font-weight: bold !important;
        line-height: 17px;
    }

    .bond-body h6 span {
        color: darkred;
    }

    .pad-2 {
        padding-left: 2px;
        padding-right: 2px;
    }

    .bond-footer h6 {
        font-size: 13px !important;
        color: #002c57 !important;
        font-weight: bold !important;
        line-height: 17px;
    }

    #cheq, #eda3, #shabka, #mosatadem {
        padding-top: 5px !important;
        padding-bottom: 5px !important;
    }

    .table_style {
        font-size: 11px !important;
        color: darkred !important;
        font-weight: bold !important;
        line-height: 17px !important;
        margin: 1px;
    }

    button[type=submit] {
        padding: 0px 12px;
    }

    .btn-label {
        right: -14px;
    }

    .list::-webkit-calendar-picker-indicator {
        display: none;
    }

    input[type=date]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        display: none;
    }

    input[type=date]::-webkit-clear-button {
        display: none;
        -webkit-appearance: none;
    }

    .tree ul {
        margin-right: 10px;
        position: relative;
        margin-left: 0;
    }

    .tree ul li {
        padding-left: 0;
    }

    .tree ul ul {
        margin-left: 0;
    }

    ul span {
        display: inline !important;
    }

    .fa-plus.sspan {
        background-color: #5b69bc;
        padding: 3px 6px;
        color: #fff;
        border-radius: 5px;
    }

    #colspan4 {
        text-align: right;
        color: red

    }

    .forTd {
        color: black !important;
        font-family: tahoma !important;
        font-size: 15px !important;
        font-weight: 700 !important;
    }

    .tb-table th, .tb-table td {
        padding: 4px !important;
    }

    .tb-table td .form-control {
        width: 100% !important;
    }
    /********************************************/
    /*
        .tablegray.table>thead>tr>td.info,
        .tablegray.table>tbody>tr>td.info,
        .tablegray.table>tfoot>tr>td.info,
        .tablegray.table>thead>tr>th.info,
        .tablegray.table>tbody>tr>th.info,
        .tablegray.table>tfoot>tr>th.info,
        .tablegray.table>thead>tr.info>td,
        .tablegray.table>tbody>tr.info>td,
        .tablegray.table>tfoot>tr.info>td,
        .tablegray.table>thead>tr.info>th,
        .tablegray.table>tbody>tr.info>th,
        .tablegray.table>tfoot>tr.info>th {
        background-color: #09704e !important;
        color: white !important;
        font-size: 16px !important;
    }

    .tablegray.table-bordered > thead > tr > th,
     .tablegray.table-bordered > tbody > tr > th,
     .tablegray.table-bordered > tfoot > tr > th,
     .tablegray.table-bordered > thead > tr > td,
     .tablegray.table-bordered > tbody > tr > td,
      .tablegray.table-bordered > tfoot > tr > td {
        border: 1px solid #ffffff !important;

       background: #e8e8e8  !important;


            border-radius: 7px !important;
            font-size: 17px !important;
            color: black !important;
    }

        */


    /*********************************************/
    .classtd{
        background-color: orange !important;
    }
</style>



<div class="col-xs-12 ">
    <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable ">
        <div class="panel-heading">
            <h3 class="panel-title">إعتماد قرارات اللجنة</h3>
        </div>
        <div class="panel-body">
            <?php if($session->finished ==1){



                $indexs=array(1=>'المحور الأول',
                    2=>'المحور الثاني',
                    3=>'المحور الثالث',
                    4=>'المحور الرابع',
                    5=>'المحور الخامس',
                    6=>'المحور السادس',
                    7=>'المحور السابع',
                );
                ?>

            <?php if (isset($records) && !empty($records)) {
                $x = 1;
                foreach ($records as $session) {

                    ?>
                    <p><?php echo $x; ?>- <?php echo $session->mehwar_title; ?> .</p>


                    <?php $x++;
                }
            } ?>

            <?php if (isset($records) && !empty($records)) {
                $x = 1;
                foreach ($records as $session) { ?>

                    <div class="col-xs-12 no-padding">
                        <h6><strong><?php echo $indexs[$x]; ?> :</strong><?php echo $session->mehwar_title; ?>
                        </h6>

                        <!------------------------------------------------------->

                        <?php
                        $array = array(2, 4, 12, 14);

                        if (in_array($session->mehwar_id_fk, $array)) {
                            ?>

                            <?php
                            if (isset($session->mahder_details) && !empty($session->mahder_details)) {
                            echo form_open_multipart('family_controllers/LagnaSetting/Lagna_decisions_approved_action/f_members');
                            ?>
                            <table id=""
                                   class="table table-striped table-bordered dt-responsive nowrap res<?php echo $session->mehwar_id_fk; ?>"
                                   cellspacing="0" width="100%">

                                <thead>
                                <tr>
                                    <th class="gray_background">م</th>
                                    <th class="gray_background">رقم الملف</th>
                                    <th colspan="2" class="gray_background">إسم رب الاسرة</th>
                                    <th class="gray_background">أرملة</th>
                                    <th class="gray_background">يتيم</th>
                                    <th class="gray_background">مستفيد</th>

                                    <th class="gray_background">قرار اللجنة</th>
                                </tr>
                                </thead>
                                <tbody>

                                <?php

                                    $z = 0;
                                    foreach ($session->mahder_details as $row) {


                                        $z++;
                                        $members = $row->members;

                                        if ($z % 2 == 0) {
                                            $ccolor = '#f1f1f1';
                                        } else {
                                            $ccolor = 'white';
                                        }


                                        ?>

                                        <tr>
                                            <td style="background-color: <?php echo $ccolor; ?>; "
                                                rowspan="<?php if (!empty($members)) {
                                                    echo sizeof($members) + 1;
                                                } ?>"><?php echo $z; ?></td>
                                            <td style="background-color: <?php echo $ccolor; ?>;"
                                                rowspan="<?php if (!empty($members)) {
                                                    echo sizeof($members) + 1;
                                                } ?>"><?php echo $row->file_num; ?></td>
                                            <td style="background-color: <?php echo $ccolor; ?>;"
                                                colspan="2" width="30%"><?php echo $row->father; ?></td>
                                            <td style="background-color: <?php echo $ccolor; ?>; color: <?php echo $ccolor; ?>;"
                                                class="countable2<?php echo $session->mehwar_id_fk; ?>">0
                                            </td>
                                            <td style="background-color: <?php echo $ccolor; ?>;color: <?php echo $ccolor; ?>;"
                                                class="countable3<?php echo $session->mehwar_id_fk; ?>">0
                                            </td>
                                            <td style="background-color: <?php echo $ccolor; ?>;color: <?php echo $ccolor; ?>;"
                                                class="countable4<?php echo $session->mehwar_id_fk; ?>">0
                                            </td>

                                            <td style="background-color: <?php echo $ccolor; ?>;color: <?php echo $ccolor; ?>;"></td>
                                        </tr>
                                        <tr>

                                            <td style="background-color: <?php echo $ccolor; ?>;"
                                                rowspan="<?php if (!empty($members)) {
                                                    echo sizeof($members);
                                                } ?>">الأفراد
                                            </td>
                                            <td style="background-color: <?php echo $ccolor; ?>;"><?= $members[0]->person_name ?></td>
                                            <td style="background-color: <?php echo $ccolor; ?>; "
                                                class="countable2<?php echo $session->mehwar_id_fk; ?>"><?= $members[0]->total_armal ?></td>
                                            <td style="background-color: <?php echo $ccolor; ?>;"
                                                class="countable3<?php echo $session->mehwar_id_fk; ?>"><?= $members[0]->total_yatem ?></td>
                                            <td style="background-color: <?php echo $ccolor; ?>;"
                                                class="countable4<?php echo $session->mehwar_id_fk; ?>"><?= $members[0]->total_mostafed ?></td>
                                            <td style="background-color: <?php echo $ccolor; ?>;">
                                                <select class="form-control halet_file" name="halet_file[<?php echo $members[0]->person_id_fk;?>]">
                                                    <option value="0">اختر</option>
                                                    <?php if (isset($file_status) && $file_status != null && !empty($file_status)){
                                                        foreach ($file_status as $row){ ?>
                                                            <option
                                                                    value="<?php echo $row->id; ?>"
                                                            <?php if($members[0]->halet_file_id_fk == $row->id){  echo 'selected'; } ?>

                                                            ><?php echo $row->title; ?></option>
                                                        <?php }
                                                    } ?>
                                                </select>

                                            </td>
                                        </tr>
                                        <input type="hidden"  name="mahder_updated_id[<?php echo $members[0]->person_id_fk;?>]" value="<?php echo $members[0]->id; ?>"  >


                                        <?php
                                        if (!empty($members)) {
                                            if (sizeof($members) > 1) {
                                                for ($a = 1; $a < sizeof($members); $a++) {
                                                    ?>


                                                    <tr>
                                                        <td style="background-color: <?php echo $ccolor; ?>;"><?= $members[$a]->person_name ?></td>
                                                        <td style="background-color: <?php echo $ccolor; ?>;"
                                                            class="countable2<?php echo $session->mehwar_id_fk; ?>"><?= $members[$a]->total_armal ?></td>
                                                        <td style="background-color: <?php echo $ccolor; ?>;"
                                                            class="countable3<?php echo $session->mehwar_id_fk; ?>"><?= $members[$a]->total_yatem ?></td>
                                                        <td style="background-color: <?php echo $ccolor; ?>;"
                                                            class="countable4<?php echo $session->mehwar_id_fk; ?>"><?= $members[$a]->total_mostafed ?></td>
                                                        <td style="background-color: <?php echo $ccolor; ?>;">
                                                            <select class="form-control halet_file" name="halet_file[<?php echo $members[$a]->person_id_fk;?>]">
                                                                <option value="0">اختر</option>
                                                                <?php if (isset($file_status) && $file_status != null && !empty($file_status)){
                                                                    foreach ($file_status as $row){ ?>
                                                                        <option
                                                                                value="<?php echo $row->id; ?>"
                                                                            <?php if($members[$a]->halet_file_id_fk == $row->id){  echo 'selected'; } ?>
                                                                        ><?php echo $row->title; ?></option>
                                                                    <?php }
                                                                } ?>
                                                            </select>
                                                        </td>
                                                    </tr>
                                                    <input type="hidden"  name="mahder_updated_id[<?php echo $members[$a]->person_id_fk;?>]" value="<?php echo $members[$a]->id; ?>"  >
                                                <?php }
                                            }
                                        }


                                        ?>
                                        <?php

                                    }

                                ?>


                                </tbody>
                                <tfoot>
                                <th class="gray_background" colspan="4">المجموع</th>
                                <th class="result2<?php echo $session->mehwar_id_fk; ?>"></th>
                                <th class="result3<?php echo $session->mehwar_id_fk; ?>"></th>
                                <th class="result4<?php echo $session->mehwar_id_fk; ?>"></th>
                                <th class="gray_background">
                                    <button type="submit" name="action" value="f_members" class="btn btn-sm btn-purple status"><i class="fa fa-floppy-o"></i> حفظ</button>
                                </th>


                                </tfoot>
                            </table>



                            <?php
                            }

                            echo form_close();


                            ?>

                        <?php } else {

                            if (isset($session->mahder_details) && !empty($session->mahder_details)) { ?>

                            <!------------------------------------------------------->
<?php                                   echo form_open_multipart('family_controllers/LagnaSetting/Lagna_decisions_approved_action/basic');?>
                            <table id="" class="table table-striped table-bordered dt-responsive nowrap"
                                   cellspacing="0" width="100%">

                                <thead>
                                <tr>
                                    <th class="gray_background">م</th>
                                    <th class="gray_background">رقم الملف</th>
                                    <th class="gray_background">إسم رب الاسرة</th>
                                    <th class="gray_background">عدد الأفراد</th>
                                    <th class="gray_background">أرملة</th>
                                    <th class="gray_background">يتيم</th>
                                    <th class="gray_background">مستفيد</th>
                                    <th class="gray_background">قرار اللجنة</th>
                                </tr>
                                </thead>
                                <tbody>


                                <?php

                                    $z = 0;
                                    $all_member = 0;
                                    $armal = 0;
                                    $yatem = 0;
                                    $mostafed = 0;
                                    $Tall_member = 0;
                                    $Tyatem = 0;
                                    $Tarmal = 0;
                                    $Tmostafed = 0;

                                    foreach ($session->mahder_details as $row) {
                                        $z++;
                                        $armal = $armal + $row->total_armal;
                                        $yatem = $yatem + $row->total_yatem;
                                        $mostafed = $mostafed + $row->total_mostafed;
                                        $Tall_member += $row->total_armal + $row->total_yatem + $row->total_mostafed;
                                        $Tarmal += $row->total_armal;
                                        $Tyatem += $row->total_yatem;
                                        $Tmostafed += $row->total_mostafed;


                                        ?>

                                        <tr>
                                            <td><?php echo $z; ?></td>
                                            <td><?php echo $row->file_num; ?></td>
                                            <td width="30%"><?php echo $row->person_name; ?></td>
                                            <td><?php echo $row->total_afrad; ?></td>
                                            <td> <?php echo $row->total_armal; ?></td>
                                            <td><?php echo $row->total_yatem; ?></td>
                                            <td> <?php echo $row->total_mostafed; ?></td>
                                            <td><select class="form-control halet_file" name="halet_file[<?php echo $row->mother_national_num;?>]">
                                                    <option value="0">اختر</option>
                                                    <?php if (isset($file_status) && $file_status != null && !empty($file_status)){
                                                        foreach ($file_status as $status){ ?>
                                                            <option
                                                                    value="<?php echo $status->id; ?>"
                                                                <?php if($row->halet_file_id_fk == $status->id){  echo 'selected'; } ?>
                                                            ><?php echo $status->title; ?></option>
                                                        <?php }
                                                    } ?>
                                                </select></td>
                                        </tr>

                                        <input type="hidden"  name="mahder_updated_id[<?php echo $row->mother_national_num;?>]" value="<?php echo $row->id; ?>"  >
                                        <?php
                                    }

                                ?>

                                </tbody>
                                <tfoot>
                                <th class="gray_background" colspan="3">المجموع</th>
                                <th><?php echo $Tall_member; ?></th>
                                <th><?php echo $Tarmal; ?></th>
                                <th><?php echo $Tyatem; ?></th>
                                <th><?php echo $Tmostafed; ?></th>
                                <th class="gray_background">

                                    <button type="submit" name="action" value="basic" class="btn btn-sm btn-purple status"><i class="fa fa-floppy-o"></i> حفظ</button>

                                </th>
                                </tfoot>
                            </table>

                            <?php  echo form_close();?>
                        <?php } } ?>

                    </div>
                    <?php


                    $x++;
                }
            } ?>
            <?php } ?>
        </div>
    </div>
</div>

<script type="text/javascript" src="<?php echo base_url();?>/asisst/admin_asset/js/jquery-1.10.1.min.js"></script>

<script>


    var arr = [2, 4, 12, 14];

    for (var n = 0; n < arr.length; n++) {
        var type = arr[n];

        var cls1 = $(".res" + type).find("td.countable1" + type);
        var cls2 = $(".res" + type).find("td.countable2" + type);
        var cls3 = $(".res" + type).find("td.countable3" + type);
        var cls4 = $(".res" + type).find("td.countable4" + type);


        var sum1 = 0;
        var sum2 = 0;
        var sum3 = 0;
        var sum4 = 0;

        for (var i = 0; i < cls1.length; i++) {
            if (cls1[i].className == "countable1" + type) {
                sum1 += isNaN(cls1[i].innerHTML) ? 0 : parseInt(cls1[i].innerHTML);
            }

        }

        for (var i = 0; i < cls2.length; i++) {
            if (cls2[i].className == "countable2" + type) {
                sum2 += isNaN(cls2[i].innerHTML) ? 0 : parseInt(cls2[i].innerHTML);
            }
        }
        for (var i = 0; i < cls3.length; i++) {
            if (cls3[i].className == "countable3" + type) {
                sum3 += isNaN(cls3[i].innerHTML) ? 0 : parseInt(cls3[i].innerHTML);
            }
        }
        for (var i = 0; i < cls4.length; i++) {
            if (cls4[i].className == "countable4" + type) {
                sum4 += isNaN(cls4[i].innerHTML) ? 0 : parseInt(cls4[i].innerHTML);
            }
        }


        $(".result1" + type).text(sum1);
        $(".result2" + type).text(sum2);
        $(".result3" + type).text(sum3);
        $(".result4" + type).text(sum4);
    }


</script>