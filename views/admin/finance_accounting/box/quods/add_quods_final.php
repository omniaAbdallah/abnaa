<style type="text/css">
    .btn-group > .btn, .btn-group > .btn + .btn, .btn-group > .btn:first-child, .fc .fc-button-group > * {
        height: 34px !important;
        border-radius: 4px !important;
        margin: 0 !important;
    }

    .bootstrap-select.btn-group .dropdown-toggle .caret {
        right: 92% !important;
    }

    .btn-label {
        left: 12px;
    }

    input, select {
        font-weight: 600 !important;
        color: #002c52 !important;
        font-size: 16px !important;
    }

    .top-label {
        font-size: 13px;
        background-color: #428bca !important;
        border: 2px solid #428bca !important;
        text-shadow: none !important;
        font-weight: 500 !important;
    }

    .myspan {
        color: rgb(255, 0, 0);
        font-size: 12px;
        position: absolute;
        bottom: -16px;
        right: 20px;
    }

    .no-padding {
        padding-left: 0px !important;
        padding-right: 0px !important;
    }

    .print_forma {
        padding: 15px;
    }

    .piece-box {
        margin-bottom: 12px;
        border: 1px solid #73b300;
        display: inline-block;
        width: 100%;
    }

    .piece-heading {
        background-color: #9bbb59;
        display: inline-block;
        float: right;
        width: 100%;
    }

    .piece-body {
        width: 100%;
        float: right;
    }

    .bordered-bottom {
        border-bottom: 4px solid #9bbb59;
    }

    .piece-footer {
        display: inline-block;
        float: right;
        width: 100%;
        border-top: 1px solid #73b300;
    }

    .piece-heading h5 {
        margin: 4px 0;
    }

    .piece-box table {
        margin-bottom: 0
    }

    .piece-box table th,
    .piece-box table td {
        padding: 2px 8px !important;
    }

    h6 {
        font-size: 16px;
        margin-bottom: 3px;
        margin-top: 3px;
    }

    .print_forma table th {
        text-align: right;
    }

    .print_forma table tr th {
        vertical-align: middle;
    }

    .no-padding {
        padding: 0;
    }

    .header p {
        margin: 0;
    }

    .header img {
        height: 120px;
        width: 100%
    }

    .main-title {
        display: table;
        text-align: center;
        position: relative;
        height: 120px;
        width: 100%;
    }

    .main-title h4 {
        display: table-cell;
        vertical-align: bottom;
        text-align: center;
        width: 100%;
    }

    .print_forma hr {
        border-top: 1px solid #73b300;
        margin-top: 7px;
        margin-bottom: 7px;
    }

    .no-border {
        border: 0 !important;
    }

    .gray_background {
        background-color: #eee;
    }

    @media print {
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    }

    .footer img {
        width: 100%;
        height: 120px;
    }

    @page {
        size: A4;
        margin: 20px 0 0;
    }

    .open_green {
        background-color: #e6eed5;
    }

    .closed_green {
        background-color: #cdddac !important;
    }

    .table-bordered > thead > tr > th,
    .table-bordered > tbody > tr > th,
    .table-bordered > tfoot > tr > th,
    .table-bordered > thead > tr > td,
    .table-bordered > tbody > tr > td,
    .table-bordered > tfoot > tr > td {
        border: 1px solid #abc572;
    }

    .btn-close-model,
    btn-close-model:hover,
    btn-close-model:focus {
        background-color: #8a9e5f;
        color: #fff;
        margin-top: -20px;
    }

    .my_style {
        color: #222;
        font-size: 15px;
        font-weight: 500;
    }

    .one_three {
        width: 43% !important;
        float: right;
    }

    .two_three {
        width: 57% !important;
        float: right;
    }

    @media (min-width: 992px) {
        .col_md_10 {
            width: 10%;
            float: right;
        }

        .col_md_15 {
            width: 15%;
            float: right;
        }

        .col_md_20 {
            width: 20%;
            float: right;
        }

        .col_md_25 {
            width: 25%;
            float: right;
        }

        .col_md_30 {
            width: 30%;
            float: right;
        }

        .col_md_35 {
            width: 35%;
            float: right;
        }

        .col_md_40 {
            width: 40%;
            float: right;
        }

        .col_md_45 {
            width: 45%;
            float: right;
        }

        .col_md_50 {
            width: 50%;
            float: right;
        }

        .col_md_60 {
            width: 60%;
            float: right;
        }

        .col_md_70 {
            width: 70%;
            float: right;
        }

        .col_md_75 {
            width: 75%;
            float: right;
        }

        .col_md_80 {
            width: 80%;
            float: right;
        }

        .col_md_85 {
            width: 85%;
            float: right;
        }

        .col_md_90 {
            width: 90%;
            float: right;
        }

        .col_md_95 {
            width: 95%;
            float: right;
        }

        .col_md_100 {
            width: 100%;
            float: right;
        }
    }

    .label_title_2 {
        width: 100%;
        color: #222;
        font-weight: 600;
        background-color: #a8e613;
        border: 2px solid #a5e016;
        height: 34px;
        margin: 0;
        line-height: 34px;
        padding-right: 6px;
        font-size: 16px;
        margin-bottom: 5px;
    }

    .input_style_2 {
        border-radius: 0px;
        border-right: transparent;
        width: 100%;
    }

    .label-blue {
        background-color: #003665;
        border: 1px solid #003665;

        height: 34px;
        line-height: 25px !important;
        font-size: 13px !important;
        font-weight: 500 !important;
        text-align: right !important;
    }

    .bond-header {
        height: 55px;
        margin-bottom: 15px;
    }

    .bond-header .right-img img,
    .bond-header .left-img img {
        width: 100%;
        height: 55px;
    }

    .border-box {
        padding: 5px 20px;
        border: 5px double #000 !important;
        border-radius: 29px;
        font-size: 14px !important;
        color: #002c57 !important;
        font-weight: bold !important;
    }

    .border-box-h {
        padding: 3px 20px;
        border: 2px solid #222;
        border-radius: 24px;
    }

    .main-bond-title {
        display: table;
        height: 55px;
        text-align: center;
        width: 100%;
    }

    .main-bond-title h3 {
        display: table-cell;
        vertical-align: bottom;
        font-size: 12px;
    }

    .bond-body {
        padding: 10px;
        border: 2px solid #222;
        display: inline-block;
        width: 100%;
        border-radius: 30px;
        background: url(<?php echo base_url() ?>asisst/admin_asset/img/pills/back2.jpg);
        background-position: center;
        background-size: 50% 100%;
        background-repeat: no-repeat;
    }

    .bond-body h6 {
        font-size: 11px !important;
        color: #002c57 !important;
        font-weight: bold !important;
        line-height: 17px;
    }

    .bond-body h6 span {
        color: darkred;
    }

    .pad-2 {
        padding-left: 2px;
        padding-right: 2px;
    }

    .bond-footer h6 {
        font-size: 13px !important;
        color: #002c57 !important;
        font-weight: bold !important;
        line-height: 17px;
    }

    #cheq, #eda3, #shabka, #mosatadem {
        padding-top: 5px !important;
        padding-bottom: 5px !important;
    }

    .table_style {
        font-size: 11px !important;
        color: darkred !important;
        font-weight: bold !important;
        line-height: 17px !important;
        margin: 1px;
    }

    button[type=submit] {
        padding: 0px 12px;
    }

    .btn-label {
        right: -14px;
    }

    .list::-webkit-calendar-picker-indicator {
        display: none;
    }

    input[type=date]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        display: none;
    }

    input[type=date]::-webkit-clear-button {
        display: none;
        -webkit-appearance: none;
    }

    .tree ul {
        margin-right: 10px;
        position: relative;
        margin-left: 0;
    }

    .tree ul li {
        padding-left: 0;
    }

    .tree ul ul {
        margin-left: 0;
    }

    ul span {
        display: inline !important;
    }

    .fa-plus.sspan {
        background-color: #5b69bc;
        padding: 3px 6px;
        color: #fff;
        border-radius: 5px;
    }

    #colspan4 {
        text-align: right;
        color: red

    }

    .forTd {
        color: black !important;
        font-family: tahoma !important;
        font-size: 15px !important;
        font-weight: 700 !important;
    }

    .tb-table th, .tb-table td {
        padding: 4px !important;
    }

    .tb-table td .form-control {
        width: 100% !important;
    }
</style>

<div class="col-sm-12 no-padding">
    <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
        <div class="panel-heading">
            <h3 class="panel-title"><?= $title ?></h3>
        </div>
        <div class="panel-body">
            <?php
            $month = array("1" => "يناير", "2" => "فبراير", "3" => "مارس", "4" => "أبريل", "5" => "مايو",
                "6" => "يونيو", "7" => "يوليو", "8" => "أغسطس", "9" => "سبتمبر", "10" => "أكتوبر",
                "11" => "نوفمبر", "12" => "ديسمبر");
            $bond = '';
            if (isset($sarf) && $sarf != null) {
                $bond = $sarf['bnod_help_fk'];
            }
            if (isset($result) && !empty($result)) {
                $total_value = $result->total_value;
                $rkm = $result->rkm;
                $qued_date = $result->qued_date_ar;
                $no3_qued = $result->no3_qued;
                $halet_qued = $result->halet_qued;

                $button1 = 'display:none';
                $button2 = '';
                $action_button = '';

                       $halet_qued_arr = array(1 => 'تمت المراجعة', 2 => 'قيد المراجعة');  
                $form_action = 'finance_accounting/box/quods/Quods/update_quods/' . $result->id;
            } else {
                $total_value = 0;
                $rkm = $last_id;
                $qued_date = date('Y-m-d');
                $no3_qued = '';
                $halet_qued = '';

                $button2 = 'display:none';
                $button1 = '';
                 $halet_qued_arr = array(1 => 'تمت المراجعة');  
                $form_action = 'finance_accounting/box/quods/Quods/add_quods';

                $action_button = '<input name="action" value="action" type="hidden"  />';


            }
            ?>
            <?php //echo form_open_multipart($form_action)
            echo form_open_multipart($form_action, array('id' => 'form1'));
            echo $action_button;
            ?>
            <div class="col-md-12 no-padding">
                <div class="col_md_25 col-sm-6 padding-4">
                    <div class="col-md-5 col-sm-6 no-padding">
                        <h6 class="label_title_2 ">نوع القيد </h6>
                    </div>
                    <div class="col-md-7 col-sm-6 no-padding">
                        <?php $no3_qued_arr = array(1 => 'قيد إفتتاحي', 2 => 'قيد يومية', 3 => 'قيد ألي', 4 => 'قيد تسوية', 5 => 'قيد سند قبض', 6 => 'قيد سند صرف'); ?>
                        <select name="no3_qued" class="form-control inputclass" data-validation="required"
                                aria-required="true">
                            <option value="">إختر</option>
                            <?php foreach ($no3_qued_arr as $key => $value) { ?>
                                <option value="<?php echo $key . '-' . $value; ?>"
                                    <?php if ($no3_qued == $key) {
                                        echo 'selected';
                                    }
                                    if ($bond == 1 && $key == 2) {
                                        echo 'selected';
                                    } ?>
                                ><?= $value ?></option>
                            <?php } ?>
                        </select>
                    </div>
                </div>

                <div class="col_md_25 col-sm-6 padding-4">
                    <div class="col-md-5 col-sm-6 no-padding">
                        <h6 class="label_title_2 ">حالة القيد </h6>
                    </div>
                    <div class="col-md-7 col-sm-6 no-padding">
                        <?php 
                         //$halet_qued_arr = array(1 => 'تمت المراجعة', 2 => 'قيد المراجعة');
                        
                         ?>
                        <select name="halet_qued" class="form-control inputclass" data-validation="required"
                                aria-required="true">
                         <!--   <option value="">إختر</option> -->
                            <?php foreach ($halet_qued_arr as $key => $value) { ?>
                                <option value="<?php echo $key . '-' . $value; ?>"
                                    <?php if ($halet_qued == $key) {
                                        echo 'selected';
                                    }
                                    if ($bond == 1 && $key == 2) {
                                        echo 'selected';
                                    } ?>><?= $value ?></option>
                            <?php } ?>
                        </select>
                    </div>
                </div>

                <div class="col_md_25 col-sm-6 padding-4">
                    <div class="col-md-5 col-sm-6 no-padding">
                        <h6 class="label_title_2 ">رقم القيد </h6>
                    </div>
                    <?php $role = $_SESSION['role_id_fk'];
                    if (empty($result)) {
                        if ($role == 3) {
                            $style = 'readonly';
                        } elseif ($role == 1) {
                            $style = '';
                        }
                    } else {
                        $style = 'readonly';
                    }
                    ?>

                    <!--
                            <div class="col-md-7 col-sm-6 no-padding">
                                <input type="text"  name="rkm" value="<?= $rkm ?>" class="form-control input_style_2"
                                readonly="" data-validation-has-keyup-event="true">
                            </div>-->
                    <div class="col-md-7 col-sm-6 no-padding">
                        <input type="text" name="rkm" id="rkm"
                               value="<?= $rkm ?>" <?php if (empty($result)) { ?> onfocusout="CheckRkm($(this).val())" <?php } ?>
                               class="form-control input_style_2"
                            <?php echo $style; ?> data-validation-has-keyup-event="true">
                    </div>

                </div>

                <div class="col_md_25 col-sm-6 padding-4">
                    <div class="col-md-5 col-sm-6 no-padding">
                        <h6 class="label_title_2">تاريخ القيد </h6>
                    </div>
                    <div class="col-md-7 col-sm-6 no-padding">
                        <input type="date" name="qued_date" data-validation="required"
                               id="qued_date" value="<?= $qued_date ?>"
                               pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])/(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])/(?:30))|(?:(?:0[13578]|1[02])-31))"
                               class="form-control input_style_2" data-validation-has-keyup-event="true">
                    </div>
                </div>
            </div>

            <div class="col-md-12 no-padding">
                <table class="table table-striped table-bordered tb-table" style="table-layout: fixed;
                        " id="mytable">
                    <thead>
                    <tr class="info">
                        <th style="width: 72px;">مدين</th>
                        <th style="width: 72px;">دائن</th>
                        <th style="width: 80px;">رقم الحساب</th>
                        <th style="width: 190px;">إسم الحساب</th>
                        <th style="width: 40px;"> المرجع</th>
                        <th style="width: 75px;"> العملية</th>
                        <th style="width: 250px;">البيــــــــــان</th>
                        <th style="width: 30px;">الإجراء</th>
                    </tr>
                    </thead>

                    <tbody id="QuodresultTable">
                    <?php

                    $counter = 1;
                    if (!empty($result->details)) {
                        foreach ($result->details as $row_detail) {
                            ?>

                            <input type="hidden" value="<?= $row_detail->esal_rkm ?>"
                                   onkeypress="return validate_number(event);" class="form-control " step="any"
                                   name="esal_rkm[]">

                            <tr id="<?= $row_detail->id ?>">
                                <td>
                                    <input type="text" value="<?= $row_detail->maden ?>"
                                           onkeypress="return validate_number(event);" class="form-control accountmaden"
                                           step="any"
                                           name="maden_value[]" data-validation="required" aria-required="true"
                                           onkeyup="getTableSum();">
                                </td>
                                <td>
                                    <input type="text" value="<?= $row_detail->dayen ?>"
                                           onkeypress="return validate_number(event);" class="form-control accountdayen"
                                           step="any" name="dayen_value[]" data-validation="required"
                                           aria-required="true" onkeyup="getTableSum();">
                                </td>

                                <td>
                                    <input type="text" value="<?= $row_detail->rkm_hesab ?>"
                                           class="form-control testButton" name="rkm_hesab[]"
                                           id="account_num<?= $row_detail->id ?>" data-validation="required"
                                           aria-required="true" readonly=""
                                           onclick="$('#modalID').val(<?= $row_detail->id ?>); $(this).removeAttr('readonly');"
                                           ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');"
                                           style="cursor:pointer;" autocomplete="off"
                                           onkeypress="return isNumberKey(event);"
                                           onblur="$(this).attr('readonly','readonly')"
                                           onkeyup="getAccountName($(this).val(),<?= $row_detail->id ?>);">
                                </td>
                                <td>
                                    <input type="text" value="<?= $row_detail->hesab_name ?>" class="form-control"
                                           name="hesab_name[]" id="account<?= $row_detail->id ?>"
                                           data-validation="required" aria-required="true" readonly=""
                                           style="width: 100% !important;">
                                </td>
                                <td>
                                    <input type="text" value="<?= $row_detail->marg3 ?>"
                                           onkeypress="return validate_number(event);" class="form-control " step="any"
                                           name="marg3[]">
                                </td>
                                <td><select class="form-control " name="harka_id[]"
                                    >
                                        <option value="">إختر</option>
                                        <?php
                                        $pay_method_arr = array('إختر', 1 => 'نقدي', 2 => 'شيك', 3 => 'شبكة', 4 => 'إيداع نقدي'
                                        , 5 => 'إيداع شيك', 6 => 'تحويل', 7 => 'أمر مستديم', 8 => 'صرف شيك');

                                        if (isset($pay_method_arr) && !empty($pay_method_arr)) {
                                            for ($a = 1; $a < sizeof($pay_method_arr); $a++) {
                                                ?>
                                                <option value="<?php echo $a; ?>"

                                                    <?php if (!empty($row_detail->harka_id)) {
                                                        if ($row_detail->harka_id == $a) {
                                                            echo 'selected';
                                                        }
                                                    } ?>>
                                                    <?php echo $pay_method_arr[$a]; ?></option>
                                                <?php
                                            }
                                        }
                                        ?>
                                    </select></td>
                                <td>
                                    <input type="text" value="<?= $row_detail->byan ?>" class="form-control"
                                           name="byan[]" aria-required="true">
                                </td>
                                <td id="TD<?= $row_detail->id ?>">
                                    <a  onclick="addEditRow(<?= $row_detail->id ?>);"><i
                                                class="fa fa-plus sspan"></i></a>
                                    <a class="pull-right" id="deleteRow<?= $row_detail->id ?>"
                                       onclick="$('#<?= $row_detail->id ?>').remove();  $('#deleteRow<?= $row_detail->id ?>').show();getTableSum();"><i
                                                class="fa fa-trash" aria-hidden="true"></i>
                                    </a>

                                </td>
                            </tr>
                            <?php
                            $counter++;
                        }
                    }

                    if ($counter <= 1 && $bond == '') { ?>

                        <tr id="<?= $counter ?>">
                            <td>
                                <input type="text" onkeypress="return validate_number(event);"
                                       id="accountmaden<?= $counter ?>"
                                       class="form-control accountmaden all_total inputclass" step="any"
                                       name="maden_value[]" data-validation="required" aria-required="true"
                                       onkeyup="getTableSum();GetZeroFunction('accountdayen<?= $counter ?>');">
                            </td>
                            <td>
                                <input type="text" onkeypress="return validate_number(event);"
                                       id="accountdayen<?= $counter ?>"
                                       class="form-control accountdayen all_total inputclass" step="any"
                                       name="dayen_value[]" data-validation="required" aria-required="true"
                                       onkeyup="getTableSum();GetZeroFunction('accountmaden<?= $counter ?>');">
                            </td>

                            <td>
                                <input type="text" class="form-control testButton inputclass" name="rkm_hesab[]"
                                       id="account_num<?= $counter ?>" data-validation="required" aria-required="true"
                                       readonly=""
                                       onclick="$('#modalID').val(<?= $counter ?>); $(this).removeAttr('readonly');"
                                       ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');"
                                       style="cursor:pointer;" autocomplete="off"
                                       onkeypress="return isNumberKey(event);"
                                       onblur="$(this).attr('readonly','readonly')"
                                       onkeyup="getAccountName($(this).val(),<?= $counter ?>);">
                            </td>
                            <td>
                                <input type="text" class="form-control inputclass" name="hesab_name[]"
                                       id="account<?= $counter ?>" data-validation="required"
                                       aria-required="true" readonly=""

                                       style="width: 100% !important;"
                                >
                            </td>
                            <td>
                                <input type="text" class="form-control " step="any"
                                       onkeypress="return validate_number(event);" name="marg3[]">
                            </td>
                            <td><select class="form-control " name="harka_id[]"
                                >
                                    <option value="">إختر</option>
                                    <?php
                                    $pay_method_arr = array('إختر', 1 => 'نقدي', 2 => 'شيك', 3 => 'شبكة', 4 => 'إيداع نقدي'
                                    , 5 => 'إيداع شيك', 6 => 'تحويل', 7 => 'أمر مستديم', 8 => 'صرف شيك');

                                    if (isset($pay_method_arr) && !empty($pay_method_arr)) {
                                        for ($a = 1; $a < sizeof($pay_method_arr); $a++) {
                                            ?>
                                            <option value="<?php echo $a; ?>">
                                                <?php echo $pay_method_arr[$a]; ?></option>
                                            <?php
                                        }
                                    }
                                    ?>
                                </select></td>
                            <td>
                                <input type="text" class="form-control" name="byan[]" aria-required="true">
                            </td>
                            <td id="TD<?= $counter ?>">
                                <a class="pull-right" style="display: none;" id="deleteRow<?= $counter ?>"
                                   onclick="$('#<?= $counter ?>').remove(); getTableSum();"><i class="fa fa-trash"
                                                                                               aria-hidden="true"></i>
                                </a>
                            </td>
                        </tr>
                        <tr id="<?= $counter + 1 ?>">
                            <td>
                                <input type="text" onkeypress="return validate_number(event);"
                                       class="form-control accountmaden all_total inputclass"
                                       id="accountmaden<?= $counter + 1 ?>" step="any" name="maden_value[]"
                                       data-validation="required" aria-required="true"
                                       onkeyup="getTableSum();GetZeroFunction('accountdayen<?= $counter + 1 ?>');">
                            </td>
                            <td>
                                <input type="text" onkeypress="return validate_number(event);"
                                       class="form-control accountdayen all_total inputclass"
                                       id="accountdayen<?= $counter + 1 ?>" step="any" name="dayen_value[]"
                                       data-validation="required" aria-required="true"
                                       onkeyup="getTableSum();GetZeroFunction('accountmaden<?= $counter + 1 ?>');">
                            </td>

                            <td>
                                <input type="text" class="form-control testButton inputclass" name="rkm_hesab[]"
                                       id="account_num<?= $counter + 1 ?>" data-validation="required"
                                       aria-required="true" readonly=""
                                       onclick="$('#modalID').val(<?= $counter + 1 ?>); $(this).removeAttr('readonly');"
                                       ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');"
                                       style="cursor:pointer;" autocomplete="off"
                                       onkeypress="return isNumberKey(event);"
                                       onblur="$(this).attr('readonly','readonly')"
                                       onkeyup="getAccountName($(this).val(),<?= $counter + 1 ?>);">
                            </td>
                            <td>
                                <input type="text" class="form-control inputclass" name="hesab_name[]"
                                       id="account<?= $counter + 1 ?>"
                                       data-validation="required" aria-required="true" readonly=""
                                       style="width: 100% !important;"
                                />
                            </td>
                            <td>
                                <input type="text" class="form-control " step="any"
                                       onkeypress="return validate_number(event);" name="marg3[]">
                            </td>
                            <td><select class="form-control " name="harka_id[]"
                                >
                                    <option value="">إختر</option>
                                    <?php
                                    $pay_method_arr = array('إختر', 1 => 'نقدي', 2 => 'شيك', 3 => 'شبكة', 4 => 'إيداع نقدي'
                                    , 5 => 'إيداع شيك', 6 => 'تحويل', 7 => 'أمر مستديم', 8 => 'صرف شيك');

                                    if (isset($pay_method_arr) && !empty($pay_method_arr)) {
                                        for ($a = 1; $a < sizeof($pay_method_arr); $a++) {
                                            ?>
                                            <option value="<?php echo $a; ?>">
                                                <?php echo $pay_method_arr[$a]; ?></option>
                                            <?php
                                        }
                                    }
                                    ?>
                                </select></td>
                            <td>
                                <input type="text" class="form-control" name="byan[]" aria-required="true">
                            </td>
                            <td id="TD<?= $counter + 1 ?>">
                           <!--<a
                                   onclick="addNewRow(); $(this).remove(); $('#deleteRow<?= $counter + 1 ?>').show();"><i
                                            class="fa fa-plus sspan"></i></a>-->
                                <a class="pull-right" style="display: none;" id="deleteRow<?= $counter + 1 ?>"
                                   onclick="$('#<?= $counter + 1 ?>').remove(); getTableSum();"><i class="fa fa-trash"
                                                                                                   aria-hidden="true"></i>
                                </a>
                            </td>
                        </tr>
                    <?php }
                    //  echo $counter;
                    /*

                    echo '<pre/>';
                    print_r($main);*/
                    /*          echo '<pre/>';
                    print_r($sarf);
                  */
                    if ($counter <= 1 && $bond != '') {


                        for ($counter = 1; $counter <= 4; $counter++) {


                            if ($counter == 1) {
                                $byan = 'تغذية بطاقات الأسر لعدد ' . $sarf['aramel'] . ' لشهر ' . $month[$sarf['mon_melady']] . ' سنة ' . date("Y", $sarf['sarf_date']);
                                $total_value = $sarf['value'];
                                $tddd = '<a class="pull-right" style="" id="deleteRow`' . $counter . '`"  onclick="$(`#' . $counter . '`).remove(); getTableSum();"><i class="fa fa-trash" aria-hidden="true"></i>
                                                </a>';
                                if ($bond == 4) {
                                    $valueMadeen = $sarf['aramel'] * $sarf['value_armal'];
                                    $valueDayen = 0;
                                    $hesab = $sarf['rkm_hesab'];
                                    $name = $sarf['rkm_hesab_name'];
                                } else {
                                    $valueMadeen = $sarf['aramel'] * $sarf['value_armal'];
                                    $valueDayen = 0;
                                    $hesab = $sarf['rkm_hesab_armal'];
                                    $name = $sarf['rkm_hesab_armal_name'];
                                }


                            }


                            if ($counter > 1) {
                                $tddd = '<a class="pull-right" style="" id="deleteRow' . $counter . '"  onclick="$(`#' . $counter . '`).remove(); getTableSum();"><i class="fa fa-trash" aria-hidden="true"></i>
                                                </a>';


                                if ($counter == 2) {


                                    if ($bond == 4) {
                                        $valueMadeen = $sarf['aytam'] * $sarf['value_yatem'];
                                        $valueDayen = 0;
                                        $hesab = $sarf['rkm_hesab'];
                                        $name = $sarf['rkm_hesab_name'];
                                        $byan = 'تغذية بطاقات الأسر لعدد ' . $sarf['aytam'] . ' لشهر ' . $month[$sarf['mon_melady']] . ' سنة ' . date("Y", $sarf['sarf_date']);

                                    } else {
                                        $valueMadeen = $sarf['aytam'] * $sarf['value_yatem'];
                                        $valueDayen = 0;
                                        $hesab = $sarf['rkm_hesab_yatem'];
                                        $name = $sarf['rkm_hesab_yatem_name'];
                                        $byan = 'تغذية بطاقات الأسر لعدد ' . $sarf['aytam'] . ' لشهر ' . $month[$sarf['mon_melady']] . ' سنة ' . date("Y", $sarf['sarf_date']);

                                    }

                                } else {

                                    if ($bond == 4) {
                                        $valueMadeen = $sarf['mostafeed'] * $sarf['value_mostafed'];
                                        $valueDayen = 0;
                                        $hesab = $sarf['rkm_hesab'];
                                        $name = $sarf['rkm_hesab_name'];
                                        $byan = 'تغذية بطاقات الأسر لعدد ' . $sarf['mostafeed'] . ' لشهر ' . $month[$sarf['mon_melady']] . ' سنة ' . date("Y", $sarf['sarf_date']);

                                    } else {
                                        $valueMadeen = $sarf['mostafeed'] * $sarf['value_mostafed'];
                                        $valueDayen = 0;
                                        $hesab = $sarf['rkm_hesab_mostafed'];
                                        $name = $sarf['rkm_hesab_mostafed_name'];
                                        $byan = 'تغذية بطاقات الأسر لعدد ' . $sarf['mostafeed'] . ' لشهر ' . $month[$sarf['mon_melady']] . ' سنة ' . date("Y", $sarf['sarf_date']);

                                    }


                                }
                            }


                            if ($counter > 3) {
                                $tddd = '<a  onclick="addNewRow(); $(this).remove(); $(`#deleteRow' . $counter . '`).show();"><i class="fa fa-plus sspan"></i></a>
                                                <a class="pull-right" style="" id="deleteRow' . $counter . '"  onclick="$(`#' . $counter . '`).remove(); getTableSum();"><i class="fa fa-trash" aria-hidden="true"></i>
                                                </a>';
                                $valueDayen = $sarf['value'];
                                $valueMadeen = 0;
                                $hesab = $main['rkm_hesab'];
                                $name = $main['rkm_hesab_name'];
                                $byan = 'تحويل ' . $sarf['about'];
                            }
                            ?>
                            <tr id="<?= $counter ?>">
                                <td>
                                    <input type="text" onkeypress="return validate_number(event);"
                                           id="accountmaden<?= $counter ?>"
                                           class="form-control accountmaden all_total inputclass" step="any"
                                           name="maden_value[]" value="<?= ($valueMadeen) ?>" data-validation="required"
                                           aria-required="true"
                                           onkeyup="getTableSum();GetZeroFunction('accountdayen<?= $counter ?>');">
                                </td>
                                <td>
                                    <input value="<?= $valueDayen ?>" type="text"
                                           onkeypress="return validate_number(event);" id="accountdayen<?= $counter ?>"
                                           class="form-control accountdayen all_total inputclass" step="any"
                                           name="dayen_value[]" data-validation="required" aria-required="true"
                                           onkeyup="getTableSum();GetZeroFunction('accountmaden<?= $counter ?>');">
                                </td>

                                <td>
                                    <input value="<?= $hesab ?>" type="text" class="form-control testButton inputclass"
                                           name="rkm_hesab[]" id="account_num<?= $counter ?>" data-validation="required"
                                           aria-required="true" readonly=""
                                           onclick="$('#modalID').val(<?= $counter ?>); $(this).removeAttr('readonly');"
                                           ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');"
                                           style="cursor:pointer;" autocomplete="off"
                                           onkeypress="return isNumberKey(event);"
                                           onblur="$(this).attr('readonly','readonly')"
                                           onkeyup="getAccountName($(this).val(),<?= $counter ?>);">
                                </td>
                                <td>
                                    <input value="<?= $name ?>" type="text" class="form-control inputclass"
                                           name="hesab_name[]" id="account<?= $counter ?>" data-validation="required"
                                           aria-required="true" readonly=""

                                           style="width: 100% !important;"
                                    >
                                </td>
                                <td>
                                    <input type="text" class="form-control " step="any"
                                           onkeypress="return validate_number(event);" name="marg3[]"
                                           value="<?= $sarf['sarf_num'] ?>">
                                </td>
                                <td>
                                    <select class="form-control" name="harka_id[]">
                                        <option value="">إختر</option>
                                        <?php
                                        $pay_method_arr = array('إختر', 1 => 'نقدي', 2 => 'شيك', 3 => 'شبكة', 4 => 'إيداع نقدي'
                                        , 5 => 'إيداع شيك', 6 => 'تحويل', 7 => 'أمر مستديم', 8 => 'صرف شيك');

                                        if (isset($pay_method_arr) && !empty($pay_method_arr)) {
                                            for ($a = 1; $a < sizeof($pay_method_arr); $a++) {
                                                ?>
                                                <option value="<?php echo $a; ?>">
                                                    <?php echo $pay_method_arr[$a]; ?></option>
                                                <?php
                                            }
                                        }
                                        ?>
                                    </select>

                                </td>
                                <td>
                                    <input type="text" class="form-control" name="byan[]" aria-required="true"
                                           value="<?= $byan ?>">
                                </td>
                                <td id="TD<?= $counter ?>">
                                    <?= $tddd ?>
                                </td>
                            </tr>

                        <?php }
                    } ?>
                    </tbody>
                    <tfoot>
                    <tr>
                        <td id="total"
                            style=" text-align:center;font-size:16px;font-weight:bold;color: #002542"><?= $total_value ?> </td>
                        <td id="total2"
                            style=" text-align:center;font-size:16px;font-weight:bold;color: #002542"><?= $total_value ?></td>
                        <input type="hidden" class="total" name="total_value" value="<?= $total_value ?>">

                        <td  colspan="5"  style=" text-align:center;font-size:16px;font-weight:bold;color: #002542">الإجمـــــالي</td>

                        <td>                 <a
                                                  onclick="addNewRow(); "><i
                                        class="fa fa-plus sspan"></i></a></td>

                    </tr>
                    <tr>
                        <td  colspan="2" id="qued_percent"style=" text-align:center;font-size:16px;font-weight:bold;color: #002542"><?= $total_value ?> </td>
                        <input type="hidden" class="total" name="total_value" value="<?= $total_value ?>">
                        <td  colspan="6" style=" text-align:right;font-size:16px;font-weight:bold;color: #002542">الفرق بين الجانبين</td>


                        </td>
                    </tr>
                    </tfoot>
                </table>


            </div>
            <div class="col-md-12 " id="AttachTableDiv"></div>
            <div class="col-xs-12 text-center">
                <input type="hidden" name="modalID" id="modalID">


                <!--
                                    <button type="submit" class="btn btn-labeled btn-success myBtn" name="action" value="action" >
                                        <span class="btn-label"><i class="glyphicon glyphicon-floppy-disk"></i></span>حفظ
                                    </button>

                                    <button type="submit" class="btn btn-labeled btn-warning myBtn" style="color: ##FFB61E; !important;"
                                    name="action" value="action">
                                    <span class="btn-label"><i class="glyphicon glyphicon-pencil"></i></span>تعديل
                                </button>
                                -->
                <button type="button" onclick="checkInputs();getTableSum();" style="<?php echo $button1; ?>"
                        class="btn btn-labeled btn-success myBtnInsert" name="action" value="action">
                    <span class="btn-label"><i class="glyphicon glyphicon-floppy-disk"></i></span>حفظ
                </button>

                <button type="submit" style="<?php echo $button2; ?>" class="btn btn-labeled btn-warning myBtn"
                        style="color: ##FFB61E; !important;"
                        name="action" value="action">
                    <span class="btn-label"><i class="glyphicon glyphicon-pencil"></i></span>تعديل
                </button>


                <button type="button" class="btn btn-labeled btn-danger">
                    <span class="btn-label"><i class="glyphicon glyphicon-trash"></i></span>حذف
                </button>

                <button type="button" class="btn btn-labeled btn-purple">
                    <span class="btn-label"><i class="glyphicon glyphicon-print"></i></span>طباعة
                </button>
                <button type="button" class="btn btn-labeled btn-inverse " id="attach_button" onclick="checkInputs()"
                        data-toggle="modal">
                    <span class="btn-label"><i class="glyphicon glyphicon-cloud-upload"></i></span>
                    <?php if (empty($result->attaches)) {
                        echo 'اضافة مرفق';
                    } else {
                        echo 'عرض المرفقات ';
                    } ?>

                </button>
                <button type="button" class="btn btn-labeled btn-info" data-toggle="modal" data-target="#searchModal">
                    <span class="btn-label"><i class="glyphicon glyphicon-search"></i></span>البحث
                </button>
            </div>
            <?php echo form_close() ?>
        </div>
    </div>
</div>


<div class="col-sm-12 col-md-12 col-xs-12  " style="padding: 0;">
    <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
        <div class="panel-heading">
            <div class="panel-title">
                <h4>شاشة القيود</h4>
            </div>
        </div>
        <div class="panel-body">
            <div class="form-group col-sm-12 col-xs-12">

                <!-- Nav tabs -->
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab1" data-toggle="tab">قيود قيد المراجعة</a></li>
                    <li><a href="#tab2" data-toggle="tab"> قيود تمت المراجعة</a></li>
                </ul>
                <!-- Tab panels -->
                <div class="tab-content">
                    <div class="tab-pane fade in active" id="tab1">
                        <div class="panel-body">
                            <?php

                            if (!empty($QuodsNotTransfered)) {
                                ?>
                                <table id="example" class="table table-bordered" role="table">
                                    <thead>
                                    <tr class="info">
                                        <th width="2%">م</th>
                                        <th class="text-left">نوع القيد</th>
                                        <th class="text-left">حالة القيد</th>
                                        <th class="text-left">رقم القيد</th>
                                        <th class="text-left">التاريخ</th>
                                        <th class="text-left">قيمة القيد</th>
                                        <th class="text-left">وقت القيد</th>
                                        <th class="text-left">القائم بالإدخال</th>
                                        <th class="text-left">الإجراء</th>

                                    </tr>
                                    </thead>
                                    <tbody>
                                    <?php

                                    if (isset($QuodsNotTransfered) && $QuodsNotTransfered != null) {
                                        $x = 1;
                                        foreach ($QuodsNotTransfered as $value) {
                                            ?>
                                            <tr>
                                                <td><?= $x++ ?></td>
                                                <td><?= $value->no3_qued_name ?></td>
                                                <td><?= $value->halet_qued_name ?></td>
                                                <td><?= $value->rkm ?></td>
                                                <td><?= $value->qued_date_ar ?></td>
                                                <td><?= number_format($value->total_value, 2) ?></td>
                                                <td><?= date('H:i:sa', $value->date_s) ?></td>
                                                <td><?= $value->publisher_name ?></td>
                                                <td>
                                                    <a title="عرض المرفق" href="#" data-toggle="modal"
                                                       data-target="#myModal_attach2<?php echo $value->id; ?>"> <i
                                                                class="fa fa-eye" aria-hidden="true"></i> </a>


<a href="<?= base_url() . "finance_accounting/box/quods/Quods/update_quods/" . $value->id ?>"
   title="تعديل"><i class="fa fa-pencil"></i></a>

<a onclick="$('#adele').attr('href', '<?= base_url() . "finance_accounting/box/quods/Quods/deleteQuod/" . $value->rkm ?>');"
   data-toggle="modal" data-target="#modal-delete" title="حذف"><i
            class="fa fa-trash"></i></a>
<a type="button" onclick="getDetails(<?= $value->id ?>)"
   class="btn btn-sm btn-info" data-toggle="modal"
   data-target="#detailsModal"
   style="padding: 3px 5px;line-height: 1;">
    <i class="glyphicon glyphicon-list"></i> التفاصيل
</a>
<a href="<?= base_url() . "finance_accounting/box/quods/Quods/print_qued/" . $value->rkm ?>"
   target="_blank" title="طباعه">
    <i class="fa fa-print"></i></a>


                                                    <?php
                                                    /*
                                                    if($value->deport==0){?>
                                                    <button style="color: black !important;" class="btn btn-sm btn-warning tarhel<?=$value->rkm ?>"
                                                     onclick="tarhel(<?=$value->rkm ?>);">
                                                    ترحيل القيد
                                                     <i class="glyphicon glyphicon-backward"></i>
                                                    </button>
                                                    <?php } else {?>
                                                    <button class="btn btn-success" onclick="tarhel(<?=$value->rkm ?>);">تم ترحيل القيد </button>
                                                    <?php }
                                                    */
                                                    ?>
                                                    <?php
                                                    if ($value->deport == 0) {
                                                        ?>
                                                        <button style="color: black !important;"
                                                                class="btn btn-sm btn-warning tarhel<?= $value->rkm ?>"
                                                                onclick="tarhel(<?= $value->rkm ?>,1);"> ترحيل القيد
                                                            <i class="glyphicon glyphicon-backward"></i>
                                                        </button>
                                                    <?php } else { ?>
                                                        <button class="btn btn-success"
                                                                onclick="tarhel(<?= $value->rkm ?>);">تم ترحيل القيد
                                                        </button>

                                                    <?php } ?>


                                                </td>
                                                <!--
<td>
<?php
                                                if ($value->deport == 0) {
                                                    ?>
<button class="btn btn-danger tarhel<?= $value->rkm ?>" onclick="tarhel(<?= $value->rkm ?>);"> ترحيل </button>
<?php } else { ?>
<button class="btn btn-success" onclick="tarhel(<?= $value->rkm ?>);">تم ترحيل القيد </button>

<?php } ?>
</td>-->


                                            </tr>
                                            <?php
                                        }
                                    }
                                    ?>
                                    </tbody>
                                </table>

                                <!------------------------------------------->

                                <!----------------------------------------------------------->
                                <?php $x = 0;
                                foreach ($QuodsNotTransfered as $row) {
                                    $x++; ?>

                                    <div class="modal fade" id="myModal_attach2<?php echo $row->id; ?>" tabindex="-1"
                                         role="dialog" aria-labelledby="myModalLabel">
                                        <div class="modal-dialog" role="document" style="width: 50%">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                        <span aria-hidden="true">&times;</span></button>
                                                    <h4 class="modal-title" id="myModalLabel">المرفقات</h4>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="">
                                                        <?php if (!empty($row->attaches)) { ?>
                                                            <table class="table table-striped table-bordered fixed-table mytable "
                                                                <?php if (empty($row->attaches)) { ?>  style="display: none; "  <?php } ?> >
                                                                <thead>
                                                                <tr class="info">
                                                                    <th class="text-center"> إسم المرفق</th>
                                                                    <th class="text-center">المرفق</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody class="attachTable">

                                                                <?php $a = 1;
                                                                foreach ($row->attaches as $row_img) { ?>
                                                                    <tr class="<?= $a ?>">
                                                                        <td><input type="input" name="" readonly
                                                                                   id="title"
                                                                                   value="<?= $row_img->title ?>"
                                                                                   class="form-control  " ">
                                                                        </td>
                                                                        <td><img id="img_view<?= $x ?>"
                                                                                 src="<?php echo base_url() . 'uploads/images/finance_accounting/box/quods/' . $row_img->file_attached ?>"
                                                                                 width="150px" height="150px"/></td>
                                                                    </tr>
                                                                    <?php $a++;
                                                                } ?>
                                                                </tbody>
                                                            </table>
                                                        <?php } else { ?>
                                                            <div class="alert alert-danger"> لا توجد مرفقات</div>

                                                        <?php } ?>
                                                    </div>
                                                </div>
                                                <div class="modal-footer" style="display: inline-block;width: 100%">
                                                    <button type="button" class="btn btn-danger"
                                                            data-dismiss="modal">إغلاق
                                                    </button>

                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                <?php } ?>

                                <!-------------------------------------------->


                            <?php } else { ?>
                                <div style="color: red; font-size: large;" class="col-sm-12">لم يتم إضافة قيود قيد
                                    المراجعة
                                    !!
                                </div>

                            <?php } ?>


                        </div>
                    </div>
                    <div class="tab-pane fade" id="tab2">
                        <div class="panel-body">


                            <?php if (!empty($QuodsTransfered)) { ?>
                                <table id="example" class="table table-bordered" role="table">
                                    <thead>
                                    <tr class="info">
                                        <th width="2%">م</th>
                                        <th class="text-left">نوع القيد</th>
                                        <th class="text-left">حالة القيد</th>
                                        <th class="text-left">رقم القيد</th>
                                        <th class="text-left">التاريخ</th>
                                        <th class="text-left">وقت القيد</th>
                                        <th class="text-left">القائم بالإدخال</th>
                                        <th class="text-left">الإجراء</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <?php

                                    if (isset($QuodsTransfered) && $QuodsTransfered != null) {
                                        $x = 1;
                                        foreach ($QuodsTransfered as $value) {
                                            ?>
                                            <tr>
                                                <td><?= $x++ ?></td>
                                                <td><?= $value->no3_qued_name ?></td>
                                                <td><?= $value->halet_qued_name ?></td>
                                                <td><?= $value->rkm ?></td>
                                                <td><?= $value->qued_date_ar ?></td>
                                                <td><?= date('H:i:sa', $value->date_s) ?></td>
                                                <td><?= $value->publisher_name ?></td>
                                                <td>
                                                    <a title="عرض المرفق" href="#" data-toggle="modal"
                                                       data-target="#myModal_attach3<?php echo $value->id; ?>"> <i
                                                                class="fa fa-eye" aria-hidden="true"></i> </a>

          <!--  <a href="<?= base_url() . "finance_accounting/box/quods/Quods/update_quods/" . $value->id ?>"
               title="تعديل"><i class="fa fa-pencil"></i></a>

            <a onclick="$('#adele').attr('href', '<?= base_url() . "finance_accounting/box/quods/Quods/deleteQuod/" . $value->rkm ?>');"
               data-toggle="modal" data-target="#modal-delete" title="حذف"><i
                        class="fa fa-trash"></i></a>
                        -->
            <a type="button" onclick="getDetails(<?= $value->id ?>)"
               class="btn btn-sm btn-info" data-toggle="modal"
               data-target="#detailsModal"
               style="padding: 3px 5px;line-height: 1;">
                <i class="glyphicon glyphicon-list"></i> التفاصيل
            </a>
            <a href="<?= base_url() . "finance_accounting/box/quods/Quods/print_qued/" . $value->rkm ?>"
               target="_blank" title="طباعه"><i class="fa fa-print"></i></a>


                                                    <?php
                                                    if ($value->deport == 0) {
                                                        ?>
                                                        <button class="btn btn-sm btn-danger tarhel<?= $value->rkm ?>"
                                                                onclick="tarhel(<?= $value->rkm ?>);"> ترحيل

                                                        </button>
                                                    <?php } else { ?>
                                                        <button class="btn btn-sm btn-danger"
                                                                onclick="tarhel(<?= $value->rkm ?>,0);">الغاء ترحيل
                                                            القيد
                                                            <i class="glyphicon glyphicon-forward"></i>
                                                        </button>

                                                    <?php } ?>


                                                </td>
                                            </tr>
                                            <?php
                                        }
                                    }
                                    ?>
                                    </tbody>
                                </table>

                                <!----------------------------------------------------------->
                                <?php $a = 0;
                                foreach ($QuodsTransfered as $row) {
                                    ?>

                                    <div class="modal fade" id="myModal_attach3<?php echo $row->id; ?>" tabindex="-1"
                                         role="dialog" aria-labelledby="myModalLabel">
                                        <div class="modal-dialog" role="document" style="width: 50%">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <button type="button" class="close" data-dismiss="modal"
                                                            aria-label="Close">
                                                        <span aria-hidden="true">&times;</span></button>
                                                    <h4 class="modal-title" id="myModalLabel">المرفقات</h4>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="">
                                                        <?php if (!empty($row->attaches)) { ?>
                                                            <table class="table table-striped table-bordered fixed-table mytable "
                                                                <?php if (empty($row->attaches)) { ?>  style="display: none; "  <?php } ?> >
                                                                <thead>
                                                                <tr class="info">
                                                                    <th class="text-center"> إسم المرفق</th>
                                                                    <th class="text-center">المرفق</th>
                                                                </tr>
                                                                </thead>
                                                                <tbody class="attachTable">

                                                                <?php $a = 1;
                                                                foreach ($row->attaches as $row_img) { ?>
                                                                    <tr class="<?= $a ?>">
                                                                        <td><input type="input" name="" readonly
                                                                                   id="title"
                                                                                   value="<?= $row_img->title ?>"
                                                                                   class="form-control  " ">
                                                                        </td>
                                                                        <td><img id="img_view<?= $a ?>"
                                                                                 src="<?php echo base_url() . 'uploads/images/finance_accounting/box/quods/' . $row_img->file_attached ?>"
                                                                                 width="150px" height="150px"/></td>
                                                                    </tr>
                                                                    <?php $a++;
                                                                } ?>
                                                                </tbody>
                                                            </table>

                                                        <?php } else { ?>
                                                            <div class=" alert alert-danger"> لا توجد مرفقات</div>

                                                        <?php } ?>
                                                    </div>
                                                </div>
                                                <div class="modal-footer" style="display: inline-block;width: 100%">

                                                    <button type="button" class="btn btn-danger"
                                                            data-dismiss="modal">إغلاق
                                                    </button>

                                                </div>
                                            </div>
                                        </div>
                                    </div>


                                    <?php $a++;
                                } ?>
                                <!----------------------------------------------------------->


                            <?php } else { ?>
                                <div style="color: red; font-size: large;" class="col-sm-12">لم يتم إضافة قيود تمت
                                    مراجعتها
                                    !!
                                </div>

                            <?php } ?>


                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>


<!------ modals --------------------------------------------->

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">الدليل المحاسبي </h4>
            </div>
            <div class="modal-body">
                <?php //if(!empty($tree)) {

                ?>
                <table id="" class="table table-bordered example" role="table">
                    <thead>
                    <tr class="info">
                        <th style="font-size: 15px; width:88px !important; ">م</th>
                        <th style="font-size: 15px;" class="text-left">رقم الحساب</th>
                        <th style="font-size: 15px;" class="text-left">إسم الحساب</th>
                    </tr>
                    </thead>
                    <tbody>
                    <?php
                    if (isset($tree) && $tree != null) {
                        buildTreeTable($tree);
                    }
                    function buildTreeTable($tree, $count = 1)
                    {
                        $types = array(1 => 'رئيسي', 2 => 'فرعي');
                        $nature = array('', 'مدين', 'دائن');
                        $follow = array(1 => 'ميزانية', 2 => 'قائمة الأنشطة');
                        //   $colorArray = array(1=>'#FFB61E', 2=>'#3c990b', 3=>'#5b69bc', 4=>'#E5343D', 5=>'#d9edf7');
                        $colorArray = array(1 => '#ec9732', 2 => '#c07852', 3 => '#75bf67', 4 => '#b6ab2d', 5 => '#09b6bb', 6 => '#3088d8', 7 => '#4d92a7', 8 => '#ef6c02', 9 => '#a69fb9', 10 => '#67351b', 11 => '#b6ea47', 12 => '#e18091', 13 => '#f5f44d', 14 => '#a63daa', 15 => '#fb1f73', 16 => '#9b9a92', 17 => '#8f0e0b', 18 => '#397631', 19 => '#074183', 20 => '#cab11e');


                        foreach ($tree as $record) {
                            $onclick = "alert('ليس حساب فرعي');";
                            if ($record->hesab_no3 == 2) {
                                $onclick = "$('#account_num'+$('#modalID').val()).val(" . $record->code . "); $('#account'+$('#modalID').val()).val('" . $record->name . "'); $('#myModal').modal('hide');";
                            }
                            ?>
                            <tr style="background-color: <?= $colorArray[$record->level] ?>; cursor: pointer;"
                                onclick="<?= $onclick ?>">
                                <td class="forTd"><?= $count++ ?></td>
                                <td class="forTd"><?= $record->code ?></td>
                                <td class="forTd"><?= $record->name ?></td>
                            </tr>
                            <?php
                            if (isset($record->subs)) {
                                $count = buildTreeTable($record->subs, $count++);
                            }
                        }
                        return $count;
                    }

                    ?>
                    </tbody>
                </table>
                <?php // } ?>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="detailsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">تفاصيل القيد </h4>
            </div>
            <div class="modal-body " id="optionearea1">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="myModal_attach" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 50%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">المرفقات</h4>
            </div>
            <div class="modal-body">
                <button type="button" onclick="add_row()" class="btn btn-success btn-next"/>
                <i class="fa fa-plus"></i> إضافة </button><br><br>
                <div class="AttachTable">


                    <table class="table table-striped table-bordered fixed-table mytable "
                        <?php if (empty($result->attaches)) { ?>  style="display: none; "  <?php } ?> >
                        <thead>
                        <tr class="info">
                            <th class="text-center"> إسم المرفق</th>
                            <th class="text-center">المرفق</th>
                            <th class="text-center"> الإجراء</th>
                        </tr>
                        </thead>
                        <tbody class="attachTable">
                        <?php if (!empty($result->attaches)) { ?>
                            <?php $x = 1;
                            foreach ($result->attaches as $row_img) { ?>
                                <tr class="<?= $x ?>">
                                    <td><input type="input" name="title[]" readonly id="title"
                                               value="<?= $row_img->title ?>" class="form-control  "
                                               data-validation="reuqired"></td>
                                    <td><img id="img_view<?= $x ?>"
                                             src="<?php echo base_url() . 'uploads/images/finance_accounting/box/quods/' . $row_img->file_attached ?>"
                                             width="150px" height="150px"/></td>
                                    <td>

                                        <a onclick="$('#adele').attr('href', '<?php echo base_url() . 'finance_accounting/box/quods/Quods/deleteQuodImg/' . $row_img->id . '/' . $row_img->qued_rkm_fk ?>');"
                                           data-toggle="modal" data-target="#modal-delete" title="حذف"><i
                                                    class="fa fa-trash"></i></a>


                                        <!--              <a href="<?php /*echo  base_url().'finance_accounting/box/quods/Quods/deleteQuodImg/'.$row_img->id.'/'.$row_img->qued_rkm_fk*/ ?>"  onclick="DeleteRowImg('<? /*=$x*/ ?>')"> <i class="fa fa-trash" ></i> </a></td>-->
                                </tr>
                                <?php $x++;
                            }
                        } ?>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer" style="display: inline-block;width: 100%">
                <!--<input type="hidden" name="id" id="id" >-->
                <button type="button" class="btn btn-success" style="display: inline-block;padding: 6px 12px;"
                        onclick="GetAttachTable()"
                        id="saves" data-dismiss="modal">حفظ
                </button>
                <button type="button" class="btn btn-danger"
                        data-dismiss="modal">إغلاق
                </button>

            </div>
        </div>
    </div>
</div>

<!------ modals --------------------------------------------->
<script>


    function addEditRow(div) {

        var x = document.getElementById('QuodresultTable');
        var id = x.rows.length + 1;
        var html = `<tr id="` + id + `">\
                        <td>\
                        <input type="text"   onkeypress="return validate_number(event);" class="form-control accountmaden all_total" id="accountdayen` + id + `" step="any" name="maden_value[]" data-validation="required" aria-required="true"  onkeyup="getTableSum();GetZeroFunction('accountmaden` + id + `');">\
                        </td>\
                        <td>\
                        <input type="text"  onkeypress="return validate_number(event);" class="form-control accountdayen all_total"  id="accountmaden` + id + `" step="any" name="dayen_value[]" data-validation="required" aria-required="true"   onkeyup="getTableSum();GetZeroFunction('accountdayen` + id + `');">\
                        </td>\

                        <td>\
                        <input type="text" class="form-control testButton" name="rkm_hesab[]" id="account_num` + id + `" data-validation="required" aria-required="true" readonly="" onclick="$('#modalID').val(` + id + `); $(this).removeAttr('readonly');" ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');" style="cursor:pointer;" autocomplete="off" onkeypress="return isNumberKey(event);" onblur="$(this).attr('readonly','readonly')" onkeyup="getAccountName($(this).val(),` + id + `);">\
                        </td>\
                        <td>\
                        <input type="text" class="form-control" name="hesab_name[]" id="account` + id + `" data-validation="required" aria-required="true" readonly="" >\
                        </td>\
                        <td>\
                        <input type="text" class="form-control " step="any" name="marg3[]">\
                        </td>\
                        <td>\
                        <select class="form-control " name="harka_id[]" id="harka_id` + id + `">
                         <option value="">إختر</option>
                      <?php
            $pay_method_arr = array('إختر', 1 => 'نقدي', 2 => 'شيك', 3 => 'شبكة', 4 => 'إيداع نقدي'
            , 5 => 'إيداع شيك', 6 => 'تحويل', 7 => 'أمر مستديم', 8 => 'صرف شيك');

            if(isset($pay_method_arr) && !empty($pay_method_arr)) {
            for($a = 1;$a < sizeof($pay_method_arr);$a++){
            ?>
                                                                <option value="<?php echo $a;?>">
                                                                    <?php echo $pay_method_arr[$a];?></option >
                                                                <?php
            }
            }
            ?>
                        </select>
                        </td>\
                        <td>\
                        <input type="text" class="form-control" name="byan[]"  aria-required="true">\
                        </td>\
                        <td id="TD` + id + `">\
                        \
                        <a class="pull-right" id="deleteRow` + id + `" onclick="addPlusButtonQuod(` + id + `); getTableSum();"> <i class="fa fa-trash" aria-hidden="true"></i>
                        </a>\
                        </td>\
                        </tr>`;
        $("#" + div).after(html);
    }

</script>

<script>

    document.addEventListener("DOMContentLoaded", function (event) {
        getTableSum();
    });

    function addNewRow() {
        var x = document.getElementById('QuodresultTable');
         var id = x.rows.length + 1;
       // var id = parseFloat($("#QuodresultTable tr:last").attr('id')) + 1;

        var html = `<tr id="` + id + `">\
                        <td>\
                        <input type="text"   onkeypress="return validate_number(event);" class="form-control accountmaden all_total" id="accountdayen` + id + `" step="any" name="maden_value[]" data-validation="required" aria-required="true"  onkeyup="getTableSum();GetZeroFunction('accountmaden` + id + `');">\
                        </td>\
                        <td>\
                        <input type="text"  onkeypress="return validate_number(event);" class="form-control accountdayen all_total"  id="accountmaden` + id + `" step="any" name="dayen_value[]" data-validation="required" aria-required="true"   onkeyup="getTableSum();GetZeroFunction('accountdayen` + id + `');">\
                        </td>\

                        <td>\
                        <input type="text" class="form-control testButton" name="rkm_hesab[]" id="account_num` + id + `" data-validation="required" aria-required="true" readonly="" onclick="$('#modalID').val(` + id + `); $(this).removeAttr('readonly');" ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');" style="cursor:pointer;" autocomplete="off" onkeypress="return isNumberKey(event);" onblur="$(this).attr('readonly','readonly')" onkeyup="getAccountName($(this).val(),` + id + `);">\
                        </td>\
                        <td>\
                        <input type="text" class="form-control" name="hesab_name[]" id="account` + id + `" data-validation="required" aria-required="true" readonly="" >\
                        </td>\
                        <td>\
                        <input type="text" class="form-control " step="any" name="marg3[]">\
                        </td>\
                        <td>\
                        <select class="form-control " name="harka_id[]" id="harka_id` + id + `">
                         <option value="">إختر</option>
                      <?php
            $pay_method_arr = array('إختر', 1 => 'نقدي', 2 => 'شيك', 3 => 'شبكة', 4 => 'إيداع نقدي'
            , 5 => 'إيداع شيك', 6 => 'تحويل', 7 => 'أمر مستديم', 8 => 'صرف شيك');

            if(isset($pay_method_arr) && !empty($pay_method_arr)) {
            for($a = 1;$a < sizeof($pay_method_arr);$a++){
            ?>
                                                                <option value="<?php echo $a;?>">
                                                                    <?php echo $pay_method_arr[$a];?></option >
                                                                <?php
            }
            }
            ?>
                        </select>
                        </td>\
                        <td>\
                        <input type="text" class="form-control" name="byan[]"  aria-required="true">\
                        </td>\
                        <td id="TD` + id + `">\
                        \
                        <a class="pull-right" id="deleteRow` + id + `" onclick="addPlusButtonQuod(` + id + `); getTableSum();"> <i class="fa fa-trash" aria-hidden="true"></i>
                        </a>\
                        </td>\
                        </tr>`;


        $("#QuodresultTable").append(html);
    }


    function addPlusButtonQuod(id) {
        if (parseFloat($("#QuodresultTable tr:last").attr('id')) == id) {
            $('#' + id).remove();
            var last = $("#QuodresultTable tr:last").attr('id');
            //$('#TD' + $("#QuodresultTable tr:last").attr('id')).append(`<a  onclick="addNewRow(); $(this).remove(); $('#deleteRow` + last + `').show();"><i class="fa fa-plus sspan"></i></a>`);
        } else {
            $('#' + id).remove();
        }
    }

    function isFloat(n) {
        return n === +n && n !== (n|0);
    }

    function getTableSum() {


        var total = 0;
        $(".accountmaden").each(function () {
            if ($(this).val()) {
                total += parseFloat($(this).val());
            }
        });
       // $('#total').html(total.toFixed(2));
        $('.total').val(total);
        if (isFloat(total) == true) {
            $('#total').html(total.toFixed(2));

        } else {
            $('#total').html(total);

        }


        var total2 = 0;
        $(".accountdayen").each(function () {
            if ($(this).val()) {
                total2 += parseFloat($(this).val());
            }
        });


        if (isFloat(total2) == true) {
            $('#total2').html(total2.toFixed(2));

        } else {
            $('#total2').html(total2);

        }

      var qued_percent = Math.abs(total - total2);

        if (isFloat(qued_percent) == true) {
            $('#qued_percent').html(qued_percent.toFixed(2));

        } else {
            $('#qued_percent').html(qued_percent);

        }

        if (parseInt(qued_percent) == 0  && total == total2 ) {
            GetTotalValueArabic(total2);
            $('#qued_percent').attr('style', 'background-color:#c0ff9f;font-size:18px;font-weight:bold;text-align:center');
            $('#total').attr('style', 'background-color:#c0ff9f;font-size:18px;font-weight:bold;text-align:center');
            $('#total2').attr('style', 'background-color:#c0ff9f;font-size:18px;font-weight:bold;text-align:center');
            $(".myBtnInsert").attr('onclick', "save_me()");
            $('.myBtn').prop('type', 'submit');

        } else {
            $('#qued_percent').attr('style', 'background-color:#ffaeae;font-size:18px;font-weight:bold;text-align:center');
            $('#total').attr('style', 'background-color:#ffaeae;font-size:18px;font-weight:bold;text-align:center');
            $('#total2').attr('style', 'background-color:#ffaeae;font-size:18px;font-weight:bold;text-align:center');
            $('.myBtn').prop('type', 'button');
            $(".myBtnInsert").removeAttr('onclick', "save_me()");
            $('#total_value_arabic').html(' ');

        }



        /*if (total > 0 && total2 > 0) {

            if (total != total2) {


                $('#total').attr('style', 'background-color:#ffaeae;font-size:18px;font-weight:bold;text-align:center');
                $('#total2').attr('style', 'background-color:#ffaeae;font-size:18px;font-weight:bold;text-align:center');
                $('.myBtn').prop('type', 'button');
                $(".myBtnInsert").removeAttr('onclick', "save_me()");
                $('#total_value_arabic').html(' ');

            } else {
                GetTotalValueArabic(total2);

                $('#total').attr('style', 'background-color:#c0ff9f;font-size:18px;font-weight:bold;text-align:center');
                $('#total2').attr('style', 'background-color:#c0ff9f;font-size:18px;font-weight:bold;text-align:center');
                $(".myBtnInsert").attr('onclick', "save_me()");
                $('.myBtn').prop('type', 'submit');


            }
        }*/


        var x = document.getElementById('QuodresultTable');
        if (x.rows.length == 1) {
            $('#deleteRow' + $("#resultTable tr:last").attr('id') + '').css({display: 'none'});
        }


    }


    $("input[name=searchType]").click(function () {
        if ($(this).val() == 2) {
            $('.divDate').show();
            $('.dateSearch').removeAttr('disabled');
            $('.dateSearch').attr('data-validation', 'required');
        } else {
            $('.divDate').hide();
            $('.dateSearch').removeAttr('data-validation');
            $('.dateSearch').attr('disabled', 'disabled');
        }
    });


</script>


<Script>
    function GetZeroFunction(MyId) {
        $('#' + MyId).val(0);
    }
</Script>
<script>
    function getDetails(valu) {
        if (valu != 0 && valu != '') {
            var dataString = 'id=' + valu;
            $.ajax({
                type: 'post',
                url: '<?php echo base_url() ?>finance_accounting/box/quods/Quods/getDetails',
                data: dataString,
                dataType: 'html',
                cache: false,
                success: function (html) {
                    $("#optionearea1").html(html);
                }
            });

        }

    }

</script>


<script>
    function checkInputs() {

        var inputsNotEmprty = []
        $(".inputclass").each(function () {
            if ($(this).val() != '') {
                inputsNotEmprty.push($(this).val());
            }
        });
        if ($('.inputclass').length == inputsNotEmprty.length) {
            $("#attach_button").attr('data-target', '#myModal_attach');
        } else {
            $("#attach_button").removeAttr('data-target', '#myModal_attach');
            alert('تأكد من إدخال الحقول الناقصة!');
        }

    }
</script>


<script>
    function add_row() {
        $(".mytable").show();
        //var x = document.getElementById('resultTable');
        var len = $(".attachTable").length + 1;

        $(".attachTable").append('<tr class="' + len + '"><td><input type="input" name="title[]" id="title"  class="form-control  " data-validation="reuqired"></td><td><input type="file" name="file[]" id="file"  class="form-control " data-validation="reuqired"></td><td><a   onclick="DeleteRowImg(' + len + ')"> <i class="fa fa-trash" ></i> </a></td></tr>');
    }

    function DeleteRowImg(valu) {
        $('.' + valu).remove();
        // var x = document.getElementById('resultTable');
        var len = $(".attachTable").length;
        if (len == 0) {
            $(".mytable").hide();
        }
    }

</script>

<script>

    function GetAttachTable() {
        $('#AttachTableDiv').html('');
        $(".AttachTable").clone().appendTo('#AttachTableDiv')
        $("#myModal_attach .close").click();
    }


</script>


<script>

    function GetTotalValueArabic(valu) {

        if (valu != 0 && valu != '') {
            var dataString = 'number=' + valu;
            $.ajax({
                type: 'post',
                url: '<?php echo base_url() ?>finance_accounting/box/quods/Quods/GetTotalValueArabic',
                data: dataString,
                cache: false,
                success: function (json_data) {
                    var JSONObject = JSON.parse(json_data);
                    $('#total_value_arabic').html('   مبلغ وقدره :' + JSONObject['title']);
                }
            });

        }

    }
</script>
<!----------------------------------------->

<script>


    function CheckRkm(value) {


        if (value != 0 && value != '') {
            // alert(value);
            // return;
            $.ajax({
                type: 'post',
                url: '<?php echo base_url() ?>finance_accounting/box/quods/Quods/CheckRkm',
                data: {rkm: value},
                cache: false,
                success: function (json_data) {
                    var JSONObject = JSON.parse(json_data);

                    //  console.log(JSONObject);
                    if (JSONObject > 0) {
                        $('.myBtn').prop('type', 'button');


                        swal({
                            title: "رقم القيد مسجل من قبل !",
                            text: "",
                            type: "danger",
                            showCancelButton: true,
                        });

                        //alert(' رقم القيد مسجل من قبل !!!');
                        setTimeout(function () {
                            $('#rkm').val(<?php echo $rkm;?>);
                            //$('.myBtn').prop('type', 'submit');
                        }, 500);


                    } else if (JSONObject == 0) {


                    }
                    /*document.getElementById("value").setAttribute("readonly","readonly");
                    $('#value').val(JSONObject);*/
                }
            });
            // return false;


        }


    }


    function delete_me(value) {
        swal({
            title: "هل تريد حذف القيد!",
            text: "",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            cancelButtonClass: "btn-danger",
            confirmButtonText: "نعم, قم بالحذف!",
            cancelButtonText: "لا, إلغاء الأمر!",
        }, function (isConfirm) {
            if (isConfirm) {
                window.location.href = "<?php echo base_url();?>finance_accounting/box/quods/Quods/deleteQuod/" + value;
            }

        });


    }

</script>

<script>


    function save_me() {
        var inputsNotEmprty = []
        $(".inputclass").each(function () {
            if ($(this).val() != '') {
                inputsNotEmprty.push($(this).val());
            }
        });
        if ($('.inputclass').length == inputsNotEmprty.length) {
            //$("#attach_button").attr('data-target','#myModal_attach');
        } else {
            // $("#attach_button").removeAttr('data-target','#myModal_attach');
            alert('تأكد من إدخال الحقول الناقصة!   ');
            return;
        }
        Swal.fire({
            title: "هل تريد حفظ القيد!",
            text: "",
            type: 'warning',

            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            cancelButtonText: "لا, إلغاء الأمر!",
            confirmButtonText: "نعم, قم بالحفظ!",
        }).then((result) => {
            if (result.value) {
                $('#form1').submit();

            }
        })
        /*  swal({
              title: "هل تريد حفظ القيد!",
              text: "",
              type: "warning",
              showCancelButton: true,
              confirmButtonClass: "btn-success",
              cancelButtonClass: "btn-danger",
              confirmButtonText: "نعم, قم بالحفظ!",
              cancelButtonText: "لا, إلغاء الأمر!",
          }, function (isConfirm) {
              if (isConfirm) {
                  var dataString = $('#form1').serialize();
                  //console.log(dataString);
                  $.ajax({
                      type:'post',
                      url: '<?php echo base_url() ?>finance_accounting/box/quods/Quods/add_quods_form',
                    data:dataString,
                    cache:false,
                    success: function(json_data){
                        console.log(json_data);
                        window.location.reload();

                    }
                });

            }

        });*/

    }

</script>
<!-------------------------------------------------------------------------->
<script>
    function tarhel(valu) {
        $.ajax({
            type: 'post',
            url: "<?php echo base_url();?>finance_accounting/box/quods/Quods/trahel_qued",
            data: {valu: valu},


            success: function (d) {

                alert(d);
                $('.tarhel' + valu).removeClass("btn-danger");
                $('.tarhel' + valu).addClass("btn-success");
                $('.tarhel' + valu).text('تم ترحيل القيد');
            }

        });
    }


</script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2"></script>

<script>
    function tarhel(valu, num) {
        if (num == 1) {
            var title = "هل انت متأكد من ترحيل القيد؟";
            var confirm = "نعم, قم بالترحيل";
            var text2 = "عند الضغط علي نعم سيتم ترحيل القيد";
        } else {
            var title = "هل انت متأكد من الغاء ترحيل القيد؟";
            var confirm = "نعم, قم بالغاء الترحيل";
            var text2 = "عند الضغط علي نعم سيتم الغاء ترحيل القيد";
        }

        Swal.fire({
            title: title,
            text: text2,
            type: 'warning',

            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            cancelButtonText: 'ليس الان',
            confirmButtonText: confirm
        }).then((result) => {
            if (result.value) {
                Swal.fire(
                    'نجاح!',
                    'تم العمليه .',
                )
                window.location.href = "<?php echo base_url();?>finance_accounting/box/quods/Quods/trahel_qued/" + valu + "/" + num;
            }
        })
    }

</script>


<!---------------------------------------------------------------------------------------------------->





