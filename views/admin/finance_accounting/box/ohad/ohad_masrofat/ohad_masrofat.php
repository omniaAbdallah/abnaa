<style type="text/css">
    .btn-group>.btn, .btn-group>.btn+.btn, .btn-group>.btn:first-child, .fc .fc-button-group>* {
        height: 34px!important;
        border-radius: 4px!important;
        margin: 0!important;
    }
    .bootstrap-select.btn-group .dropdown-toggle .caret {
        right: 92% !important;
    }
    .btn-label {
        left: 12px;
    }
    input,select {
        font-weight: 600 !important;
        color: #002c52 !important;
        font-size: 16px !important;
    }
    .top-label {
        font-size: 13px;
        background-color: #428bca !important;
        border: 2px solid #428bca !important;
        text-shadow: none !important;
        font-weight: 500 !important;
    }
    .myspan {
        color: rgb(255, 0, 0);
        font-size: 12px;
        position: absolute;
        bottom: -16px;
        right: 20px;
    }
    .no-padding {
        padding-left: 0px !important;
        padding-right: 0px !important;
    }

    .print_forma {
        padding: 15px;
    }
    .piece-box {
        margin-bottom: 12px;
        border: 1px solid #73b300;
        display: inline-block;
        width: 100%;
    }
    .piece-heading {
        background-color: #9bbb59;
        display: inline-block;
        float: right;
        width: 100%;
    }
    .piece-body {
        width: 100%;
        float: right;
    }
    .bordered-bottom {
        border-bottom: 4px solid #9bbb59;
    }
    .piece-footer {
        display: inline-block;
        float: right;
        width: 100%;
        border-top: 1px solid #73b300;
    }
    .piece-heading h5 {
        margin: 4px 0;
    }
    .piece-box table {
        margin-bottom: 0
    }
    .piece-box table th,
    .piece-box table td {
        padding: 2px 8px !important;
    }
    h6 {
        font-size: 16px;
        margin-bottom: 3px;
        margin-top: 3px;
    }
    .print_forma table th {
        text-align: right;
    }
    .print_forma table tr th {
        vertical-align: middle;
    }
    .no-padding {
        padding: 0;
    }
    .header p {
        margin: 0;
    }
    .header img {
        height: 120px;
        width: 100%
    }
    .main-title {
        display: table;
        text-align: center;
        position: relative;
        height: 120px;
        width: 100%;
    }
    .main-title h4 {
        display: table-cell;
        vertical-align: bottom;
        text-align: center;
        width: 100%;
    }
    .print_forma hr {
        border-top: 1px solid #73b300;
        margin-top: 7px;
        margin-bottom: 7px;
    }
    .no-border {
        border: 0 !important;
    }
    .gray_background {
        background-color: #eee;
    }
    @media print {
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    }
    .footer img {
        width: 100%;
        height: 120px;
    }
    @page {
        size: A4;
        margin: 20px 0 0;
    }
    .open_green {
        background-color: #e6eed5;
    }
    .closed_green {
        background-color: #cdddac !important;
    }
    .table-bordered>thead>tr>th,
    .table-bordered>tbody>tr>th,
    .table-bordered>tfoot>tr>th,
    .table-bordered>thead>tr>td,
    .table-bordered>tbody>tr>td,
    .table-bordered>tfoot>tr>td {
      /*  border: 1px solid #abc572;*/
    }
    .btn-close-model,
    .btn-close-model:hover,
    .btn-close-model:focus {
        background-color: #8a9e5f;
        color: #fff;
        margin-top: -20px;
    }
    .my_style{
        color: #222;
        font-size: 15px;
        font-weight: 500;
    }
    .one_three{
        width: 43% !important;
        float: right;
    }
    .two_three{
        width: 57% !important;
        float: right;
    }
    @media (min-width: 992px){
        .col_md_10{
            width: 10%;
            float:right;
        }
        .col_md_15{
            width: 15%;
            float:right;
        }
        .col_md_20{
            width: 20%;
            float:right;
        }
        .col_md_25{
            width: 25%;
            float:right;
        }
        .col_md_30{
            width: 30%;
            float:right;
        }
        .col_md_35{
            width: 35%;
            float:right;
        }
        .col_md_40{
            width: 40%;
            float:right;
        }
        .col_md_45{
            width: 45%;
            float:right;
        }
        .col_md_50{
            width: 50%;
            float:right;
        }
        .col_md_55{
          width: 55%;
            float:right;  
        }
        .col_md_60{
            width: 60%;
            float:right;
        }
        .col_md_65{
            width: 65%;
            float:right;
        }
        .col_md_70{
            width: 70%;
            float:right;
        }
        .col_md_75{
            width: 75%;
            float:right;
        }
        .col_md_80{
            width: 80%;
            float:right;
        }
        .col_md_85{
            width: 85%;
            float:right;
        }
        .col_md_90{
            width: 90%;
            float:right;
        }
        .col_md_95{
            width: 95%;
            float:right;
        }
        .col_md_100{
            width: 100%;
            float:right;
        }
    }
    .label_title_2 {
           width: 100%;
            color: #000;
            height: auto;
            margin: 0;
            font-family: 'hl';
            padding-right: 0px;
            font-size: 16px;
            margin-bottom: 5px;
            margin-top: 5px;
            display: inline-block;
    }
    .input_style_2 {
        border-radius: 0px;
        width: 100%;
    }
    /*.label-blue{
        background-color:#003665;
        border: 1px solid #003665;

        height: 34px;
        line-height: 25px !important;
        font-size: 13px !important;
        font-weight: 500 !important;
        text-align: right !important;
    }*/
    #cheq , #eda3 , #shabka , #mosatadem {
        padding-top: 5px !important;
        padding-bottom: 5px !important;
    }
    .table_style{
        font-size: 11px !important;
        color: darkred !important;
        font-weight: bold !important;
        line-height: 17px !important;
        margin: 1px;
    }
    button[type=submit] {
        padding: 0px 12px;
    }
    .btn-label {
        right: -14px;
    }
    .list::-webkit-calendar-picker-indicator {
      display: none;
    }
    input[type=date]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        display: none;
    }
    input[type=date]::-webkit-clear-button{
        display: none; 
        -webkit-appearance: none; 
    }
    .tree ul {
        margin-right: 10px;
        position: relative;
        margin-left: 0;
    }
    .tree ul li {
        padding-left: 0;
    }
    .tree ul ul {
        margin-left: 0;
    }
    ul span { display: inline!important; }
    .fa-plus.sspan {
        padding: 2px 7px;
        font-size: 13px;
        line-height: 1.5;
        background-color: #5b69bc;
        color: #fff;
        border-radius: 2px;
    }
    .bond-header{
        height: 55px;
        margin-bottom: 15px;
    }
    .bond-header .right-img img,
    .bond-header .left-img img{
        width: 100%;
        height: 55px;
    }
    .border-box {
        border: 2px solid #5c9842;
        background-color: #fff;
        border-radius: 5px;
        font-size: 15px;
        padding: 2px 6px;
        display: inline-block;
        min-width: 70px;
        height: 29px;
        line-height: 23px;
        text-align: center;
    }
    .border-box-h{
        padding: 3px 20px;
        border: 2px solid #222;
        border-radius: 29px;
    }
    .main-bond-title{
        display: table;
        height: 55px;
        text-align: center;
        width: 100%;
    }
    .main-bond-title h3{
        display: table-cell;
        vertical-align: middle;
        font-size: 12px;
    }
    .bond-body {
        position: relative;
        padding: 10px;
        border: 2px solid #5c9842;
        display: inline-block;
        width: 100%;
    }
    .bond-body h5 {
        font-size: 12px;
    }
    .bond-body h6 {
        font-size: 11px;
    }
    .pad-2{
        padding-left: 2px;
        padding-right: 2px;
    }
    .bond-footer{
        margin-top: 15px;
    }
    .bond-footer h6{
        font-size: 11px;
    }
    .title-fe {
        position: absolute;
        top: -17px;
        right: 35%;
        border: 2px solid #5c9842;
        background-color: #fff;
        border-radius: 5px;
        font-size: 14px;
        padding: 2px 8px;
    }
    .table>caption+thead>tr:first-child>th, .table>colgroup+thead>tr:first-child>th, .table>thead:first-child>tr:first-child>th, .table>caption+thead>tr:first-child>td, .table>colgroup+thead>tr:first-child>td, .table>thead:first-child>tr:first-child>td {
        border-top: 1px solid #000;
    }
    .bond-body .table-bordered>thead>tr>th,
    .bond-body .table-bordered>tbody>tr>th,
    .bond-body .table-bordered>tfoot>tr>th,
    .bond-body .table-bordered>thead>tr>td,
    .bond-body .table-bordered>tbody>tr>td,
    .bond-body .table-bordered>tfoot>tr>td
    {
        border: 1px solid #000;
        text-align: center;
        vertical-align: middle;
        font-size: 10px;
        padding: 5px;
    }
    
    
    .fa-money {
        padding: 1px 5px;
        font-size: 12px;
        line-height: 1.5;
        background-color: #ffb61e;
        color: #fff;
        border-radius: 2px;
    }
        td input[type=radio] {
            height: 18px;
            width: 18px;
        }
        .mblgh-tb tbody td,.mblgh-tb tfoot td{
            padding: 0 !important;
            text-align: center !important;
          }
      .mblgh-tb thead th{
        text-align: center !important;
        }
        .red-color {
        color: #ff0000;
    }
</style>

<div class="col-sm-12 no-padding">
   
        <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
            <div class="panel-heading">
                <h3 class="panel-title"><?=$title?></h3>
            </div>
            <div class="panel-body">
            <?php
            $submitEdit = 'button';
            $submitSave = 'button';
            if(isset($result) && !empty($result)) {
                $submitEdit          = '';
                $process_num         = $result->process_num;
                $process_date        = $result->process_date_ar;
                $geha_name           = $result->geha_name;
                $geha_id_fk          = $result->geha_id_fk;
                $fatora_num          = $result->fatora_num;
                $fatora_value        = $result->fatora_value;
                $total_value         = $result->fatora_value;
                $mother_national_num = $result->mother_national_num;
                $type                = $result->type;
                $mobile              = $result->person_mob;
                echo form_open_multipart('finance_accounting/box/ohad/ohad_masrofat/Ohad_masrofat/update/'.$result->id,array('id'=>'fromVouchSarf'));
            }
            else {
                $submitSave          = '';
                $process_num         = $last_id;
                $process_date        = date('Y-m-d');
                $fatora_num          = '';
                $fatora_value        = '';
                $geha_name           = '';
                $geha_id_fk          = '';
                $mother_national_num = '';
                $type                = '';
                $mobile              = '';
                $total_value         = '';
                $arabicValue         = '';
                echo form_open_multipart('finance_accounting/box/ohad/ohad_masrofat/Ohad_masrofat/add',array('id'=>'fromVouchSarf'));
            }
            ?>
                <div class="col-md-12 no-padding">
                    <div class="col-md-1 col-sm-3 padding-4">
                        
                            <h6 class="label_title_2 ">رقم العملية </h6>
                        
                            <input type="text" name="process_num" value="<?=$process_num?>" class="form-control input_style_2" readonly="" data-validation-has-keyup-event="true">
                        
                    </div>

                    <div class="col-md-2 col-sm-3 padding-4">
                        
                            <h6 class="label_title_2">تاريخ العملية  </h6>
                      
                            <input type="date" name="process_date"  data-validation="required" id="process_date" value="<?=$process_date?>" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])/(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])/(?:30))|(?:(?:0[13578]|1[02])-31))" class="form-control input_style_2" data-validation-has-keyup-event="true">
                      
                    </div>

                    <div class="col-md-2 col-sm-3 padding-4">
                       
                            <h6 class="label_title_2">رقم الفاتورة </h6>
                       
                            <input type="text" name="fatora_num" id="fatora_num" data-validation="required" class="form-control input_style_2 error" value="<?=$fatora_num?>" data-validation-has-keyup-event="true">
                       
                    </div>
                
                    <div class="col-md-5 col-sm-6 padding-4">
                        
                            <h6 class="label_title_2">إسم الجهة المستفيدة</h6>
                        
                            <input  list="pepople_arr" autocomplete="off" style="width:90%; float: right;" type="text" name="geha_name" id="person_name" class="form-control input_style_2 list" value="<?=$geha_name?>" data-validation-has-keyup-event="true" onkeyup="$('#person_name_div').html($(this).val());" data-validation="required" />
                            <input type="hidden" name="mother_national_num" id="mother_national_num" value="<?=$mother_national_num?>">
                            <input type="hidden" name="type" id="type" value="<?=$type?>">
                            <input type="hidden" name="geha_id_fk" id="person_id_fk" value="<?=$geha_id_fk?>">
                            <button type="button" data-toggle="modal" data-target="#myModalInfo" class="btn btn-success btn-next" style=""> <i class="fa fa-plus"></i> </button>
                            <datalist id="pepople_arr">
                            <?php 
                            if(!empty($people_arr)) { 
                                foreach($people_arr as $row){ 
                            ?>
                                <option value="<?=$row['title']?>">
                            <?php 
                                } 
                            } 
                            ?>
                            </datalist>
                      
                    </div>
                    

                    <div class="col-md-2 col-sm-6 padding-4">
                        
                            <h6 class="label_title_2 ">الجوال  </h6>
                       
                            <input style="font-weight: 600 !important;" type="text" onkeypress="validate_number(event)" name="person_mob" id="person_mob"  value="<?=$mobile?>" class="form-control input_style_2"/>
                        
                    </div>
               
                    <div class="col-md-2 col-sm-3 padding-4">
                      
                            <h6 class="label_title_2">المبلغ </h6>
                    
                            <input type="text" name="value" id="value" data-validation="required" class="form-control input_style_2 error" onkeypress="return validate_number(event)" value="<?=$fatora_value?>" data-validation-has-keyup-event="true">
                      
                    </div>
                </div>

                <div class="col-md-12 no-padding">
                    <table class="table table-striped table-bordered mblgh-tb" style="table-layout: fixed;margin-top:10px
                    " id="mytable">
                        <thead>
                            <tr class="info">
                                <th style="width: 80px;">المبلغ</th>
                                <th style="width: 80px;">رقم الحساب</th>
                                <th style="width: 18%;">إسم الحساب</th>
                                <th style="width: 260px;" >البيان</th>
                                <th style="width: 4%;">الإجراء</th>
                            </tr>
                        </thead>
                        <tbody id="resultTable">
                        <?php 
                        $counter = 1; 
                        if (isset($result) && $result != null) { 
                            foreach ($result->delails as $detail) {
                                $style = 'display: none;';
                                $plus = '';
                                if (count($result->delails) > 1) {
                                    $style = '';
                                }
                                if (count($result->delails) == $counter) {
                                    $plus = '<a href="#" onclick="addRow(); $(this).remove(); $(`#deleteRow'.$detail->id.'`).show();"><i class="fa fa-plus sspan"></i></a>';
                                }
                                $counter++; 
                        ?>
                        <tr id="<?=$detail->id?>">
                                <td>
                                    <input type="text" value="<?=$detail->value?>" onkeypress="return validate_number(event);" class="form-control accountValue" step="any" name="value[]" data-validation="required" aria-required="true" onkeyup="getSum(); $('#view-count-value1').html($(this).val());">
                                </td>
                                <td>
                                    <input type="text" class="form-control testButton" name="rqm_hesab[]" id="account_num<?=$detail->id?>" value="<?=$detail->rqm_hesab?>" data-validation="required" aria-required="true" readonly="" onclick="$('#modalID').val(<?=$detail->id?>); $(this).removeAttr('readonly');" ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');" style="cursor:pointer;" autocomplete="off" onkeypress="return isNumberKey(event);" onblur="$(this).attr('readonly','readonly')" onkeyup="getAccountName($(this).val(),<?=$detail->id?>);">
                                </td>
                                <td>
                                    <input type="text" class="form-control" name="name_hesab[]" value="<?=$detail->name_hesab?>" id="account<?=$detail->id?>" data-validation="required" aria-required="true" readonly="" >
                                </td>
                                <td>
                                    <input type="text" class="form-control" name="byan[]" value="<?=$detail->byan?>" data-validation="required" aria-required="true">
                                </td>
                                <td id="TD<?=$detail->id?>">
                                    <?=$plus?>
                                    <a class="pull-right" style="<?=$style?>" id="deleteRow<?=$detail->id?>" href="#" onclick="$('#<?=$detail->id?>').remove(); getSum();"><i class="fa fa-trash" aria-hidden="true"></i>
                                    </a>
                                </td>
                            </tr>
                        <?php
                            }
                        }
                        else {
                        ?>
                            <tr id="<?=$counter?>">
                                <td>
                                    <input type="text" onkeypress="return validate_number(event);" class="form-control accountValue" step="any" name="value[]" data-validation="required" aria-required="true" onkeyup="getSum(); $('#view-count-value1').html($(this).val());">
                                </td>
                                <td>
                                    <input type="text" class="form-control testButton" name="rqm_hesab[]" id="account_num<?=$counter?>" data-validation="required" aria-required="true" readonly="" onclick="$('#modalID').val(<?=$counter?>); $(this).removeAttr('readonly');" ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');" style="cursor:pointer;" autocomplete="off" onkeypress="return isNumberKey(event);" onblur="$(this).attr('readonly','readonly')" onkeyup="getAccountName($(this).val(),<?=$counter?>);">
                                </td>
                                <td>
                                    <input type="text" class="form-control" name="name_hesab[]" id="account<?=$counter?>" data-validation="required" aria-required="true" readonly="" >
                                </td>
                                <td>
                                    <input type="text" class="form-control" name="byan[]" data-validation="required" aria-required="true">
                                </td>
                                <td id="TD<?=$counter?>">
                                    <a href="#" onclick="addRow(); $(this).remove(); $('#deleteRow<?=$counter?>').show();"><i class="fa fa-plus sspan"></i></a>
                                    <a class="pull-right" style="display: none;" id="deleteRow<?=$counter?>" href="#" onclick="$('#<?=$counter?>').remove(); getSum();"><i class="fa fa-trash" aria-hidden="true"></i>
                                    </a>
                                </td>
                            </tr>
                        <?php } ?>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td>
                                    <input type="text" name="fatora_value" value="<?=$total_value?>" id="total_value" class="form-control total" data-validation="required" data-validation-has-keyup-event="true" readonly>
                                </td>
                                <td colspan="4">
                                    <input type="text" id="valueArabic" class="form-control" value="<?=$arabicValue?>" data-validation-has-keyup-event="true" readonly>
                                </td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            
                <div class="col-xs-12 text-center">
                    <input type="hidden" name="modalID" id="modalID">

                    <button onclick="return checkEquality();" type="<?=$submitSave?>" class="btn btn-labeled btn-success" name="save" value="save" id="myBtn">
                        <span class="btn-label"><i class="glyphicon glyphicon-floppy-disk" ></i></span>حفظ
                    </button>

                    <button type="<?=$submitEdit?>" onclick="return checkEquality();" class="btn btn-labeled btn-warning" style="color: #002342;" name="edit" value="edit">
                        <span class="btn-label"><i class="glyphicon glyphicon-pencil"></i></span>تعديل
                    </button>

                    <button type="button" class="btn btn-labeled btn-danger">
                        <span class="btn-label"><i class="glyphicon glyphicon-trash"></i></span>حذف
                    </button>

                    <button type="button" class="btn btn-labeled btn-inverse "  onclick="checkInputs()" data-toggle="modal" data-target="#myModal_attach">
                        <span class="btn-label"><i class="glyphicon glyphicon-cloud-upload"></i></span>مرفقات
                    </button>

                    <button type="button" class="btn btn-labeled btn-purple">
                        <span class="btn-label"><i class="glyphicon glyphicon-print"></i></span>طباعة
                    </button>

                    <button type="button" class="btn btn-labeled btn-inverse" data-toggle="modal" data-target="#searchModal">
                        <span class="btn-label"><i class="glyphicon glyphicon-search"></i></span>البحث
                    </button>
                </div>
            </div>
        </div>
    
</div>

<div class="modal fade" id="myModalInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">إستلمنا من </h4>
            </div>
            <div class="modal-body">
                <?php
                $k_type_arr =array('1'=>'الموظفين','2'=>'الأسر','3'=>'الجمعية العمومية','4'=>'المتطوعين','5'=>'الجهات والمؤسسات');
                if(isset($k_type_arr)&&!empty($k_type_arr)) {
                    foreach($k_type_arr as $key=>$value){
                        $checked = '';
                        if (isset($edit) && $edit['type']) {
                            $checked = 'checked';
                        }
                        ?>
                        <input  type="radio" name="fe2a" style="margin-right: 15px"
                                onclick="GetDiv('myDiv',<?=$key?>)" value="<?=$key?>" <?=$checked?>

                            <?php if(!empty($$key)){
                                if($$key ==1){?> checked <?php }} ?>>
                        <label for="square-radio-1"><?=$value?></label>
                        <?php
                    }
                }
                ?>
                <div id="myDiv"></div>
            </div>
            <div class="modal-footer"  style="display: inline-block;width: 100%" >
                <button type="button" class="btn btn-danger"
                        style="float: left;" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>

<div class="col-sm-12 col-md-12 col-xs-12  " style="padding: 0;">
    <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
        <div class="panel-heading">
            <h4 class="panel-title">
               البيان
            </h4>
        </div>
        <div class="panel-body">
            <div class="form-group col-sm-12 col-xs-12 no-padding">
                <table id="example" class="table table-bordered" role="table">
                    <thead>
                    <tr class="info">
                        <th width="2%">م</th>
                        <th class="text-left">رقم العملية</th>
                        <th class="text-left">رقم الإذن</th>
                        <th class="text-left">التاريخ</th>
                        <th class="text-left">إسم الجهة المستفيدة</th>
                        <th class="text-left"> رقم الفاتورة</th>
                        <th class="text-left"> مبلغ الفاتورة</th>
                        <th class="text-left">التفاصيل</th>
                        <th class="text-left">عرض المرفق</th>
                        <th class="text-left">الإجراء</th>
                    </tr>
                    </thead>
                    <tbody>
                    <?php
                    if (isset($records) && $records != null) {
                        $x = 1;
                        foreach ($records as $value) {
                            ?>
                            <tr>
                                <td><?=$x++?></td>
                                <td><?=$value->process_num?></td>
                                <td></td>
                                <td><?=date('Y-m-d',$value->process_date)?></td>
                                <td><?=$value->geha_name?></td>
                                <td><?=$value->fatora_num?></td>
                                <td><?=$value->fatora_value?></td>
                                <td>
                                    <button type="button" class="btn btn-sm btn-labeled btn-info" data-toggle="modal" data-target="#detailsModal<?=$value->id?>"><span class="btn-label"><i class="glyphicon glyphicon-list"></i></span>التفاصيل
                                    </button>
                                </td>
                                <td></td>
                                <td>
                                    <a href="<?=base_url()."finance_accounting/box/ohad/ohad_masrofat/Ohad_masrofat/updateView/".$value->id?>" title="تعديل"><i class="fa fa-pencil"></i></a>

                                    <a onclick="$('#adele').attr('href', '<?=base_url()."finance_accounting/box/ohad/ohad_masrofat/Ohad_masrofat/delete/".$value->id?>');" data-toggle="modal" data-target="#modal-delete" title="حذف"><i class="fa fa-trash"></i></a>
                                </td>
                            </tr>
                            <?php
                        }
                    }
                    ?>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 80%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">الدليل المحاسبي </h4>
            </div>
            <div class="modal-body">
                <table id="example" class="table table-bordered example" role="table">
                    <thead>
                        <tr class="info">
                                <th style="font-size: 15px; width:88px !important; ">م</th>
                                <th style="font-size: 15px;" class="text-left">رقم الحساب</th>
                                <th style="font-size: 15px;" class="text-left">إسم الحساب</th>
                        </tr>
                    </thead>
                    <tbody>
                    <?php
                    if (isset($tree) && $tree!=null) {
                        buildTreeTable($tree);
                    }
                    function buildTreeTable($tree, $count=1)
                    {
                        $types = array(1=>'رئيسي',2=>'فرعي');
                        $nature = array('','مدين','دائن');
                        $follow = array(1=>'ميزانية',2=>'قائمة الأنشطة');
                     //   $colorArray = array(1=>'#ec9732', 2=>'#c07852', 3=>'#75bf67', 4=>'#b6ab2d', 5=>'#145b5d', 6=>'#3088d8', 7=>'#4d92a7', 8=>'#ef6c02', 9=>'#a69fb9', 10=>'#67351b', 11=>'#b6ea47', 12=>'#e18091', 13=>'#f5f44d', 14=>'#a63daa', 15=>'#fb1f73', 16=>'#9b9a92', 17=>'#8f0e0b', 18=>'#397631', 19=>'#074183', 20=>'#cab11e');
           $colorArray = array(1=>'#ec9732', 2=>'#c07852', 3=>'#75bf67', 4=>'#b6ab2d', 5=>'#09b6bb', 6=>'#3088d8', 7=>'#4d92a7', 8=>'#ef6c02', 9=>'#a69fb9', 10=>'#67351b', 11=>'#b6ea47', 12=>'#e18091', 13=>'#f5f44d', 14=>'#a63daa', 15=>'#fb1f73', 16=>'#9b9a92', 17=>'#8f0e0b', 18=>'#397631', 19=>'#074183', 20=>'#cab11e');
           
                        foreach ($tree as $record) {
                            $onclick = "alert('ليس حساب فرعي');";
                            if ($record->hesab_no3 == 2) {
                                $onclick = "$('#account_num'+$('#modalID').val()).val(".$record->code."); $('#account'+$('#modalID').val()).val('".$record->name."');
                                    $('#view-count-num'+$('#modalID').val()).html('".$record->code."'); 
                                    $('#view-count-name'+$('#modalID').val()).html('".$record->name."'); 
                                    $('#myModal').modal('hide');";
                            }
                    ?>
                        <tr style="background-color: <?=$colorArray[$record->level]?>; cursor: pointer;" onclick="<?=$onclick?>">
                            <td class="forTd"><?=$count++?></td>
                            <td class="forTd"><?=$record->code?></td>
                            <td class="forTd"><?=$record->name?></td>
                        </tr>
                    <?php
                            if (isset($record->subs)) {
                                $count = buildTreeTable($record->subs, $count++);
                            }
                        }
                        return $count;
                    }
                    ?>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>

<?php
if (isset($records) && $records != null) {
    foreach ($records as $value) {
?>
<div class="modal fade" id="detailsModal<?=$value->id?>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">تفاصيل الفاتورة </h4>
            </div>
            <div class="modal-body ">
                <table class="table table-striped table-bordered"  style="table-layout: fixed">
                    <tbody>
                        <tr>
                            <td class="closed_green" style="width: 30%;">رقم العملية </td>
                            <td> <span class=""  ><?=$value->process_num?></span></td>
                            <td class="closed_green">التاريخ</td>
                            <td><span class=" " ><?=date('Y-m-d',$value->process_date)?></span></td>
                        </tr>
                        <tr>
                            <td class="closed_green">إسم الجهة المستفيدة</td>
                            <td colspan="3"><span class="" ><?=$value->geha_name?></span></td>
                        </tr>
                    </tbody>
                </table>

                <table class="table table-striped table-bordered" style="table-layout: fixed;
                    " id="mytable">
                    <thead>
                        <tr class="info">
                            <th style="width: 100px;">المبلغ</th>
                            <th style="width: 100px;">رقم الحساب</th>
                            <th style="width: 20%;">إسم الحساب</th>
                            <th style="width: 150px;" >البيان</th>
                        </tr>
                    </thead>
                    <tbody>
                    <?php foreach ($value->delails as $row_detail){ ?>
                        <tr>
                            <td>
                                <?=$row_detail->value?>
                            </td>
                            <td>
                              <?=$row_detail->rqm_hesab?>
                            </td>
                            <td>
                               <?=$row_detail->name_hesab?>
                            </td>
                            <td>
                                <?=$row_detail->byan?>
                            </td>
                        </tr>
                    <?php } ?>
                    <tr>
                        <td><?=$value->fatora_value?></td>
                        <td colspan="3">الإجمالي</td>
                    </tr>
                    </tbody>
               </table>
            </div>
            <div class="modal-footer">
                <button type="button"   class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>
<?php  
    } 
} 
?>

<script>
    function GetF2aTypeArr(valu) {
        $('#js_table_members').show();
        var F2aType = valu;
        var oTable_usergroup = $('#js_table_members').DataTable({
            dom: 'Bfrtip',
            "ajax": '<?php echo base_url(); ?>all_Finance_resource/all_pills/AllPills/getConnection/' + F2aType,
            aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ],
            buttons: [
                'pageLength',
                'copy',
                'excelHtml5',
                {
                    extend: "pdfHtml5",
                    orientation: 'landscape'
                },
                {
                    extend: 'print',
                    exportOptions: { columns: ':visible'},
                    orientation: 'landscape'
                },
                'colvis'
            ],
            colReorder: true,
            destroy: true
        });
    }

    function GetDiv(div,valu) {
        if(valu ==1){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 50px;">#</th><th style="width: 50px;"> كود الموظف </th><th style="width: 170px;" >إسم الموظف </th><th style="width: 170px;" >الإدارة</th>' +
            '<th style="width: 170px;" >القسم</th></tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]};

        } else if(valu ==2){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 50px;">#</th><th style="width: 50px;"> رقم الملف </th><th style="width: 170px;" >إسم رب الأسرة </th><th style="width: 170px;" >رقم هوية الاب</th> <th style="width: 170px;" >إسم مسئول الحساب البنكي</th> <th style="width: 170px;" >رقم هوية</th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]};
        }  else if(valu ==3){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 10px;">#</th><th style="width: 50px;" > الإسم </th><th style="width: 50px;">رقم الهوية</th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]};
        }  else if(valu ==4){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 10px;">#</th><th style="width: 50px;"> الإسم </th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true }
            ]};
        } else if(valu ==5){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 10px;">#</th><th style="width: 50px;"> الإسم </th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true }
            ]};
        }

        $("#" + div).html(html);
        $('#type').val(valu);
        $('#js_table_members').show();
        var F2aType = valu;
        var oTable_usergroup = $('#js_table_members').DataTable({
            dom: 'Bfrtip',
            "ajax": '<?php echo base_url(); ?>finance_accounting/box/ezn_sarf/Ezn_sarf/getConnection/' + F2aType,
            Columns
            ,
            buttons: [
                'pageLength',
                'copy',
                'excelHtml5',
                {
                    extend: "pdfHtml5",
                    orientation: 'landscape'
                },
                {
                    extend: 'print',
                    exportOptions: { columns: ':visible'},
                    orientation: 'landscape'
                },
                'colvis'
            ],
            colReorder: true,
            destroy: true
        });
    }

    function GetMemberName(valu) {
        var id = valu;
        var name = $("#member" + valu).data('name');
        var mob = $("#member" + valu).data('mob');
        var mother_num = $("#member" + valu).data('mother_num');
        var type = $("#member" + valu).data('type');
        $('#person_name').val(name);
        $('#person_name_div').html(name);
        $('#person_span').html(name);
        $('#person_mob').val(mob);
        $('#person_id_fk').val(id);
        if(mother_num  !=''){
            $('#mother_national_num').val(mother_num);
        }
        if(type  !=''){
            $('#type').val(type);
        }
        $("#myModalInfo .close").click();
    }
</script>

<script type="text/javascript">
    function checkEquality() {
        if (parseFloat($('#value').val()) != parseFloat($('#total_value').val())) {
            alert('يوجد خطأ بالمبلغ');
            return false;
        }
    }
</script>