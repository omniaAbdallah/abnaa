<style type="text/css">
    .btn-group>.btn, .btn-group>.btn+.btn, .btn-group>.btn:first-child, .fc .fc-button-group>* {
        height: 34px!important;
        border-radius: 4px!important;
        margin: 0!important;
    }
    .bootstrap-select.btn-group .dropdown-toggle .caret {
        right: 92% !important;
    }
    .btn-label {
        left: 12px;
    }
    input,select {
        font-weight: 600 !important;
        color: #002c52 !important;
        font-size: 16px !important;
    }
    .top-label {
        font-size: 13px;
        background-color: #428bca !important;
        border: 2px solid #428bca !important;
        text-shadow: none !important;
        font-weight: 500 !important;
    }
    .myspan {
        color: rgb(255, 0, 0);
        font-size: 12px;
        position: absolute;
        bottom: -16px;
        right: 20px;
    }
    .no-padding {
        padding-left: 0px !important;
        padding-right: 0px !important;
    }

    .print_forma {
        padding: 15px;
    }
    .piece-box {
        margin-bottom: 12px;
        border: 1px solid #73b300;
        display: inline-block;
        width: 100%;
    }
    .piece-heading {
        background-color: #9bbb59;
        display: inline-block;
        float: right;
        width: 100%;
    }
    .piece-body {
        width: 100%;
        float: right;
    }
    .bordered-bottom {
        border-bottom: 4px solid #9bbb59;
    }
    .piece-footer {
        display: inline-block;
        float: right;
        width: 100%;
        border-top: 1px solid #73b300;
    }
    .piece-heading h5 {
        margin: 4px 0;
    }
    .piece-box table {
        margin-bottom: 0
    }
    .piece-box table th,
    .piece-box table td {
        padding: 2px 8px !important;
    }
    h6 {
        font-size: 16px;
        margin-bottom: 3px;
        margin-top: 3px;
    }
    .print_forma table th {
        text-align: right;
    }
    .print_forma table tr th {
        vertical-align: middle;
    }
    .no-padding {
        padding: 0;
    }
    .header p {
        margin: 0;
    }
    .header img {
        height: 120px;
        width: 100%
    }
    .main-title {
        display: table;
        text-align: center;
        position: relative;
        height: 120px;
        width: 100%;
    }
    .main-title h4 {
        display: table-cell;
        vertical-align: bottom;
        text-align: center;
        width: 100%;
    }
    .print_forma hr {
        border-top: 1px solid #73b300;
        margin-top: 7px;
        margin-bottom: 7px;
    }
    .no-border {
        border: 0 !important;
    }
    .gray_background {
        background-color: #eee;
    }
    @media print {
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    }
    .footer img {
        width: 100%;
        height: 120px;
    }
    @page {
        size: A4;
        margin: 20px 0 0;
    }
    .open_green {
        background-color: #e6eed5;
    }
    .closed_green {
        background-color: #cdddac !important;
    }
    .table-bordered>thead>tr>th,
    .table-bordered>tbody>tr>th,
    .table-bordered>tfoot>tr>th,
    .table-bordered>thead>tr>td,
    .table-bordered>tbody>tr>td,
    .table-bordered>tfoot>tr>td {
        border: 1px solid #abc572;
       
    font-size: 14px;
  
        
        
    }
    .btn-close-model,
    btn-close-model:hover,
    btn-close-model:focus {
        background-color: #8a9e5f;
        color: #fff;
        margin-top: -20px;
    }
    .my_style{
        color: #222;
        font-size: 15px;
        font-weight: 500;
    }
    .one_three{
        width: 43% !important;
        float: right;
    }
    .two_three{
        width: 57% !important;
        float: right;
    }
    @media (min-width: 992px){
        .col_md_10{
            width: 10%;
            float:right;
        }
        .col_md_15{
            width: 15%;
            float:right;
        }
        .col_md_20{
            width: 20%;
            float:right;
        }
        .col_md_25{
            width: 25%;
            float:right;
        }
        .col_md_30{
            width: 30%;
            float:right;
        }
        .col_md_35{
            width: 35%;
            float:right;
        }
        .col_md_40{
            width: 40%;
            float:right;
        }
        .col_md_45{
            width: 45%;
            float:right;
        }
        .col_md_50{
            width: 50%;
            float:right;
        }
        .col_md_55{
            width: 55%;
            float:right;
        }
        .col_md_60{
            width: 60%;
            float:right;
        }
         .col_md_65{
            width: 65%;
            float:right;
        }
         
        .col_md_70{
            width: 70%;
            float:right;
        }
        .col_md_75{
            width: 75%;
            float:right;
        }
        .col_md_80{
            width: 80%;
            float:right;
        }
        .col_md_85{
            width: 85%;
            float:right;
        }
        .col_md_90{
            width: 90%;
            float:right;
        }
        .col_md_95{
            width: 95%;
            float:right;
        }
        .col_md_100{
            width: 100%;
            float:right;
        }
    }
    .label_title_2 {
        width: 100%;
        color: white;
        background-color: #428bca;
        border: 2px solid #428bca;
        height: 34px;
        margin: 0;
        line-height: 34px;
        padding-right: 6px;
        font-size: 14px;
        margin-bottom: 5px;
    }
    .input_style_2 {
        border-radius: 0px;
        border-right: transparent;
        width: 100%;
    }
    .label-blue{
        background-color:#003665;
        border: 1px solid #003665;

        height: 34px;
        line-height: 25px !important;
        font-size: 13px !important;
        font-weight: 500 !important;
        text-align: right !important;
    }
    /************************/
    .bond-qabd{
        /*  background: url(img/sanad.jpg);
          background-position: 100%;
          background-size: 100% 100%;
          background-repeat: no-repeat;
          -webkit-print-color-adjust: exact !important;

          page-break-after: always;*/
    }

    .bond-header{
        height: 55px;
        margin-bottom: 15px;
    }
    .bond-header .right-img img,
    .bond-header .left-img img{
        width: 100%;
        height: 55px;
    }
    .border-box {
        border: 2px solid #5c9842;
        background-color: #fff;
        border-radius: 5px;
        font-size: 15px;
        padding: 2px 6px;
        display: inline-block;
        min-width: 70px;
        height: 29px;
        line-height: 23px;
        text-align: center;
    }
    .border-box-h{
        padding: 3px 20px;
        border: 2px solid #222;
        border-radius: 29px;
    }
    .main-bond-title{
        display: table;
        height: 55px;
        text-align: center;
        width: 100%;
    }
    .main-bond-title h3{
        display: table-cell;
        vertical-align: middle;
        font-size: 12px;
    }
    .bond-body {
        position: relative;
        padding: 10px;
        border: 2px solid #5c9842;
        display: inline-block;
        width: 100%;


    }
    .bond-body  h5 {
        font-size: 12px;
    }
    .bond-body h6 {
        font-size: 11px;
    }
    .pad-2{
        padding-left: 2px;
        padding-right: 2px;
    }
    .bond-footer{
        margin-top: 15px;
    }
    .bond-footer h6{
        font-size: 11px;
    }
    .title-fe {
        position: absolute;
        top: -17px;
        right: 35%;
        border: 2px solid #5c9842;
        background-color: #fff;
        border-radius: 5px;
        font-size: 14px;
        padding: 2px 8px;
    }
    .table>caption+thead>tr:first-child>th, .table>colgroup+thead>tr:first-child>th, .table>thead:first-child>tr:first-child>th, .table>caption+thead>tr:first-child>td, .table>colgroup+thead>tr:first-child>td, .table>thead:first-child>tr:first-child>td {
        border-top: 1px solid #000;
    }
    .bond-body .table-bordered>thead>tr>th,
    .bond-body .table-bordered>tbody>tr>th,
    .bond-body .table-bordered>tfoot>tr>th,
    .bond-body .table-bordered>thead>tr>td,
    .bond-body .table-bordered>tbody>tr>td,
    .bond-body .table-bordered>tfoot>tr>td
    {
        border: 1px solid #000;
        text-align: center;
        vertical-align: middle;
        font-size: 10px;
        padding: 5px;

    }



    /**********************/
    #cheq , #eda3 , #shabka , #mosatadem {
        padding-top: 5px !important;
        padding-bottom: 5px !important;
    }
    .table_style{
        font-size: 11px !important;
        color: darkred !important;
        font-weight: bold !important;
        line-height: 17px !important;
        margin: 1px;
    }
    button[type=submit] {
        padding: 0px 12px;
    }
    .btn-label {
        right: -14px;
    }
    .list::-webkit-calendar-picker-indicator {
        display: none;
    }
    input[type=date]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        display: none;
    }
    input[type=date]::-webkit-clear-button{
        display: none;
        -webkit-appearance: none;
    }
    .tree ul {
        margin-right: 10px;
        position: relative;
        margin-left: 0;
    }
    .tree ul li {
        padding-left: 0;
    }
    .tree ul ul {
        margin-left: 0;
    }
    ul span { display: inline!important; }
    .fa-plus.sspan {
        background-color: #5b69bc;
        padding: 3px 6px;
        color: #fff;
        border-radius: 5px;
    }
</style>

<div class="col-sm-12 no-padding">
    <div class="col-sm-8">
        <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
            <div class="panel-heading">
                <h3 class="panel-title"><?=$title?></h3>
            </div>
            <div class="panel-body">
                <?php

                $submitEdit = 'button';
                $submitSave = 'button';
                if(isset($result) && !empty($result)) {
                    $submitEdit = '';
                    $rqm_sanad  = $result->rqm_sanad;
                    $date_sanad = $result->date_sanad;
                    $pay_method = $result->pay_method;
                    $recived_from = $result->recived_from;
                    $about = $result->about;
                    $sheek_num = $result->sheek_num;
                    $sheek_date = $result->sheek_date;
                    $bank_id_fk = $result->bank_id_fk;
                    $bank_name = $result->bank_name;
                    $total_value = $result->total_value;
                    $details = $result->delails;
                    
                       //osama
                     $type = $result->type;
                     $person_name = $result->person_name;
                     $mother_national_num = $result->mother_national_num;
                     $person_id_fk = $result->person_id_fk;
                     $mob = $result->person_mob;
                    $box_rqm_hesab = $result->box_rqm_hesab;
                    $box_name = $result->box_name;
                    //osama
                    
                    

//echo form_open_multipart('finance_accounting/box/vouch_qbd/Vouch_qbd/update/'.$result->id);

$arabicValue         = 'مبلغا وقدره : '.$arabicNum.' ريال فقط لا غير.';
//echo form_open_multipart('finance_accounting/box/vouch_sarf/Vouch_sarf/update/'.$result->id.'/'.$result->rqm_quod.'/'.$result->rqm_sanad,array('id'=>'fromVouchSarf'));
  echo form_open_multipart('finance_accounting/box/vouch_qbd/Vouch_qbd/update/'.$result->id.'/'.$result->rqm_sanad.'/'.$result->qued_rkm_id_fk);
                  
                }
                else {
                    $submitSave = '';
                    $rqm_sanad  = $last_id;
                    $date_sanad = date('Y-m-d');
                    $pay_method = '';
                    $recived_from = '';
                    $about = '';
                    $sheek_num = '';
                    $sheek_date = '';
                    $bank_id_fk = '';
                    $bank_name = '';
                    $details = '';
                    $total_value = '';
                    
                      //osama
                     $person_name ="";
                     $type ="";
                     $mother_national_num ="";
                     $person_id_fk ="";
                     $mob ="";

                    $box_rqm_hesab = '';
                    $box_name = '';
                  $arabicValue   = '';
                    //osama
                    
                    
                     if(isset($box_date) && !empty($box_date)){
                         $box_rqm_hesab = $box_date['rqm_hesab'];
                         $box_name = $box_date['name_hesab'];
                     }
                    
                  
                    
                    echo form_open_multipart('finance_accounting/box/vouch_qbd/Vouch_qbd/add');
                }
                ?>
                
<div class="col-md-12 no-padding">
<div class="col_md_50 col-sm-6 padding-4">
    <div class="col-md-3 col-sm-6 no-padding">
        <h6 class="label_title_2 ">نوع السند </h6>
    </div>
    <div class="col-md-9 col-sm-6 no-padding">
    
<div class="col-md-6 col-sm-6 no-padding">
<input type="radio"  name="pay_method" style="margin-right: 8px; width: 20px; height: 20px;"  onclick="$('#pay_method_span').html('سند قبض نقدى')"
<?php if(!empty($pay_method) && $pay_method == 1){echo 'checked';} ?>
data-validation="required" value="1" checked=""> <label class="no-margin no-padding"> نقدي</label>
</div>
<div class="col-md-6 col-sm-6 no-padding">
<input type="radio"  name="pay_method" style="width: 18px; height: 18px;" onclick="$('#pay_method_span').html('سند قبض شيك')"
<?php if(!empty($pay_method) && $pay_method == 2){echo 'checked';} ?>
data-validation="required" value="2"> <label class="no-margin no-padding">شيك</label>
</div>

    </div>
</div>


</div>
                
                
                
                
                
                
                <div class="col-md-12 no-padding">
                    <div class="col_md_30 col-sm-6 padding-4">
                        <div class="col-md-5 col-sm-6 no-padding">
                            <h6 class="label_title_2 ">رقم السند </h6>
                        </div>
                        <div class="col-md-7 col-sm-6 no-padding">
                            <input type="text"  name="rqm_sanad" value="<?=$rqm_sanad?>" class="form-control input_style_2" readonly="" data-validation-has-keyup-event="true">
                        </div>
                    </div>

                    <div class="col_md_35 col-sm-6 padding-4">
                        <div class="col-md-5 col-sm-6 no-padding">
                            <h6 class="label_title_2">تاريخ السند  </h6>
                        </div>
                        <div class="col-md-7 col-sm-6 no-padding">
                            <input type="date"  name="date_sanad"  onchange="$('#day_date_span').html($(this).val()+ 'م');"
                                   data-validation="required" id="date_sanad" value="<?=$date_sanad?>"
                                   pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])/(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])/(?:30))|(?:(?:0[13578]|1[02])-31))" class="form-control input_style_2" data-validation-has-keyup-event="true">
                        </div>
                    </div>
<!--
                    <div class="col_md_20 col-sm-6 padding-4 text-center">
                        <div class="col-md-6 col-sm-6 no-padding">
                            <input type="radio"  name="pay_method" style="width: 18px; height: 18px;"  onclick="$('#pay_method_span').html('سند قبض نقدى')"
                                <?php if(!empty($pay_method) && $pay_method == 1){echo 'checked';} ?>
                                   data-validation="required" value="1" checked=""> <label class="no-margin no-padding"> نقدي</label>
                        </div>
                        <div class="col-md-6 col-sm-6 no-padding">
                            <input type="radio"  name="pay_method" style="width: 18px; height: 18px;" onclick="$('#pay_method_span').html('سند قبض شيك')"
                                <?php if(!empty($pay_method) && $pay_method == 2){echo 'checked';} ?>
                                   data-validation="required" value="2"> <label class="no-margin no-padding">شيك</label>
                        </div>
                    </div> -->

                    <div class="col_md_35 col-sm-6 padding-4">
                        <div class="col-md-5 col-sm-6  no-padding ">
                            <h6 class="label_title_2">رقم القيد </h6>
                        </div>
                        <div class="col-md-7 col-sm-6 no-padding">
                            <input type="text" name="value" id="value"  data-validation="required" class="form-control input_style_2 error" value="" data-validation-has-keyup-event="true" disabled="">
                        </div>
                    </div>
                    
                    

                    
                    
                    
                </div>

  <div class="col-md-12 no-padding">
  
        <div class="col_md_65 col-sm-6 padding-4">  
                        <div class="col_md_55 col-sm-12 no-padding">
                            <div class="col-md-4 col-sm-6 no-padding">
                                <h6 class="label_title_2" style="padding-right: 0px;">ح. الصندوق</h6>
                            </div>
                            <div class="col-md-8 col-sm-6 no-padding">
                                <input type="text"   placeholder="كود الحساب" id="box_rqm_hesab_id" readonly=""
                                  value="<?=$box_rqm_hesab?>" name="box_rqm_hesab" class="form-control input_style_2"
                                       data-validation="required" data-validation-has-keyup-event="true">
                            </div>
                        </div>


                        <div class="col_md_45 col-sm-6 padding-4">

                            <div class="col-md-12 col-sm-6 no-padding">
                                <input type="text" placeholder="إسم الحساب" id="box_name_id" name="box_name"  value="<?=$box_name?>"  readonly="" class="form-control input_style_2"
                                       data-validation="required" data-validation-has-keyup-event="true">
                            </div>
                        </div>
                    
                     </div>               
                    
  
  
 <div class="col_md_35 col-sm-6 padding-4">  
    <div class="col-md-5 col-sm-6  no-padding ">
            <h6 class="label_title_2"> الرصيد </h6>
        </div>
        <div class="col-md-7 col-sm-6 no-padding">
            <input type="text" name="rased" style="color: red !important;" id="rased"  data-validation="required"
             class="form-control input_style_2 error" 
                  value="<?php echo ( $all_qabd_naqdi  - $all_sarf_naqdi);  ?>" data-validation-has-keyup-event="true" disabled="">
        </div>

 
 </div> 
  
  
  
  </div>


           <div class="col-md-12 no-padding">
                    <div class="col_md_70 col-sm-6 padding-4">
                        <div class="col-md-2 col-sm-6 no-padding">
                            <h6 class="label_title_2">إستلمنا من  </h6>
                        </div>
                        <div class="col-md-10 col-sm-6 no-padding">
                            <input  list="pepople_arr" autocomplete="off" style="width:90%; float: right;" type="text" name="person_name" id="person_name" class="form-control input_style_2 list"
                                    value="<?=$person_name?>"     data-validation-has-keyup-event="true" onkeyup="$('#person_span').html($(this).val())"  />
                            <input type="hidden" name="mother_national_num" id="mother_national_num" value="<?=$mother_national_num?>">
                            <input type="hidden" name="type" id="type" value="<?=$type?>">
                            <input type="hidden" name="person_id_fk" id="person_id_fk"
                                   value="<?=$person_id_fk?>">
                            <button type="button"   data-toggle="modal" data-target="#myModalInfo"
                                    class="btn btn-success btn-next" style="">
                                <i class="fa fa-plus"></i>  </button>
                            <datalist id="pepople_arr">
                                <?php if(!empty($people_arr)){ foreach($people_arr as $row){ ?>
                                <option value="<?=$row['title']?>">
                                    <?php } } ?>
                            </datalist>
                        </div>
                    </div>

                    <div class="col_md_30 col-sm-6 padding-4">


                        <div class="col-md-4 col-sm-6  no-padding ">
                            <h6 class="label_title_2 ">الجوال  </h6>
                        </div>
                        <div class="col-md-8 col-sm-6  no-padding">

                            <input style="font-weight: 600 !important;" type="text" onkeypress="validate_number(event)"   name="person_mob"
                                   id="person_mob"  value="<?php echo $mob ; ?>"
                                   class="form-control input_style_2 "
                            />


                        </div>

                    </div>
                </div>











                <div class="col-md-12 no-padding">
                    <div class="col_md_70 col-sm-6 padding-4">
                        <div class="col-md-2 col-sm-6 no-padding">
                            <h6 class="label_title_2">عبارة عن</h6>
                        </div>
                        <div class="col-md-10 col-sm-6 no-padding">
                            <input type="text"  name="about" class="form-control input_style_2" data-validation="required" data-validation-has-keyup-event="true" value="<?=$about?>">
                        </div>
                    </div>
                    
                <!--   <div class="col_md_50 col-sm-6 padding-4">  
                        <div class="col_md_50 col-sm-12 padding-4">
                            <div class="col-md-6 col-sm-6 no-padding">
                                <h6 class="label_title_2">حساب الصندوق</h6>
                            </div>
                            <div class="col-md-6 col-sm-6 no-padding">
                                <input type="text"   placeholder="كود الحساب" id="box_rqm_hesab_id" readonly=""
                                  value="<?=$box_rqm_hesab?>" name="box_rqm_hesab" class="form-control input_style_2"
                                       data-validation="required" data-validation-has-keyup-event="true">
                            </div>
                        </div>


                        <div class="col_md_50 col-sm-6 padding-4">

                            <div class="col-md-12 col-sm-6 no-padding">
                                <input type="text" placeholder="إسم الحساب" id="box_name_id" name="box_name"  value="<?=$box_name?>"  readonly="" class="form-control input_style_2"
                                       data-validation="required" data-validation-has-keyup-event="true">
                            </div>
                        </div>
                    
                     </div> -->
                </div>



<!--
                <div class="col-md-12 no-padding">
                    <div class="divbox">
                        <div class="col_md_25 col-sm-6 padding-4">
                            <div class="col-md-6 col-sm-6 no-padding">
                                <h6 class="label_title_2">حساب الصندوق</h6>
                            </div>
                            <div class="col-md-6 col-sm-6 no-padding">
                                <input type="text"   placeholder="كود الحساب" id="box_rqm_hesab_id" readonly=""
                                  value="<?=$box_rqm_hesab?>" name="box_rqm_hesab" class="form-control input_style_2"
                                       data-validation="required" data-validation-has-keyup-event="true">
                            </div>
                        </div>


                        <div class="col_md_25 col-sm-6 padding-4">

                            <div class="col-md-12 col-sm-6 no-padding">
                                <input type="text" placeholder="إسم الحساب" id="box_name_id" name="box_name"  value="<?=$box_name?>"  readonly="" class="form-control input_style_2"
                                       data-validation="required" data-validation-has-keyup-event="true">
                            </div>
                        </div>
                    </div>
                    
                    
                    
                </div>-->


                <div class="col-md-12 no-padding">
                    <table class="table table-striped table-bordered" style="table-layout: fixed;
                    " id="mytable">
                        <thead>
                        <tr class="info">
                            <th style="width: 100px;">المبلغ</th>
                            <th style="width: 100px;">رقم الحساب</th>
                            <th style="width: 20%;">إسم الحساب</th>
                            <th style="width: 150px;" >البيان</th>
                            <th style="width: 7%;">الإجراء</th>
                        </tr>
                        </thead>

                        <tbody id="resultTable">
                        <?php $counter =1; if(!empty($details)){
                            foreach ($details as $row_detail){
                                ?>
                                <tr id="<?=$row_detail->id?>">
                                    <td>
                                        <input type="text" value="<?=$row_detail->value?>" onkeypress="return validate_number(event);" class="form-control accountValue" step="any" name="value[]" data-validation="required" aria-required="true" onkeyup="getVouchQbdSum();">
                                    </td>
                                    <td>
                                        <input type="text" value="<?=$row_detail->rqm_hesab?>" class="form-control testButton" name="rqm_hesab[]" id="account_num<?=$row_detail->id?>" data-validation="required" aria-required="true" readonly="" onclick="$('#modalID').val(<?=$row_detail->id?>); $(this).removeAttr('readonly');" ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');" style="cursor:pointer;" autocomplete="off" onkeypress="return isNumberKey(event);" onblur="$(this).attr('readonly','readonly')" onkeyup="getVouchQbdAccountName($(this).val(),<?=$row_detail->id?>);">
                                    </td>
                                    <td>
                                        <input type="text" value="<?=$row_detail->name_hesab?>" class="form-control" name="name_hesab[]" id="account<?=$row_detail->id?>" data-validation="required" aria-required="true" readonly="" >
                                    </td>
                                    <td>
                                        <input type="text" value="<?=$row_detail->byan?>" class="form-control"
                                               name="byan[]" aria-required="true">
                                    </td>
                                    <td id="TD<?=$row_detail->id?>">
                                        <a href="#" <?php if($counter < sizeof($details)){?> style="display: none;" <?php } ?> onclick="addVouchQbdRow(); $(this).remove(); $('#deleteRow<?=$row_detail->id?>').show();"><i class="fa fa-plus sspan"></i></a>
                                        <a class="pull-right"  id="deleteRow<?=$row_detail->id?>" href="#" onclick="$('#<?=$row_detail->id?>').remove(); getVouchQbdSum();"><i class="fa fa-trash" aria-hidden="true"></i>
                                        </a>
                                    </td>
                                </tr>
                                <?php $counter++;  } } if($counter <= 1){ ?>

                            <tr id="<?=$counter?>">
                                <td>
                                    <input type="text" onkeypress="return validate_number(event);" class="form-control accountValue" step="any" name="value[]" data-validation="required" aria-required="true" onkeyup="getVouchQbdSum();$('#value_span1').html($(this).val());">
                                </td>
                                <td>
                                    <input type="text" class="form-control testButton" name="rqm_hesab[]" id="account_num<?=$counter?>" data-validation="required" aria-required="true" readonly="" onclick="$('#modalID').val(<?=$counter?>); $(this).removeAttr('readonly');" ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');" style="cursor:pointer;" autocomplete="off" onkeypress="return isNumberKey(event);" onblur="$(this).attr('readonly','readonly')"
                                           onkeyup="getVouchQbdAccountName($(this).val(),<?=$counter?>);  ">
                                </td>
                                <td>
                                    <input type="text" class="form-control" name="name_hesab[]" id="account<?=$counter?>" data-validation="required" aria-required="true" readonly="" >
                                </td>
                                <td>
                                    <input type="text" class="form-control" name="byan[]"  aria-required="true">
                                </td>
                                <td id="TD<?=$counter?>">
                                    <a href="#" onclick="addVouchQbdRow(); $(this).remove(); $('#deleteRow<?=$counter?>').show();"><i class="fa fa-plus sspan"></i></a>
                                    <a class="pull-right" style="display: none;" id="deleteRow<?=$counter?>" href="#" onclick="$('#<?=$counter?>').remove(); getVouchQbdSum();"><i class="fa fa-trash" aria-hidden="true"></i>
                                    </a>
                                </td>
                            </tr>
                        <?php } ?>
                        </tbody>
                        <tfoot>
                        <tr>
                            <td>
                                <input type="text"  name="total_value" value="<?=$total_value?>" class="form-control total" data-validation="required" data-validation-has-keyup-event="true" readonly>
                            </td>
                            <td colspan="4">
                                <input type="text" id="valueArabic" class="form-control"  value="<?=$arabicValue?>"  data-validation-has-keyup-event="true" readonly>
                            </td>
                        </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="col-md-12 no-padding divBank" <?php if($pay_method !=2){ ?> style="display: none;"<?php } ?>>
                    <div class="col_md_30 col-sm-6 padding-4">
                        <div class="col-md-6 col-sm-6 no-padding">
                            <h6 class="label_title_2">رقم الشيك </h6>
                        </div>
                        <div class="col-md-6 col-sm-6 no-padding">
                            <input type="text" name="sheek_num" value="<?=$sheek_num?>" class="form-control input_style_2 bank" data-validation="" data-validation-has-keyup-event="true">
                        </div>
                    </div>

                    <div class="col_md_35 col-sm-6 padding-4">
                        <div class="col-md-6 col-sm-6 no-padding">
                            <h6 class="label_title_2">تاريخ الشيك  </h6>
                        </div>
                        <div class="col-md-6 col-sm-6 no-padding">
                            <input type="date"  name="sheek_date" data-validation="" id="day_date" value="<?=$sheek_date?>"  pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])/(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])/(?:30))|(?:(?:0[13578]|1[02])-31))" class="form-control input_style_2 bank" data-validation-has-keyup-event="true">
                        </div>
                    </div>

                    <div class="col_md_35 col-sm-6 padding-4">
                        <div class="col-md-6 col-sm-6 no-padding">
                            <h6 class="label_title_2">البنك </h6>
                        </div>

                        <div class="col-md-6 col-sm-6 no-padding">
                            <select id="pill_type"  name="bank_id_fk" class="form-control input_style_2 bank"
                                    onchange="$('#bank_name_hidden').val($('option:selected',this).text());" data-validation="" aria-required="true">
                                <option value="">إختر</option>
                                <?php if(isset($banks) && !empty($banks)){
                                    foreach ($banks as $bank){
                                        $select = '';
                                        if($bank_id_fk == $bank->id){
                                            $select = 'selected';
                                        }
                                        ?>
                                        <option <?=$select?> value="<?=$bank->id?>"><?=$bank->title?></option>
                                <?php }} ?>
                            </select>
                            <input type="hidden"  id="bank_name_hidden" name="bank_name" value="<?=$bank_name?>" class="form-control input_style_2 bank" >
                        </div>
                    </div>
                </div>
             <!------ modal ---------------------------------->   
                
                
                                <div class="modal fade" id="myModalInfo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
                    <div class="modal-dialog" role="document" style="width: 70%">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title" id="myModalLabel">إستلمنا من </h4>
                            </div>
                            <div class="modal-body">
                                <?php
                                $k_type_arr =array('1'=>'الموظفين','2'=>'الأسر','3'=>'الجمعية العمومية','4'=>'المتطوعين','5'=>'الجهات والمؤسسات');
                                if(isset($k_type_arr)&&!empty($k_type_arr)) {
                                    foreach($k_type_arr as $key=>$value){
                                        $checked = '';
                                        if (isset($edit) && $edit['type']) {
                                            $checked = 'checked';
                                        }
                                        ?>
                                        <input  type="radio" name="fe2a" style="margin-right: 15px"
                                                onclick="GetDiv('myDiv',<?=$key?>)" value="<?=$key?>" <?=$checked?>

                                            <?php if(!empty($$key)){
                                                if($$key ==1){?> checked <?php }} ?>>
                                        <label for="square-radio-1"><?=$value?></label>
                                        <?php
                                    }
                                }
                                ?>
                                <div id="myDiv"></div>
                            </div>
                            <div class="modal-footer"  style="display: inline-block;width: 100%" >
                                <button type="button" class="btn btn-danger"
                                        style="float: left;" data-dismiss="modal">إغلاق</button>
                            </div>
                        </div>
                    </div>
                </div>
			

         <input type="hidden" id="all_N" value="<?php echo($all_qabd_naqdi - $all_sarf_naqdi);  ?>" />
         <input type="hidden" id="all_S" value="<?php echo($all_qabd_sheek - $all_sarf_sheek);  ?>" />
 
         
              <!--- end modal -------------------------------->  
                
                
                
                
                
                
                
                
                
                

                <div class="col-xs-12 text-center">
                    <input type="hidden" name="modalID" id="modalID">

                    <button type="<?=$submitSave?>" class="btn btn-labeled btn-success" name="save" value="save" id="myBtn">
                        <span class="btn-label"><i class="glyphicon glyphicon-floppy-disk"></i></span>حفظ
                    </button>

                    <button type="<?=$submitEdit?>" class="btn btn-labeled btn-warning" style="color: #002342;" name="edit" value="edit">
                        <span class="btn-label"><i class="glyphicon glyphicon-pencil"></i></span>تعديل
                    </button>

                    <button type="button" class="btn btn-labeled btn-danger">
                        <span class="btn-label"><i class="glyphicon glyphicon-trash"></i></span>حذف
                    </button>

        <button type="button" class="btn btn-labeled btn-inverse "   data-toggle="modal" data-target="#myModal_attach">
                        <span class="btn-label"><i class="glyphicon glyphicon-cloud-upload"></i></span>مرفقات
                    </button>
                    <button type="button" class="btn btn-labeled btn-purple">
                        <span class="btn-label"><i class="glyphicon glyphicon-print"></i></span>طباعة
                    </button>

                    <button type="button" class="btn btn-labeled btn-inverse" data-toggle="modal" data-target="#searchModal">
                        <span class="btn-label"><i class="glyphicon glyphicon-search"></i></span>البحث
                    </button>
           
                    
                    
                </div>
                
                  <?php echo form_close();?>
            </div>
          
            
        </div>
    </div>

	

    <div class="col-sm-4 no-padding">
        <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
            <div class="panel-heading">
                <h3 class="panel-title">تفاصيل السند</h3>
            </div>
            <div class="panel-body">
                <div class="col-md-12 no-padding">
                    <div class="bond-qabd">
                        <div class="bond-header">
                            <div class="col-xs-4 pad-2">
                                <div class="right-img">
                                    <img src="<?php echo base_url() ?>asisst/admin_asset/img/pills/sympol1.png">
                                </div>
                            </div>
                            <div class="col-xs-4 pad-2">

                            </div>
                            <div class="col-xs-4 pad-2">
                                <div class="left-img">
                                    <img src="<?php echo base_url() ?>asisst/admin_asset/img/pills/sympol2.png">
                                </div>
                            </div>
                        </div>

                        <div class="bond-body">
                            
                            <?php $pay_method_title ='سند قبض نقدى';
                            if(!empty($pay_method)){ if($pay_method ==1){
                                $pay_method_title ='سند قبض نقدى';
                            }elseif($pay_method ==2){
                                $pay_method_title ='سند قبض شيك';

                            } } ?>

                            <span class="title-fe" id="pay_method_span"><?=$pay_method_title?></span>

                            <div class="col-xs-12 no-padding">

                                <div class="col-xs-6 no-padding">
                                    <h5 style="margin-right: 5px;float:right"> التاريخ : &nbsp&nbsp <span id="day_date_span" style="float:left"><?=$date_sanad.'م'?></span></h5>
                                </div>
                                <div class="col-xs-6 text-center">
                                    <h5>رقم السند : &nbsp&nbsp<span class="border-box" id="sanad_num_span"><?=$rqm_sanad?></span></h5>
                                </div>

                            </div>

                            <div class="col-xs-12 no-padding">
                                <div class="col-xs-6 no-padding">
                                    <div class="col-xs-6 pad-2">
                                        <h5  style="margin-right: 5px;">هــ  </h5>
                                        <span class="border-box"> </span>
                                    </div>
                                    <div class="col-xs-6 pad-2">
                                        <h5 >ريــــــــــــــــال  </h5>
                                        <span class="border-box" id="value_span"><?=$total_value?></span>
                                    </div>
                                </div>
                                <div class="col-xs-6 text-center">
                                    <h5>رقم القيد : &nbsp&nbsp<span class="border-box" id="qued_num_span"></span></h5>
                                </div>


                            </div>




                            <div class="col-xs-12 no-padding">
                                <h5  style="margin-right: 5px;"> استلمنا من :<span style="border-bottom: 1px solid #000" id="person_span"></span><?=$person_name?></h5>
                            </div>


                            <div class="col-xs-12 no-padding">
                                <h5  style="margin-right: 5px;">مبلغاّ وقدره :<span style="border-bottom: 1px solid #000" id="valueArabic_span">
                            <?php  if(!empty($total_value)){ $arabicTitle = explode(".", $total_value);?>
                                <?php if(isset($arabicTitle[0]) && !empty($arabicTitle[0])){
                                    echo convertNumber($arabicTitle[0]).' ريال  '; } ?>
                                <?php if(isset($arabicTitle[1]) && !empty($arabicTitle[1])){
                                    echo convertNumber($arabicTitle[1]).' هلله لاغير .'; }  }?>
                                    </span>

                                </h5>
                            </div>
                            <div class="col-xs-12 no-padding">
                                <h5  style="margin-right: 5px;"><span style="border-bottom: 1px solid #000">عبارة عن :</span> إيرادات وتبرعات  </h5>
                            </div>


                            <div class="col-xs-12 no-padding">
                                <table class="table table-bordered" style=" margin-bottom: 0px; table-layout: fixed;">
                                    <thead>
                                    <tr>
                                        <th style="width: 60px;">مسلسل </th>
                                        <th>رقم الحساب</th>
                                        <th>إسم الحساب</th>
                                        <th style="width: 70px;">المبلغ</th>
                                    </tr>
                                    </thead>
                                    <tbody id="TableBodySpan">
                                    <?php $count =1; if(!empty($details)){
                                        foreach ($details as $row){ ?>
                                            <tr>
                                                <td><?=$count?></td>
                                                <td><?=$row->rqm_hesab?></td>
                                                <td><?=$row->name_hesab?></td>
                                                <td><?=$row->value?></td>
                                            </tr>
                                            <?php $count++;  } }else{  ?>
                                    <tr id="Tr">
                                        <td>1</td>
                                        <td id="rkm_hesab_span1"></td>
                                        <td id="name_hesab_span1"></td>
                                        <td id="value_span1"></td>
                                    </tr>
                                    <?php } ?>
                                    </tbody>
                                </table>
                            </div>





                            <div class="clearfix"></div>
                            <br>


                        </div>

                        <div class="bond-footer ">
                            <div class="col-xs-12 no-padding text-center">

                                <div class="col-md-4 col-xs-4 pad-2 text-center">
                                    <p>أمين الصندوق</p>
                                    <p>سامى نايف الحربى</p>
                                </div>
                                <div class="col-md-4 col-xs-4 pad-2 text-center">
                                    <p>المحاسب</p>
                                    <p>ماجد محمد الركيان</p>
                                </div>
                                <div class="col-md-4 col-xs-4 pad-2 text-center">
                                    <p>مدير المالية </p>
                                    <p>تركى على المنصور</p>
                                </div>

                            </div>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


<div class="col-sm-12 col-md-12 col-xs-12  " style="padding: 0;">
    <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
        <div class="panel-heading">
            <div class="panel-title">
                <h4>السندات</h4>
            </div>
        </div>
        <div class="panel-body">
            <div class="form-group col-sm-12 col-xs-12">
                <table id="example" class="table table-bordered" role="table" style="table-layout: fixed;">
                    <thead>
                    <tr class="info">
                        <th style="width: 40px;">م</th>
                        <th style="width: 80px;" class="text-left">رقم السند</th>
                        <th style="width: 100px;" class="text-left">تاريخ السند</th>
                        <th style="width: 100px;" class="text-left">طريقة الدفع</th>
                         <th  style="width: 20%;"class="text-left">إستلمنا من</th>
                        
                        <th class="text-left">اجمالي السند</th>
                        <th class="text-left">تفاصيل</th>
                      
                        <th class="text-left">الإجراء</th>
                    </tr>
                    </thead>
                    <tbody>
                    <?php
                    $method = array(
                        1=>'نقدي',
                        2=>'شيك'
                    );
                    if (isset($records) && $records != null) {
                        $x = 1;
                        foreach ($records as $value) {
                            ?>
                            <tr>
                                <td><?=$x++?></td>
                                <td><?=$value->rqm_sanad?></td>
                                <td><?=$value->date_sanad_ar?></td>
                                <td><?php if(isset($method[$value->pay_method]) && !empty($method[$value->pay_method])){
                                         echo $method[$value->pay_method];
                                    }else{
                                        echo 'غير معرفة';
                                    }?>
                                </td>
                            <td><?php 
                            if(isset($value->recived_from ) and  $value->recived_from != null){
                               echo  $value->recived_from;
                               
                            }else{
                               echo 'غير محدد'; 
                            }
                            
                            ?></td>    
                                
                                <td><?=$value->total_value?></td>
                                <td>
                                    <button type="button" class="btn btn-sm btn-labeled btn-add" data-toggle="modal" data-target="#detailsModal<?=$value->id?>">
                                        <span class="btn-label"><i class="glyphicon glyphicon-list"></i></span>التفاصيل
                                    </button>
                                </td>

    <td>
    <a href="<?=base_url()?>finance_accounting/box/vouch_qbd/Vouch_qbd/printSanedQbd/<?=$value->id?>"  title="طباعة السند" target="_blank"> <i class="fa fa-print" aria-hidden="true"></i> </a>
    
   <a href="<?=base_url()."finance_accounting/box/vouch_qbd/Vouch_qbd/updateView/".$value->id?>" title="تعديل"><i class="fa fa-pencil"></i></a>

    <a onclick="$('#adele').attr('href', '<?=base_url()."finance_accounting/box/vouch_qbd/Vouch_qbd/deleteVouchQbd/".$value->id.'/'.$value->rqm_sanad?>');" data-toggle="modal" data-target="#modal-delete" title="حذف"><i class="fa fa-trash"></i></a>
    </td>
                            </tr>
                            <?php
                        }
                    }
                    ?>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">الدليل المحاسبي </h4>
            </div>
            <div class="modal-body">
                <table id="" class="table table-bordered example" role="table">
                    <thead>
                        <tr class="info">
                            <th width="2%">#</th>
                            <th class="text-left">رقم الحساب</th>
                            <th class="text-left">إسم الحساب</th>
                        </tr>
                    </thead>
                    <tbody>
                    <?php
                    if (isset($tree) && $tree!=null) {
                        buildTreeTable($tree);
                    }
                    function buildTreeTable($tree, $count=1)
                    {
                        $types = array(1=>'رئيسي',2=>'فرعي');
                        $nature = array('','مدين','دائن');
                        $follow = array(1=>'ميزانية',2=>'قائمة الأنشطة');
                      //  $colorArray = array(1=>'#FFB61E', 2=>'#3c990b', 3=>'#5b69bc', 4=>'#E5343D', 5=>'#d9edf7');
                        $colorArray = array(1=>'#ec9732', 2=>'#c07852', 3=>'#75bf67', 4=>'#b6ab2d', 5=>'#145b5d', 6=>'#3088d8', 7=>'#4d92a7', 8=>'#ef6c02', 9=>'#a69fb9', 10=>'#67351b', 11=>'#b6ea47', 12=>'#e18091', 13=>'#f5f44d', 14=>'#a63daa', 15=>'#fb1f73', 16=>'#9b9a92', 17=>'#8f0e0b', 18=>'#397631', 19=>'#074183', 20=>'#cab11e');

                        foreach ($tree as $record) {
                            $onclick = "alert('ليس حساب فرعي');";
                            if ($record->hesab_no3 == 2) {
                                $onclick = "$('#account_num'+$('#modalID').val()).val(".$record->code."); 
                                 $('#rkm_hesab_span'+$('#modalID').val()).html(".$record->code.");
                                 $('#name_hesab_span'+$('#modalID').val()).html('".$record->name."');
                               
                                 $('#account'+$('#modalID').val()).val('".$record->name."');
                                 $('#myModal').modal('hide');";                            }
                    ?>
                        <tr style="background-color: <?=$colorArray[$record->level]?>; cursor: pointer;"
                                onclick="<?=$onclick?>">
                            <td><?=$count++?></td>
                            <td><?=$record->code?></td>
                            <td><?=$record->name?></td>
                        </tr>
                    <?php
                            if (isset($record->subs)) {
                                $count = buildTreeTable($record->subs, $count++);
                            }
                        }
                        return $count;
                    }
                    ?>
                    </tbody>
                </table>
                <?php 
                /*function buildTree($tree) { 
                    $colorArray = array(1=>'btn-warning', 2=>'btn-success', 3=>'btn-purple', 4=>'btn-danger', 5=>'btn-inverse');
                ?>
                <ul id="tree3">
                    <?php 
                    foreach ($tree as $record) { 
                        $onclick = '';
                        if ($record->hesab_no3 == 2) {
                            $onclick = "$('#account_num'+$('#modalID').val()).val(".$record->code."); $('#account'+$('#modalID').val()).val('".$record->name."'); $('#myModal').modal('hide');";
                        }
                    ?>
                    <li>
                        <a href="#" onclick="<?=$onclick?>"> <span class="<?=$colorArray[$record->level]?>"> <?=$record->code?></span> <?=$record->name?></a>
                        <?php
                        if (isset($record->subs)) {
                            buildTree($record->subs);
                        }
                        ?>
                    </li>      
                    <?php } ?>
                </ul>
                <?php 
                }
                if (isset($tree) && $tree!=null) {
                    buildTree($tree);
                }*/
                ?>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 50%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">البحث </h4>
            </div>
            <div class="modal-body row">
                <div class="col_md_100 col-sm-6 padding-4">
                    <div class="col-md-2 col-sm-6 no-padding">
                        <h6 class="label_title_2 ">بحث بواسطة </h6>
                    </div>
                    <div class="col-md-10 col-sm-6 no-padding">
                        <input type="radio" name="searchType" style="width: 15px; height: 15px; margin-right: 20px;" data-validation="required" value="1"> <label> رقم السند</label>

                        <input type="radio" name="searchType" style="width: 15px; height: 15px; margin-right: 20px;" data-validation="required" value="2"> <label> التاريخ</label>

                        <input type="radio" name="searchType" style="width: 15px; height: 15px; margin-right: 20px;" data-validation="required" value="3"> <label> رقم القيد</label>
                    </div>
                </div>

                <div class="col_md_50 col-sm-6 padding-4 divDate" style="display: none;">
                    <div class="col-md-4 col-sm-6 no-padding">
                        <h6 class="label_title_2">تاريخ السند  </h6>
                    </div>
                    <div class="col-md-8 col-sm-6 no-padding">
                        <input type="date" name="from_date" data-validation="" id="day_date" value="<?=date('Y-m-d')?>" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])/(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])/(?:30))|(?:(?:0[13578]|1[02])-31))" class="form-control input_style_2 dateSearch" data-validation-has-keyup-event="true">
                    </div>
                </div>

                <div class="col_md_50 col-sm-6 padding-4 divDate" style="display: none;">
                    <div class="col-md-4 col-sm-6 no-padding">
                        <h6 class="label_title_2">تاريخ السند  </h6>
                    </div>
                    <div class="col-md-8 col-sm-6 no-padding">
                        <input type="date" name="to_date" data-validation="" id="day_date" value="<?=date('Y-m-d')?>" pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])/(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])/(?:30))|(?:(?:0[13578]|1[02])-31))" class="form-control input_style_2 dateSearch" data-validation-has-keyup-event="true">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>


<?php
if (isset($records) && $records != null) {

foreach ($records as $value) {
?>
<div class="modal fade" id="detailsModal<?=$value->id?>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">تفاصيل السند </h4>
            </div>
            <div class="modal-body ">

                <table class="table table-striped table-bordered"  style="table-layout: fixed">
                    <tbody>
                    <tr>
                        <td class="closed_green" style="    width: 15%;">رقم السند </td>
                        <td> <span class=""  ><?=$value->rqm_sanad?></span></td>
                        <td class="closed_green">تاريخ السند </td>
                        <td><span class=" " ><?=$value->date_sanad_ar?></span></td>
                        <td>

                            <input type="radio" disabled style="width: 18px; height: 18px;"  <?php if(!empty($value->pay_method) && $value->pay_method == 1){echo 'checked';} ?>  checked=""> <label class="no-margin no-padding"> نقدي</label>
                            <input type="radio" disabled  style="width: 18px; height: 18px;" <?php if(!empty($value->pay_method) && $value->pay_method == 2){echo 'checked';} ?> > <label class="no-margin no-padding">شيك</label>

                        </td>

                    </tr>
                    <tr>
                        <td class="closed_green">إستلمت من  </td>
                        <td colspan="4"><span class="" ><?=$value->recived_from?></span></td>
                    </tr>
                    <tr>
                        <td class="closed_green">عبارة عن </td>
                        <td colspan="4"> <span class="" ><?=$value->about?></span></td>
                    </tr>

                    </tbody>

                </table>





                <table class="table table-striped table-bordered" style="table-layout: fixed;
                    " id="mytable">
                    <thead>
                    <tr class="info">
                          <th style="width: 70px;">المبلغ</th>
                        <th style="width: 95px;">رقم الحساب</th>
                        <th style="width: 21%;">إسم الحساب</th>
                        <th style="" >البيان</th>

                    </tr>
                    </thead>
                    <tbody>
                    <?php
                    if(!empty($value->delails)){
                        foreach ($value->delails as $row_detail){
                            ?>
                    <tr>
                        <td>
                            <?=$row_detail->value?>
                        </td>
                        <td>
                          <?=$row_detail->rqm_hesab?>
                        </td>
                        <td>
                           <?=$row_detail->name_hesab?>
                        </td>
                        <td>
                            <?=$row_detail->byan?>
                        </td>
                    </tr>
                        <?php  }} ?>
                    <tr>
                        <td><?=$value->total_value?></td>
                        <td colspan="3"><?php /*$value->total_value*/ ?></td>
                    </tr>
                    </tbody>
               </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>
<?php  }} ?>





<script>

    function GetF2aTypeArr(valu) {
        $('#js_table_members').show();
        var F2aType = valu;
        var oTable_usergroup = $('#js_table_members').DataTable({
            dom: 'Bfrtip',
            "ajax": '<?php echo base_url(); ?>all_Finance_resource/all_pills/AllPills/getConnection/' + F2aType,

            aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ],

            buttons: [
                'pageLength',
                'copy',
                'excelHtml5',
                {
                    extend: "pdfHtml5",
                    orientation: 'landscape'
                },
                {
                    extend: 'print',
                    exportOptions: { columns: ':visible'},
                    orientation: 'landscape'
                },
                'colvis'
            ],

            colReorder: true,
            destroy: true

        });

    }

</script>


<script>

    function GetDiv(div,valu) {

        if(valu ==1){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 50px;">#</th><th style="width: 50px;"> كود الموظف </th><th style="width: 170px;" >إسم الموظف </th><th style="width: 170px;" >الإدارة</th>' +
            '<th style="width: 170px;" >القسم</th></tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]};

        } else if(valu ==2){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 50px;">#</th><th style="width: 50px;"> رقم الملف </th><th style="width: 170px;" >إسم رب الأسرة </th><th style="width: 170px;" >رقم هوية الاب</th> <th style="width: 170px;" >إسم مسئول الحساب البنكي</th> <th style="width: 170px;" >رقم هوية</th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]};
        }  else if(valu ==3){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 10px;">#</th><th style="width: 50px;" > الإسم </th><th style="width: 50px;">رقم الهوية</th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true },
                { "bSortable": true }
            ]};
        }  else if(valu ==4){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 10px;">#</th><th style="width: 50px;"> الإسم </th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true },
                { "bSortable": true }
            ]};
        } else if(valu ==5){
            var html =('<div class="col-md-12"><table id="js_table_members" class="table table-striped table-bordered dt-responsive nowrap " >' +
            '<thead><tr><th style="width: 10px;">#</th><th style="width: 50px;"> الإسم </th>' +
            '</tr></thead><table><div id="dataMember"></div></div>');
            var Columns    = {aoColumns:[
                { "bSortable": true }
            ]};
        }


        $("#" + div).html(html);
        $('#type').val(valu);
        $('#js_table_members').show();
        var F2aType = valu;
        var oTable_usergroup = $('#js_table_members').DataTable({
            dom: 'Bfrtip',
            "ajax": '<?php echo base_url(); ?>finance_accounting/box/ezn_sarf/Ezn_sarf/getConnection/' + F2aType,
            Columns
            ,
            buttons: [
                'pageLength',
                'copy',
                'excelHtml5',
                {
                    extend: "pdfHtml5",
                    orientation: 'landscape'
                },
                {
                    extend: 'print',
                    exportOptions: { columns: ':visible'},
                    orientation: 'landscape'
                },
                'colvis'
            ],

            colReorder: true,
            destroy: true

        });

    }
</script>
<script>

    function GetMemberName(valu) {
        var id = valu;
        var name = $("#member" + valu).data('name');
        var mob = $("#member" + valu).data('mob');
        var mother_num = $("#member" + valu).data('mother_num');
        var type = $("#member" + valu).data('type');
        $('#person_name').val(name);
        $('#person_name_div').html(name);
        $('#person_span').html(name);
        $('#person_mob').val(mob);
        if(mother_num  !=''){
            $('#mother_national_num').val(mother_num);
        }
        if(type  !=''){
            $('#type').val(type);
        }
        $("#myModalInfo .close").click();


    }

</script>



<script type="text/javascript">


    function addVouchQbdRow(){
        var id = parseFloat($("#resultTable tr:last").attr('id'))+1;
        var html = `<tr id="`+id+`">\
                        <td>\
                            <input type="text" onkeypress="return validate_number(event);" class="form-control accountValue" step="any" name="value[]" data-validation="required" aria-required="true"
                            onkeyup="getVouchQbdSum(); $('#value_span`+id+`').html($(this).val());">\
                        </td>\
                        <td>\
                            <input type="text" class="form-control testButton" name="rqm_hesab[]" id="account_num`+id+`" data-validation="required" aria-required="true" readonly="" onclick="$('#modalID').val(`+id+`); $(this).removeAttr('readonly');" ondblclick="$(this).attr('readonly','readonly'); $('#myModal').modal('show');" style="cursor:pointer;" autocomplete="off" onkeypress="return isNumberKey(event);" onblur="$(this).attr('readonly','readonly')" 
                            onkeyup="getVouchQbdAccountName($(this).val(),`+id+`); ">\
                        </td>\
                        <td>\
                            <input type="text" class="form-control" name="name_hesab[]" id="account`+id+`" data-validation="required" aria-required="true" readonly="" >\
                        </td>\
                        <td>\
                            <input type="text" class="form-control" name="byan[]"  aria-required="true">\
                        </td>\
                        <td id="TD`+id+`">\
                            <a href="#" onclick="addVouchQbdRow(); $(this).remove(); $('#deleteRow`+id+`').show(); "><i class="fa fa-plus sspan"></i></a>\
                            <a class="pull-right" id="deleteRow`+id+`" href="#" onclick="addVouchQbdPlusButton(`+id+`); getVouchQbdSum();"> <i class="fa fa-trash" aria-hidden="true"></i>
                            </a>\
                        </td>\
                    </tr>`;

        var htmlSpan ='<tr id="Tr'+id+'"><td>'+id+'</td><td id="rkm_hesab_span'+id+'"></td><td id="name_hesab_span'+id+'"></td><td id="value_span'+id+'"></td></tr>';
        $("#TableBodySpan").append(htmlSpan);
        $("#resultTable").append(html);
    }




    function addVouchQbdPlusButton(id) {
        if (parseFloat($("#resultTable tr:last").attr('id')) == id) {
            $('#'+id).remove();
            $('#Tr'+id).remove();
            var last = $("#resultTable tr:last").attr('id');
            $('#TD'+$("#resultTable tr:last").attr('id')).append(`<a href="#" onclick="addVouchQbdRow(); $(this).remove(); $('#deleteRow`+last+`').show();"><i class="fa fa-plus sspan"></i></a>`);
        }
        else {
            $('#'+id).remove();
            $('#Tr'+id).remove();
        }
    }

    /**************************************osama**********************************/

    $("input[name=pay_method]").click(function() {
        var val = $(this).val();
       
        if ($(this).val() == 2) {
         
            $('.divBank').show();
            $('.bank').removeAttr('disabled');
            $('.bank').attr('data-validation','required');
        }
        else {
           
            $('.divBank').hide();
            $('.bank').removeAttr('data-validation');
            $('.bank').attr('disabled','disabled');
        }


        var postdata = 'hesab='+ val ;
        $.ajax({
            type:'post',
            url: '<?php echo base_url() ?>finance_accounting/box/vouch_qbd/Vouch_qbd/get_hesab_data',
            data:postdata,
            cache:false,
            success: function(json_data){
              
                if(json_data) {

                    var JSONObject = JSON.parse(json_data);
                    $('#box_rqm_hesab_id').val(JSONObject['rqm_hesab']);
                    $("#box_name_id").val(JSONObject['name_hesab']);
                }
            }
        });
    });
    /****************************************osama********************************/


    function getVouchQbdSum() {
        var total = 0;
        $(".accountValue").each(function() {
            if ($(this).val()) {
                total += parseFloat($(this).val());
            }
        });
        $('.total').val(total);
        $("#value_span").html(total);
        var split = total.toString().split('.');
        var arabicNumber = '';
        for (var i = 0; i <= split.length - 1; i++) {
            var dataString ='number=' + split[i];
            $.ajax({
                type:'post',
                url: '<?=base_url()?>finance_accounting/box/vouch_qbd/Vouch_qbd/getValueArabic',
                data:dataString,
                cache:false,
                success: function(result){
                    arabicNumber += result;
                    if (i > 1) {
                        $("#valueArabic").val(arabicNumber+' هلله فقط لا غير');
                        $("#valueArabic_span").html(arabicNumber+' هلله فقط لا غير');
                    }
                    else {
                        $("#valueArabic").val(arabicNumber+' ريال فقط لا غير.');
                        $("#valueArabic_span").html(arabicNumber+' ريال فقط لا غير.');
                    }
                    arabicNumber += ' و';
                }
            });
        }

        var x = document.getElementById('resultTable');
        if(x.rows.length == 1) {
            $('#deleteRow'+$("#resultTable tr:last").attr('id')+'').css({display:'none'});
        }


    }

    $("input[name=searchType]").click(function() {
        if ($(this).val() == 2) {
            $('.divDate').show();
            $('.dateSearch').removeAttr('disabled');
            $('.dateSearch').attr('data-validation','required');
        }
        else {
            $('.divDate').hide();
            $('.dateSearch').removeAttr('data-validation');
            $('.dateSearch').attr('disabled','disabled');
        }
    });


    function getVouchQbdAccountName(code,id) {
        var dataString ='code=' + code;
        $.ajax({
            type:'post',
            url: '<?=base_url()?>finance_accounting/box/vouch_qbd/Vouch_qbd/getAccountName',
            data:dataString,
            cache:false,
            success: function(result){
                $('#account'+id).val(result);
                $('#rkm_hesab_span'+id).html(result);
            }
        });
    }
</script>

