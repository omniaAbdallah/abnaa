<style type="text/css">
    .btn-group > .btn, .btn-group > .btn + .btn, .btn-group > .btn:first-child, .fc .fc-button-group > * {
        height: 34px !important;
        border-radius: 4px !important;
        margin: 0 !important;
    }

    .bootstrap-select.btn-group .dropdown-toggle .caret {
        right: 92% !important;
    }

    .btn-label {
        left: 12px;
    }

    input, select {
        font-weight: 600 !important;
        color: #002c52 !important;
        font-size: 16px !important;
    }

    .top-label {
        font-size: 13px;
        background-color: #428bca !important;
        border: 2px solid #428bca !important;
        text-shadow: none !important;
        font-weight: 500 !important;
    }

    .myspan {
        color: rgb(255, 0, 0);
        font-size: 12px;
        position: absolute;
        bottom: -16px;
        right: 20px;
    }

    .no-padding {
        padding-left: 0px !important;
        padding-right: 0px !important;
    }

    .print_forma {
        padding: 15px;
    }

    .piece-box {
        margin-bottom: 12px;
        border: 1px solid #73b300;
        display: inline-block;
        width: 100%;
    }

    .piece-heading {
        background-color: #9bbb59;
        display: inline-block;
        float: right;
        width: 100%;
    }

    .piece-body {
        width: 100%;
        float: right;
    }

    .bordered-bottom {
        border-bottom: 4px solid #9bbb59;
    }

    .piece-footer {
        display: inline-block;
        float: right;
        width: 100%;
        border-top: 1px solid #73b300;
    }

    .piece-heading h5 {
        margin: 4px 0;
    }

    .piece-box table {
        margin-bottom: 0
    }

    .piece-box table th,
    .piece-box table td {
        padding: 2px 8px !important;
    }

    h6 {
        font-size: 16px;
        margin-bottom: 3px;
        margin-top: 3px;
    }

    .print_forma table th {
        text-align: right;
    }

    .print_forma table tr th {
        vertical-align: middle;
    }

    .no-padding {
        padding: 0;
    }

    .header p {
        margin: 0;
    }

    .header img {
        height: 120px;
        width: 100%
    }

    .main-title {
        display: table;
        text-align: center;
        position: relative;
        height: 120px;
        width: 100%;
    }

    .main-title h4 {
        display: table-cell;
        vertical-align: bottom;
        text-align: center;
        width: 100%;
    }

    .print_forma hr {
        border-top: 1px solid #73b300;
        margin-top: 7px;
        margin-bottom: 7px;
    }

    .no-border {
        border: 0 !important;
    }

    .gray_background {
        background-color: #eee;
    }

    @media print {
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }
    }

    .footer img {
        width: 100%;
        height: 120px;
    }

    @page {
        size: A4;
        margin: 20px 0 0;
    }

    .open_green {
        background-color: #e6eed5;
    }

    .closed_green {
        background-color: #cdddac !important;
    }

    .table-bordered > thead > tr > th,
    .table-bordered > tbody > tr > th,
    .table-bordered > tfoot > tr > th,
    .table-bordered > thead > tr > td,
    .table-bordered > tbody > tr > td,
    .table-bordered > tfoot > tr > td {
        border: 1px solid #abc572;
    }

    .btn-close-model,
    btn-close-model:hover,
    btn-close-model:focus {
        background-color: #8a9e5f;
        color: #fff;
        margin-top: -20px;
    }

    .my_style {
        color: #222;
        font-size: 15px;
        font-weight: 500;
    }

    .one_three {
        width: 43% !important;
        float: right;
    }

    .two_three {
        width: 57% !important;
        float: right;
    }

    @media (min-width: 992px) {
        .col_md_10 {
            width: 10%;
            float: right;
        }

        .col_md_15 {
            width: 15%;
            float: right;
        }

        .col_md_20 {
            width: 20%;
            float: right;
        }

        .col_md_25 {
            width: 25%;
            float: right;
        }

        .col_md_30 {
            width: 30%;
            float: right;
        }

        .col_md_35 {
            width: 35%;
            float: right;
        }

        .col_md_40 {
            width: 40%;
            float: right;
        }

        .col_md_45 {
            width: 45%;
            float: right;
        }

        .col_md_50 {
            width: 50%;
            float: right;
        }

        .col_md_60 {
            width: 60%;
            float: right;
        }

        .col_md_70 {
            width: 70%;
            float: right;
        }

        .col_md_75 {
            width: 75%;
            float: right;
        }

        .col_md_80 {
            width: 80%;
            float: right;
        }

        .col_md_85 {
            width: 85%;
            float: right;
        }

        .col_md_90 {
            width: 90%;
            float: right;
        }

        .col_md_95 {
            width: 95%;
            float: right;
        }

        .col_md_100 {
            width: 100%;
            float: right;
        }
    }

    .label_title_2 {
        width: 100%;
        color: white;
        background-color: #428bca;
        border: 2px solid #428bca;
        height: 34px;
        margin: 0;
        line-height: 34px;
        padding-right: 6px;
        font-size: 14px;
        margin-bottom: 5px;
    }

    .input_style_2 {
        border-radius: 0px;
        border-right: transparent;
        width: 100%;
    }

    .label-blue {
        background-color: #003665;
        border: 1px solid #003665;

        height: 34px;
        line-height: 25px !important;
        font-size: 13px !important;
        font-weight: 500 !important;
        text-align: right !important;
    }

    .bond-header {
        height: 55px;
        margin-bottom: 15px;
    }

    .bond-header .right-img img,
    .bond-header .left-img img {
        width: 100%;
        height: 55px;
    }

    .border-box {
        padding: 5px 20px;
        border: 5px double #000 !important;
        border-radius: 29px;
        font-size: 14px !important;
        color: #002c57 !important;
        font-weight: bold !important;
    }

    .border-box-h {
        padding: 3px 20px;
        border: 2px solid #222;
        border-radius: 24px;
    }

    .main-bond-title {
        display: table;
        height: 55px;
        text-align: center;
        width: 100%;
    }

    .main-bond-title h3 {
        display: table-cell;
        vertical-align: bottom;
        font-size: 12px;
    }

    .bond-body {
        padding: 10px;
        border: 2px solid #222;
        display: inline-block;
        width: 100%;
        border-radius: 30px;
        background: url(<?php echo base_url() ?>asisst/admin_asset/img/pills/back2.jpg);
        background-position: center;
        background-size: 50% 100%;
        background-repeat: no-repeat;
    }

    .bond-body h6 {
        font-size: 11px !important;
        color: #002c57 !important;
        font-weight: bold !important;
        line-height: 17px;
    }

    .bond-body h6 span {
        color: darkred;
    }

    .pad-2 {
        padding-left: 2px;
        padding-right: 2px;
    }

    .bond-footer h6 {
        font-size: 13px !important;
        color: #002c57 !important;
        font-weight: bold !important;
        line-height: 17px;
    }

    #cheq, #eda3, #shabka, #mosatadem {
        padding-top: 5px !important;
        padding-bottom: 5px !important;
    }

    .table_style {
        font-size: 11px !important;
        color: darkred !important;
        font-weight: bold !important;
        line-height: 17px !important;
        margin: 1px;
    }

    button[type=submit] {
        padding: 0px 12px;
    }

    .btn-label {
        right: -14px;
    }

    .list::-webkit-calendar-picker-indicator {
        display: none;
    }

    input[type=date]::-webkit-inner-spin-button {
        -webkit-appearance: none;
        display: none;
    }

    input[type=date]::-webkit-clear-button {
        display: none;
        -webkit-appearance: none;
    }

    .tree ul {
        margin-right: 10px;
        position: relative;
        margin-left: 0;
    }

    .tree ul li {
        padding-left: 0;
    }

    .tree ul ul {
        margin-left: 0;
    }

    ul span {
        display: inline !important;
    }

    .fa-plus.sspan {
        background-color: #5b69bc;
        padding: 3px 6px;
        color: #fff;
        border-radius: 5px;
    }

    #colspan4 {
        text-align: right;
        color: red

    }

    .forTd {
        color: black !important;
        font-family: tahoma !important;
        font-size: 15px !important;
        font-weight: 700 !important;
    }
</style>

<div class="col-sm-12 no-padding">
    <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
        <div class="panel-heading">
            <h3 class="panel-title"><?php echo $title ?></h3>
        </div>
        <div class="panel-body">
            <?php
            if (isset($result) && !empty($result)) {

                $rkm = $result->process_rkm;
                $process_date_ar = $result->process_date_ar;
                $geha_name = $result->geha_name;
                $emp_name = $result->emp_name;
                $emp_card_num = $result->emp_card_num;



                $button1 = 'display:none';
                $button2 = '';


                $form_action = 'finance_accounting/box/forms/transformation_accounts/Transformation_accounts/update/' . $result->process_rkm;
            } else {

                $rkm = $last_id;
                $process_date_ar = date('Y-m-d');
                $geha_name = '';
                $emp_name = '';
                $emp_card_num = '';


                $button2 = 'display:none';
                $button1 = '';

                $form_action = 'finance_accounting/box/forms/transformation_accounts/Transformation_accounts/insert';




            }
            ?>
            <?php
            echo form_open_multipart($form_action,array('id'=>'myform'));

            ?>
            <div class="col-md-12 no-padding">
                <div class="col_md_25 col-sm-6 padding-4">

                        <h6 class=" ">رقم العملية</h6>


                        <input type="text" name="process_rkm" readonly id="process_rkm" value="<?php echo $rkm ?>"
                               class="form-control input_style_2 inputclass2" data-validation-has-keyup-event="true">

                </div>


                <div class="col_md_25 col-sm-6 padding-4">

                        <h6 class="">التاريخ </h6>


                        <input type="date" name="process_date_ar" data-validation="required"
                               id="process_date_ar" value="<?php echo $process_date_ar ?>"
                               pattern="(?:19|20)[0-9]{2}-(?:(?:0[1-9]|1[0-2])/(?:0[1-9]|1[0-9]|2[0-9])|(?:(?!02)(?:0[1-9]|1[0-2])/(?:30))|(?:(?:0[13578]|1[02])-31))"
                               class="form-control input_style_2" data-validation-has-keyup-event="true">

                </div>

                <div class="col_md_25 col-sm-6 padding-4">

                        <h6 class="">إسم الجهة </h6>



                        <input type="text" name="geha_name" data-validation="required"
                               id="geha_name" value="<?php echo $geha_name ?>"
                               class="form-control input_style_2 inputclass2" data-validation-has-keyup-event="true">

                </div>

                <div class="col_md_25 col-sm-6 padding-4">

                        <h6 class=" ">الإدارة </h6>


                        <select class="form-control input_style_2 selectpicker inputclass2" name="edara_id_fk" id="edara_id_fk"
                                data-validation="required" aria-required="true" data-show-subtext="true"
                                data-live-search="true"  onchange="getEmp()" >
                            <option value="">إختر</option>
                            <?php if (!empty($main_departments)){
                                foreach ($main_departments as $row){ ?>
                                <option value="<?php echo $row->id;?>"
                                <?php if(!empty($result->edara_id_fk)){

                                    if($result->edara_id_fk ==$row->id){
                                        echo'selected';
                                    }
                                }?>
                                ><?php echo $row->name;?></option>
                            <?php } } ?>
                        </select>

                </div>


            </div>
            <div class="col-md-12 no-padding">
                <div class="col_md_25 col-sm-6 padding-4">

                        <h6 class=" ">إسم الموظف</h6>


                        <select class="form-control input_style_2  inputclass2" name="emp_code" id="emp_code"
                                data-validation="required" aria-required="true"
                                onchange="
                                $('#emp_card_num').val($('option:selected',this).attr('data-card'));
                               $('#qsm_id_fk').val($('option:selected',this).attr('data-qsm'));
                               $('#emp_name').val($('option:selected',this).text());"   >
                            <option value="">إختر</option>

                            <?php if(!empty($employes)){  foreach ($employes as $row){?>
                                <option value="<?php echo $row->emp_code;?>"
                                <?php  if(!empty($result->emp_code)){
                                    if($result->emp_code == $row->emp_code){
                                        echo'selected';
                                    }

                                }?>
                                ><?php echo $row->employee;?></option>
                            <?php }  } ?>
                        </select>

                </div>


                <div class="col_md_25 col-sm-6 padding-4">

                        <h6 class=" ">رقم الهوية</h6>


                        <input type="text" name="emp_card_num" readonly id="emp_card_num" value="<?php echo $emp_card_num ?>"
                               class="form-control input_style_2" data-validation-has-keyup-event="true">
                        <input type="hidden" name="qsm_id_fk" id="qsm_id_fk" value="<?php if(!empty($result->qsm_id_fk)){ echo $result->qsm_id_fk; } ?>" >
                        <input type="hidden" name="emp_name" id="emp_name" value="<?php if(!empty($result->emp_name)){ echo $result->emp_name; } ?>" >

                </div>
            </div>


</br> </br>
            <div class="col-md-12 no-padding">
                <table class="table table-striped table-bordered" style="table-layout: fixed;" id="mytable">
                    <thead>
                    <tr class="info">
                        <th style="width: 30px; text-align:center; background-color: #428bca;"></th>
                        <th  colspan="2" style="width: 72px;text-align:center; background-color: #eeba21;">الحساب المحول منه</th>
                        <th colspan="2" style="width: 80px;text-align:center; background-color: #8bbf02;">الحساب المحول إليه</th>
                        <th style="width: 23px;text-align:center; background-color: #428bca;"></th>
                    </tr>
                    <tr >
                        <th style="width: 30px; text-align:center;">المبلغ</th>
                        <th style="width: 30px;text-align:center; background-color: #eeba21;">إسم البنك</th>
                        <th style="width: 30px;text-align:center;background-color: #eeba21;">إسم الحساب</th>
                        <th style="width: 30px;text-align:center;background-color: #8bbf02;">إسم البنك</th>
                        <th style="width: 30px;text-align:center;background-color: #8bbf02;">إسم الحساب</th>
                        <th style="width: 23px;text-align:center;">الإجراء</th>
                    </tr>
                    </thead>
                    <tbody id="resultTable">

                    <?php
                    $counter =1; if(!empty($result_details)){
                        foreach ($result_details as $row_detail){
                            ?>

                            <tr id="<?=$row_detail->id?>">
                            <td>
                                <input type="text" onkeypress="return validate_number(event);" id="value<?php echo $row_detail->id ?>"
                                       class="form-control " step="any" name="value[]" value="<?php echo $row_detail->value;?>"
                                       data-validation="required" aria-required="true">
                            </td>
                            <td>
                                <select  class="form-control " name="from_bank_id_fk[]" id="from_bank_id_fk<?php echo $row_detail->id ?>"
                                        onchange="Get_general_hesab_id_fk($(this).val(),'from_general_hesab_id_fk<?php echo $row_detail->id ?>')"

                                        data-validation="required" aria-required="true">
                                    <option value="">إختر</option>
                                    <?php if(!empty($all_banks)){  foreach($all_banks as $bank){ ?>
                                        <option value="<?php echo$bank->bank_id_fk; ?>"

                                            <?php if(!empty($row_detail->from_bank_id_fk)){ if($row_detail->from_bank_id_fk ==$bank->bank_id_fk){
                                                echo'selected';
                                            }}?>
                                        ><?php echo$bank->title?></option>
                                    <?php } } ?>
                                </select>
                            </td>

                            <td>
                                <select class="form-control " name="from_general_hesab_id_fk[]" id="from_general_hesab_id_fk<?php echo $row_detail->id ?>"
                                        data-validation="required" aria-required="true">
                                    <option value="">إختر</option>
                                    <?php if(!empty($row_detail->from_general_hesab_arr)){  foreach ($row_detail->from_general_hesab_arr as $record){?>
                                        <option value="<?php echo $record->account_id_fk;?>"
                                        <?php if($row_detail->from_general_hesab_id_fk == $record->account_id_fk){
                                          echo'selected';
                                        } ?>
                                        ><?php echo $record->AccountName;?></option>
                                <?php } } ?>
                                </select>
                            </td>
                            <td>
                                <select class="form-control " name="to_bank_id_fk[]" id="to_bank_id_fk<?php echo $row_detail->id ?>"
                                        onchange="Get_general_hesab_id_fk($(this).val(),'to_general_hesab_id_fk<?php echo $row_detail->id ?>')"

                                        data-validation="required" aria-required="true"
                                >
                                    <option value="">إختر</option>
                                    <?php if(!empty($all_banks)){  foreach($all_banks as $bank){ ?>
                                        <option value="<?php echo$bank->bank_id_fk; ?>"

                                            <?php if(!empty($row_detail->to_bank_id_fk)){ if($row_detail->to_bank_id_fk ==$bank->bank_id_fk){
                                                echo'selected';
                                            }}?>
                                        ><?php echo$bank->title?></option>
                                    <?php } } ?>
                                </select>
                            </td>
                            <td>
                                <select class="form-control " name="to_general_hesab_id_fk[]" id="to_general_hesab_id_fk<?php echo $row_detail->id ?>"
                                        data-validation="required" aria-required="true" >
                                    <option value="">إختر</option>
                                    <?php if(!empty($row_detail->to_general_hesab_arr)){  foreach ($row_detail->to_general_hesab_arr as $record){?>
                                        <option value="<?php echo $record->account_id_fk;?>"
                                            <?php if($row_detail->to_general_hesab_id_fk == $record->account_id_fk){
                                                echo'selected';
                                            } ?>
                                        ><?php echo $record->AccountName;?></option>
                                    <?php } } ?>
                                </select>
                            </td>
                                <td id="TD<?=$row_detail->id?>">
                                    <a href="#" <?php if($counter < sizeof($result_details)){?> style="display: none;" <?php }?> onclick="addNewRow(); $(this).remove(); $('#deleteRow<?=$row_detail->id?>').show();"><i class="fa fa-plus sspan"></i></a>
                                    <a class="pull-right"  id="deleteRow<?=$row_detail->id?>" href="#" onclick="$('#<?=$row_detail->id?>').remove();"><i class="fa fa-trash" aria-hidden="true"></i>
                                    </a>
                                </td>
                            </tr>




                            <!-------------------------stop------------------------------->
                            <?php
                            $counter++;  } }else{ ?>

                    <!---------------------------------------------------------------------------------------------------->
                    <?php
                    $counter = 1;
                    if ($counter <= 1 ) { ?>

                        <tr id="<?php echo $counter ?>">
                            <td>
                                <input type="text" onkeypress="return validate_number(event);" id="value<?php echo $counter ?>"
                                       class="form-control " step="any" name="value[]"
                                       data-validation="required" aria-required="true">
                            </td>
                            <td>
                                <select class="form-control " name="from_bank_id_fk[]" id="from_bank_id_fk<?php echo $counter ?>"
                                        onchange="Get_general_hesab_id_fk($(this).val(),'from_general_hesab_id_fk<?php echo $counter ?>')"

                                data-validation="required" aria-required="true"
                                >
                                    <option value="">إختر</option>
                                    <?php if(!empty($all_banks)){  foreach($all_banks as $bank){ ?>
                                        <option value="<?php echo$bank->bank_id_fk; ?>"

                                            <?php if(!empty($bank_id_fk)){ if($bank_id_fk ==$bank->bank_id_fk){
                                                echo'selected';
                                            }}?>
                                        ><?php echo$bank->title?></option>
                                    <?php } } ?>
                                </select>
                            </td>

                            <td>
                                <select class="form-control " name="from_general_hesab_id_fk[]" id="from_general_hesab_id_fk<?php echo $counter ?>"
                                        data-validation="required" aria-required="true"
                                >
                                    <option value="">إختر</option>
                                </select>
                            </td>
                            <td>
                                <select class="form-control " name="to_bank_id_fk[]" id="to_bank_id_fk<?php echo $counter ?>"
                                        onchange="Get_general_hesab_id_fk($(this).val(),'to_general_hesab_id_fk<?php echo $counter ?>')"

                                        data-validation="required" aria-required="true"
                                >
                                    <option value="">إختر</option>
                                    <?php if(!empty($all_banks)){  foreach($all_banks as $bank){ ?>
                                        <option value="<?php echo$bank->bank_id_fk; ?>"

                                            <?php if(!empty($bank_id_fk)){ if($bank_id_fk ==$bank->bank_id_fk){
                                                echo'selected';
                                            }}?>
                                        ><?php echo$bank->title?></option>
                                    <?php } } ?>
                                </select>
                            </td>
                            <td>
                                <select class="form-control " name="to_general_hesab_id_fk[]" id="to_general_hesab_id_fk<?php echo $counter ?>"

                                        data-validation="required" aria-required="true"
                                >
                                    <option value="">إختر</option>
                                </select>
                            </td>
                            <td id="TD<?php echo $counter + 1 ?>">
                                <a href="#" onclick="addNewRow(); $(this).remove(); $('#deleteRow<?php echo $counter  ?>').show();"><i
                                            class="fa fa-plus sspan"></i></a>
                                <a class="pull-right" style="display: none;" id="deleteRow<?php echo $counter  ?>" href="#"
                                   onclick="$('#<?php echo $counter  ?>').remove(); "><i class="fa fa-trash"
                                                                                     aria-hidden="true"></i>
                                </a>
                            </td>
                        </tr>
                    <?php } } ?>
                    </tbody>


                </table>


            </div>

            <div class="col-md-12 " id="AttachTableDiv"></div>
            <div class="col-xs-12 text-center">
                <!--<input type="hidden" name="modalID" id="modalID">-->

                <button type="button"  style="<?php echo $button1; ?>" onclick="save_me()"
                        class="btn btn-labeled btn-success myBtnInsert" name="action" value="action">
                    <span class="btn-label"><i class="glyphicon glyphicon-floppy-disk"></i></span>حفظ
                </button>

                <button type="button" style="<?php echo $button2; ?>"  class="btn btn-labeled btn-warning myBtn"
                        style="color: ##FFB61E; !important;" onclick="save_me()"
                        name="action" value="action">
                    <span class="btn-label"><i class="glyphicon glyphicon-pencil"></i></span>تعديل
                </button>


                <button type="button" class="btn btn-labeled btn-danger">
                    <span class="btn-label"><i class="glyphicon glyphicon-trash"></i></span>حذف
                </button>

                <button type="button" class="btn btn-labeled btn-purple">
                    <span class="btn-label"><i class="glyphicon glyphicon-print"></i></span>طباعة
                </button>
                <?php if(isset($result) && !empty($result)){?>
                <button type="button" class="btn btn-labeled btn-inverse " id="attach_button"  data-toggle="modal" data-target="#myModal_attach">
                    <span class="btn-label"><i class="glyphicon glyphicon-cloud-upload"></i></span>
                    اضافة مرفق
                </button>
                <?php } ?>


                <button type="button" class="btn btn-labeled btn-info" data-toggle="modal" data-target="#searchModal">
                    <span class="btn-label"><i class="glyphicon glyphicon-search"></i></span>البحث
                </button>
            </div>
            <?php echo form_close() ?>

        </div>


    </div>



</div>
</div>
</div>

<?php

if (!empty($records)) {
?>
<div class="col-sm-12 col-md-12 col-xs-12  " style="padding: 0;">
    <div class="panel panel-bd lobidisable lobipanel lobipanel-sortable">
        <div class="panel-heading">
            <div class="panel-title">
                <h4>شاشة النماذج والإجراءات</h4>
            </div>
        </div>
        <div class="panel-body">
            <div class="form-group col-sm-12 col-xs-12">


                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab1" data-toggle="tab"> العمليات قيد التنفيذ</a></li>
                    <li><a href="#tab2" data-toggle="tab"> العمليات تم تنفيذها</a></li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane fade in active" id="tab1">
                        <div class="panel-body">
                            <?php

                            if (!empty($records)) {
                                ?>
                                <table id="" class="table table-bordered example" role="table">
                                    <thead>
                                    <tr class="info">
                                        <th width="2%">م</th>
                                        <th class="text-left">رقم العملية</th>
                                        <th class="text-left">تاريخ العملية</th>
                                        <th class="text-left">الموظف</th>
                                        <th class="text-left">التفاصيل</th>
                                        <th class="text-left">الإجراءات</th>

                                    </tr>
                                    </thead>
                                    <tbody>
                                    <?php

                                    if (isset($records) && $records != null) {
                                        $x = 1;
                                        foreach ($records as $value) {
                                            ?>
                                            <tr>
                                                <td><?php echo $x++ ?></td>
                                                <td><?php echo $value->process_rkm ?></td>
                                                <td><?php echo $value->process_date_ar ?></td>
                                                <td><?php echo $value->emp_name ?></td>
                                                <td>    <a type="button" onclick="getDetails(<?php echo $value->process_rkm ?>)"
                                                           class="btn btn-sm btn-info" data-toggle="modal"
                                                           data-target="#detailsModal"
                                                           style="padding: 3px 5px;line-height: 1;">
                                                        <i class="glyphicon glyphicon-list"></i> التفاصيل
                                                    </a></td>
                                                <td>

                                                    <a href="<?php echo base_url() . "finance_accounting/box/forms/transformation_accounts/Transformation_accounts/update_transformation_accounts/" . $value->process_rkm ?>"
                                                       title="تعديل"><i class="fa fa-pencil"></i></a>

                                                    <a onclick="Delete_me(<?php echo $value->process_rkm ;?>)"
                                                       title="حذف"><i
                                                                class="fa fa-trash"></i></a>

<a href="<?= base_url()."finance_accounting/box/forms/transformation_accounts/Transformation_accounts/print_account_details/".$value->process_rkm?>"
                                                       target="_blank" title="طباعه">
                                                        <i class="fa fa-print"></i></a>
                                                        
      <button type="submit" class=" btn w-md m-b-5" style="background-color:#6fcbef; color: black;">
<span><i class="fa fa-hand-o-right" aria-hidden="true"></i></span> تحويل العملية 
</button>
                                                        
                                                        
                                                </td>

                                            </tr>
                                            <?php
                                        }
                                    }
                                    ?>
                                    </tbody>
                                </table>




                            <?php } else { ?>
                                <div style="color: red; font-size: large;" class="col-sm-12">لا توجد عمليات قيد التنفيذ
                                    !!
                                </div>

                            <?php } ?>


                        </div>
                    </div>
                    <div class="tab-pane fade" id="tab2">
                        <div class="panel-body">


                            <?php if (!empty($records)) { ?>
                                <table id="" class="table table-bordered example" role="table">
                                    <thead>
                                    <tr class="info">
                                        <th width="2%">م</th>
                                        <th class="text-left">رقم العملية</th>
                                        <th class="text-left">تاريخ العملية</th>
                                        <th class="text-left">الموظف</th>
                                        <th class="text-left">التفاصيل</th>
                                        <th class="text-left">الإجراءات</th>

                                    </tr>
                                    </thead>
                                    <tbody>
                                    <?php

                                    if (isset($records) && $records != null) {
                                        $x = 1;
                                        foreach ($records as $value) {
                                            ?>
                                            <tr>
                                                <td><?php echo $x++ ?></td>
                                                <td><?php echo $value->process_rkm ?></td>
                                                <td><?php echo $value->process_date_ar ?></td>
                                                <td><?php echo $value->emp_name ?></td>
                                                <td>    <a type="button" onclick="getDetails(<?php echo $value->process_rkm ?>)"
                                                           class="btn btn-sm btn-info" data-toggle="modal"
                                                           data-target="#detailsModal"
                                                           style="padding: 3px 5px;line-height: 1;">
                                                        <i class="glyphicon glyphicon-list"></i> التفاصيل
                                                    </a></td>
                                                <td>

                                                    <a href="<?php echo base_url() . "finance_accounting/box/forms/transformation_accounts/Transformation_accounts/update_transformation_accounts/" . $value->process_rkm ?>"
                                                       title="تعديل"><i class="fa fa-pencil"></i></a>

                                                    <a onclick="Delete_me(<?php echo $value->process_rkm ;?>)"
                                                      title="حذف"><i
                                                                class="fa fa-trash"></i></a>

                                                    <a href="#"
                                                       target="_blank" title="طباعه">
                                                        <i class="fa fa-print"></i></a>
                                                </td>

                                            </tr>
                                            <?php
                                        }
                                    }
                                    ?>
                                    </tbody>
                                </table>



                            <?php } else { ?>
                                <div style="color: red; font-size: large;" class="col-sm-12">لا توجد عمليات تم تنفيذها
                                    !!
                                </div>

                            <?php } ?>


                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<?php } ?>

<!------ modals --------------------------------------------->



<div class="modal fade" id="detailsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">التفاصيل </h4>
            </div>
            <div class="modal-body " id="optionearea1">

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">إغلاق</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="myModal_attach" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document" style="width: 50%">
        <div class="modal-content">

            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">المرفقات</h4>
            </div>
            <div class="modal-body">
                <button type="button"  onclick="add_row()" class="btn btn-success btn-next"/>
                <i class="fa fa-plus"></i> إضافة </button><br><br>
                <div class="AttachTable">


                    <?php
                    echo form_open_multipart('finance_accounting/box/forms/transformation_accounts/Transformation_accounts/add_morfaq/'.$result->process_rkm);
                    ?>
                    <input type="hidden" name="hidden_id" id="hidden_id">
                    <input type="hidden" name="hidden_rkm" id="hidden_rkm">
                    <table   class="table table-striped table-bordered fixed-table mytable "
                    <thead>
                    <tr class="info">

                        <th  class="text-center" > إسم المرفق</th>
                        <th class="text-center" >المرفق</th>
                        <th class="text-center" > الإجراء</th>
                    </tr>
                    </thead>
                    <tbody class="attachTable tbody">
                    <?php if(!empty($attaches)){
                    ;
                    $image =  array('gif','Gif','ico','ICO','jpg','JPG','jpeg','JPEG','BNG','png','PNG','bmp','BMP');
                    $file= array('pdf','PDF','xls','xlsx',',doc','docx','txt');
                    ?>
                    <?php $x=1;foreach ($attaches as $row_img){
                    $ext = pathinfo($row_img->file, PATHINFO_EXTENSION)?>
                    <tr class="<?=$x?>">

                        <td><?=$row_img->title?> </td>
                        <td>
                            <?php
                            if (in_array($ext,$image)){
                                ?>

                                <img id="img_view<?=$x?>" src="<?php  echo base_url().'uploads/family_attached/nmazg/nmazg_letter_attaches/'.$row_img->file?>"  width="150px" height="150px" />

                                <?php
                            } else if (in_array($ext,$file)){
                                ?>
                                <a target="_blank" href="<?=base_url()."family_controllers/namazegs/Namazeg/read_file/".$row_img->file?>">
                                    <i class="fa fa-eye" title=" قراءة"></i> </a>
                                <?php
                            }
                            ?>
                        </td>
                        <td>

                            <a href="<?php echo  base_url().'finance_accounting/box/forms/transformation_accounts/Transformation_accounts/Delete_attach/'.$row_img->id?>" > <i class="fa fa-trash" ></i> </a></td>
                    </tr>
                    <?php  $x++; } }?>

                    </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer" style="display: inline-block;width: 100%">
                <!--<input type="hidden" name="id" id="id" >-->
                <button type="submit" class="btn btn-success" style="display: inline-block;padding: 6px 12px;" onclick="GetAttachTable()"
                        name="add_attach"     id="saves"  data-dismiss="modal">حفظ</button>
                <button type="button" class="btn btn-danger"
                        data-dismiss="modal">إغلاق</button>

                <?php
                echo form_close();
                ?>

            </div>
        </div>
    </div>
</div

<!---------------------------------------------------------->
<script>




    function addNewRow() {



        var id = parseFloat($("#resultTable tr:last").attr('id')) + 1;



        var dataString = 'id=' + id ;

        $.ajax({
            type: 'post',
            url: '<?php echo base_url() ?>finance_accounting/box/forms/transformation_accounts/Transformation_accounts/load_banks',
            data: dataString,
            dataType: 'html',
            cache: false,
            success: function (html) {
                $("#resultTable").append(html);
            }
        });




    }


    function addPlusButtonQuod(id) {
        if (parseFloat($("#resultTable tr:last").attr('id')) == id) {
            $('#' + id).remove();
            var last = $("#resultTable tr:last").attr('id');
            $('#TD' + $("#resultTable tr:last").attr('id')).append(`<a href="#" onclick="addNewRow(); $(this).remove(); $('#deleteRow` + last + `').show();"><i class="fa fa-plus sspan"></i></a>`);
        } else {
            $('#' + id).remove();
        }
    }



</script>


<script>
    function getDetails(valu) {
        if (valu != 0 && valu != '') {
            var dataString = 'id=' + valu;
            $.ajax({
                type: 'post',
                url: '<?php echo base_url() ?>finance_accounting/box/forms/transformation_accounts/Transformation_accounts/getDetails',
                data: dataString,
                dataType: 'html',
                cache: false,
                success: function (html) {
                    $("#optionearea1").html(html);
                }
            });

        }

    }

</script>







<!---24-2-2019------------------------------------------------------------------------------------------------->


<script>
    
    
    function getEmp() {
        var edara_id_fk =$('#edara_id_fk').val();

        if (edara_id_fk !=0 &&    edara_id_fk!='') {
            var dataString = 'edara_id_fk=' + edara_id_fk ;
            $.ajax({
                type:'post',
                url: '<?php echo base_url() ?>finance_accounting/box/forms/transformation_accounts/Transformation_accounts/getEmp',
                data:dataString,
                cache:false,
                success: function(json_data){
                    var JSONObject = JSON.parse(json_data);
                    //console.log(JSONObject);

                    var  html='<option value="">إختر </option>';

                    for(i=0; i<JSONObject.length ; i++){

                        html +='<option  data-card="' + JSONObject[i].card_num + '"  data-qsm="' + JSONObject[i].department + '" value="' + JSONObject[i].emp_code + '"> ' + JSONObject[i].employee + '</option>';

                    }
                    $("#emp_code").html(html);

                }
            });
            return false;


        }
  
        
    }
    
</script>




<script>
    
    
    function Get_general_hesab_id_fk(value,myid) {
        var myid =myid;
        var dataString = 'id=' + value ;
        $.ajax({
            type:'post',
            url: '<?php echo base_url() ?>finance_accounting/box/forms/transformation_accounts/Transformation_accounts/GetByArray',
            data:dataString,
            cache:false,
            success: function(json_data){
                var JSONObject = JSON.parse(json_data);
                console.log(JSONObject);
                    var  html='<option>إختر </option>';

                    for(i=0; i<JSONObject.length ; i++){
                        html +='<option value="' + JSONObject[i].account_id_fk + '"> ' + JSONObject[i].AccountName + '</option>';
                    }
                    $("#"+ myid).html(html);

            }
        });


    }
    
</script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2"></script>

<script>

    function save_me(){

        Swal.fire({
            title: "هل تريد  حفظ النموذج!",
            text: "",
            type: 'warning',

            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            cancelButtonText: "لا, إلغاء الأمر!",
            confirmButtonText: "نعم, قم بالحفظ !",
        }).then((result) => {
            if (result.value) {
               $('#myform').submit();

            }
        });
    }


    function Delete_me(valu){

        Swal.fire({
            title: "هل تريد  حذف النموذج!",
            text: "",
            type: 'warning',

            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            cancelButtonText: "لا, إلغاء الأمر!",
            confirmButtonText: "نعم, قم بالحذف !",
        }).then((result) => {
            if (result.value) {

                window.location.href ="<?php echo base_url();?>finance_accounting/box/forms/transformation_accounts/Transformation_accounts/Delete/" + valu;

            }
        });
    }
</script>
<script>
    function add_row(){
        $(".mytable").show();
        //var x = document.getElementById('resultTable');
        var len = $(".attachTable").length+1 ;
        // alert(len);

        $(".attachTable").append('<tr class="'+ len +'">'

            +'</td><td><input type="input" name="title[]" id="title"  class="form-control" data-validation="reuqired"></td><td><input type="file" name="file[]" id="file"  class="form-control " data-validation="reuqired"></td><td><a href="#"  onclick="DeleteRowImg('+len+')"> <i class="fa fa-trash" ></i> </a></td></tr>');
    }
    function DeleteRowImg(valu) {
        $('.' + valu).remove();
        // var x = document.getElementById('resultTable');
        var len = $(".attachTable").length ;
        if( len ==0){
            $(".mytable").hide();
        }
    }

</script>

<script>
    function put_value(id,rkm)
    {
        $('#hidden_id').val(id);
        $('#hidden_rkm').val(rkm);
        $.ajax({
            type: 'post',
            url: "<?php echo base_url();?>family_controllers/namazegs/Namazeg/get_attaches",
            data: {rkm:rkm},


            success: function (d) {
                $('.tbody').html(d);
                // alert(d);

            }

        });
    }
</script>

<script>

    function GetAttachTable() {
        $('#AttachTableDiv').html('');
        $(".AttachTable").clone().appendTo('#AttachTableDiv');
        $("#myModal_attach .close").click();
    }
</script>








