<?phpclass Permission extends CI_Model{    public function __construct() {        parent::__construct();    }    public function get_all_groups($role_id_fk){        if($role_id_fk==1){            $sql="SELECT * FROM `groups` WHERE 1 ORDER BY group_order ASC ";            $query = $this->db->query($sql);        }else{            // $sql="SELECT groups.*,permissions.* ,pages.page_id ,pages.group_id_fk from groups,permissions ,pages where permissions.role_id_fk =$role_id_fk AND permissions.page_id_fk=pages.page_id AND pages.group_id_fk=groups.group_id GROUP BY groups.group_title ORDER BY groups.group_order ASC ";            $this->db->select("            DISTINCT(groups.group_id),          groups.group_title,          groups.group_link,          groups.group_order,          groups.group_icon_code,          permissions.page_id_fk,          permissions.role_id_fk,          pages.page_id ,          pages.page_title ,          pages.page_link,          pages.group_id_fk,          pages.page_order,          pages.page_icon_code,          " );            $this->db->from("groups");            $this->db->join("pages","pages.group_id_fk=groups.group_id");            $this->db->join("permissions","permissions.page_id_fk=pages.page_id");            $this->db->where("permissions.role_id_fk",$role_id_fk);            $this->db->order_by('groups.group_order', 'ASC');            $this->db->group_by("groups.group_id");            $query=$this->db->get();        }        return $query->result ();    }    public  function get_all_pages($roleid,$group_id){        $this->db->select ( '*' );        $this->db->from ( 'pages' );        if($roleid==1){        }else{            $this->db->join ( 'permissions', 'pages.page_id = permissions.page_id_fk');            $this->db->where ( 'permissions.role_id_fk', $roleid);        }        $this->db->where ( 'pages.group_id_fk', $group_id);        $this->db->order_by("pages.page_order", "asc");        $query = $this->db->get ();        return $query->result();    } //--------------------------------------------------------------- public  function insert_user_role(){     for($x=0;$x<sizeof($_POST["select-all"]);$x++){         $r=explode("-",$_POST["select-all"][$x]);         $data['user_id']=$this->input->post("user_id");         $data['page_id_fk']=$r[0];         $data['page_level']=$r[1];         $this->db->insert('permissions',$data);     } }//---------------------------------------------------------------    public function select_per($id){        $this->db->select('*');        $this->db->from("permissions");        $this->db->where("user_id",$id);        $query = $this->db->get();        if ($query->num_rows() > 0) {            foreach ($query->result() as $row) {                $data[] = $row->page_id_fk;            }            return $data;        }        return false;    }//-----------------------------------------------------------    public function user_in(){        $this->db->select('*');        $this->db->from('permissions');        $this->db->group_by("user_id");        $query = $this->db->get();        if ($query->num_rows() > 0) {            foreach ($query->result() as $row) {                $data[] = $row->user_id;            }            return $data;        }        return false;    }//-----------------------------------------------------------    public function users_name(){        $this->db->select('*');        $this->db->from('users');        $query = $this->db->get();        if ($query->num_rows() > 0) {            foreach ($query->result() as $row) {                $data[$row->user_id] = $row->user_username;            }            return $data;        }        return false;    }            public function get_users_name(){        $this->db->select('*');        $this->db->from('users');        $query = $this->db->get();        if ($query->num_rows() > 0) {            foreach ($query->result() as $row) {                $data[$row->user_id] = $row->user_name;            }            return $data;        }        return false;    }}// END CLASS